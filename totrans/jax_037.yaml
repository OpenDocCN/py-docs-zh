- en: Transfer guard
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[`jax.readthedocs.io/en/latest/transfer_guard.html`](https://jax.readthedocs.io/en/latest/transfer_guard.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: JAX may transfer data between the host and devices and between devices during
    type conversion and input sharding. To log or disallow any unintended transfers,
    the user may configure a JAX transfer guard.
  prefs: []
  type: TYPE_NORMAL
- en: 'JAX transfer guards distinguish between two types of transfers:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Explicit transfers: `jax.device_put*()` and `jax.device_get()` calls.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Implicit transfers: Other transfers (e.g., printing a `DeviceArray`).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A transfer guard can take an action based on its guard level:'
  prefs: []
  type: TYPE_NORMAL
- en: '`"allow"`: Silently allow all transfers (default).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`"log"`: Log and allow implicit transfers. Silently allow explicit transfers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`"disallow"`: Disallow implicit transfers. Silently allow explicit transfers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`"log_explicit"`: Log and allow all transfers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`"disallow_explicit"`: Disallow all transfers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: JAX will raise a `RuntimeError` when disallowing a transfer.
  prefs: []
  type: TYPE_NORMAL
- en: 'The transfer guards use the standard JAX configuration system:'
  prefs: []
  type: TYPE_NORMAL
- en: A `--jax_transfer_guard=GUARD_LEVEL` command-line flag and `jax.config.update("jax_transfer_guard",
    GUARD_LEVEL)` will set the global option.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A `with jax.transfer_guard(GUARD_LEVEL): ...` context manager will set the
    thread-local option within the scope of the context manager.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note that similar to other JAX configuration options, a newly spawned thread
    will use the global option instead of any active thread-local option of the scope
    where the thread was spawned.
  prefs: []
  type: TYPE_NORMAL
- en: 'The transfer guards can also be applied more selectively, based on the direction
    of transfer. The flag and context manager name is suffixed with a corresponding
    transfer direction (e.g., `--jax_transfer_guard_host_to_device` and `jax.config.transfer_guard_host_to_device`):'
  prefs: []
  type: TYPE_NORMAL
- en: '`"host_to_device"`: Converting a Python value or NumPy array into a JAX on-device
    buffer.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`"device_to_device"`: Copying a JAX on-device buffer to a different device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`"device_to_host"`: Fetching a JAX on-device buffer.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fetching a buffer on a CPU device is always allowed regardless of the transfer
    guard level.
  prefs: []
  type: TYPE_NORMAL
- en: The following shows an example of using the transfer guard.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
