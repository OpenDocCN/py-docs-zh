# 链接

> 原文：[`pymupdf.readthedocs.io/en/latest/link.html`](https://pymupdf.readthedocs.io/en/latest/link.html)

表示指向某处的指针（本文档、其他文档、互联网）。每个文档页面存在链接，并且它们在起始链接开始时是前向链接的，通过`页面.first_link`属性访问。

链接与其页面之间存在父子关系。如果页面对象变得不可用（关闭文档、任何文档结构更改等），则它的每个现有链接对象也会如此 – 访问链接属性或方法时会引发异常，表明对象是“孤立”的。

| **属性** | **简短描述** |
| --- | --- |
| `链接.set_border()` | 修改边框属性 |
| `链接.set_colors()` | 修改颜色属性 |
| `链接.set_flags()` | 修改链接标志 |
| `链接.border` | 边框特性 |
| `链接.colors` | 边框线颜色 |
| `链接.dest` | 指向目标详细信息 |
| `链接.is_external` | 检查链接是否是外部目标 |
| `链接.flags` | 链接注解标志 |
| `链接.next` | 指向下一个链接 |
| `链接.rect` | 未转换坐标中的可点击区域 |
| `链接.uri` | 链接目标 |
| `链接.xref` | `xref` 条目的编号 |

**类 API**

```py
class Link
```

```py
set_border(border=None, width=0, style=None, dashes=None)
```

仅限于 PDF：更改边框宽度和虚线属性。

*(在版本 1.16.9 中更改)* 允许在不使用字典的情况下指定。如果*border*不是字典，则使用直接参数。

参数：

+   **边框** (*dict*) – 由`border`属性返回的字典，具有键“width” (*float*)、“style” (*str*)和“dashes” (*sequence*)。省略的键将保持相应属性不变。例如，要删除虚线，请使用：“dashes”: []。如果虚线不是空序列，则“style”将自动设置为“D”（虚线）。

+   **width** (*float*) – 见上文。

+   **style** (*str*) – 见上文。

+   **虚线** (*sequence*) – 见上文。

```py
set_colors(colors=None, stroke=None)
```

仅限于 PDF：更改“描边”颜色。

注意

在 PDF 中，链接在技术上是注解的一种子类型，**不支持填充颜色**。然而，为了保持一致的 API，我们允许指定一个`fill=`参数，就像所有的注解一样，但会忽略警告。

*(在版本 1.16.9 中更改)* 允许直接设置颜色。如果*colors*不是字典，则使用这些参数。

参数：

+   **颜色**（*dict*） - 包含颜色规格的字典。有关接受的字典键和值，请参阅下文。最实用的方法应该是首先复制*颜色*属性，然后根据需要修改此字典。

+   **描边**（*sequence*） - 见上文。

```py
set_flags(flags)
```

*新功能在 v1.18.16 中*

设置链接注释的 PDF `/F` 属性。详见`Annot.set_flags()`。如果不是 PDF，此方法无效。

```py
flags
```

*新功能在 v1.18.16 中*

返回链接注释的标志，一个整数（详见`Annot.flags`）。如果不是 PDF，则为零。

```py
colors
```

仅适用于 PDF：包含两个浮点数元组的字典，范围为 `0 <= float <= 1`，指定*描边*和*填充*颜色。如果不是 PDF，则返回 *None*。如上所述，对于链接，填充颜色始终为 *None*。描边颜色用于链接矩形的边框。元组的长度隐含确定了颜色空间：1 = 灰度，3 = RGB，4 = CMYK。因此 `(1.0, 0.0, 0.0)` 代表 RGB 颜色红色。每个浮点数 *f* 的值通过计算 *f = i / 255* 映射到范围 0 到 255 的整数值 *i*。

返回类型：

字典

```py
border
```

仅适用于 PDF：包含边框特性的字典。对于非 PDF，它将为 *None*，如果不存在边框信息，则为空字典。可以出现以下键：

+   *宽度* - 以点为单位指定边框厚度的浮点数。如果未指定宽度，则值为 -1.0。

+   *虚线* - 一系列整数，指定线条虚线模式。*[]* 表示没有虚线，*[n]* 表示等长的 on-off 长度为 *n* 点，更长的列表将被解释为指定交替 on-off 长度值。详见 Adobe PDF 参考手册第 126 页获取更多细节。

+   *样式* - 1 字节边框样式：*S*（实线）= 围绕注释的实线矩形，*D*（虚线）= 围绕链接的虚线矩形，虚线模式由 *dashes* 条目指定，*B*（斜角）= 一个模拟的凸出矩形，看起来高于页面表面，*I*（镂空）= 一个模拟的凹陷矩形，看起来低于页面表面，*U*（下划线）= 注释矩形底部的单线。

返回类型：

字典

```py
rect
```

可以在未转换坐标中点击的区域。

类型：

矩形

```py
is_external
```

一个布尔值，指定链接目标是否在当前文档之外。

类型：

布尔值

```py
uri
```

指定链接目标的字符串。此属性的含义应与属性 `is_external` 一起评估：

+   `is_external` 为 true：`uri` 指向当前 PDF 之外的某个目标，可以是互联网资源（`uri` 以 “[http://](http://)” 或类似方式开头）、另一个文件（`uri` 以 “file:” 或 “file://” 开头）或其他服务，如电子邮件地址（`uri` 以 “mailto:” 开头）。

+   `is_external` 为 false：`uri` 将为 `None` 或指向内部位置。对于 PDF 文档，应该是 *#nnnn*，表示基于 1 的页面号 *nnnn*，或者是命名位置。对于其他文档类型，格式会有所不同，例如 XPS 文档中的“../FixedDoc.fdoc#PG_2_LNK_1”，表示第 2 页（基于 1 的）。

类型：

str

```py
xref
```

指定 PDF `xref` 的整数。如果不是 PDF，则为零。

类型：

int

```py
next
```

下一个链接或 *None*。

类型：

*Link*

```py
dest
```

链接目标细节对象。

类型：

linkDest

对本页面有任何反馈吗？

* * *

本软件按原样提供，不提供任何明示或暗示的担保。此软件根据许可证分发，未经明确授权，不得复制、修改或分发。请参阅[artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)上的许可信息，或联系美国旧金山市 Mesa 街 39 号 108A 单元的 Artifex Software Inc. 94129 以获取更多信息。

此文档覆盖所有版本直至 1.24.4。

![Discord logo](https://discord.gg/TSpYGBW4eq)
