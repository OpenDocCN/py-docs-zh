# PyMuPDFï¼ŒLLM å’Œ RAG

> åŸæ–‡ï¼š[`pymupdf.readthedocs.io/en/latest/rag.html`](https://pymupdf.readthedocs.io/en/latest/rag.html)

å°† PyMuPDF é›†æˆåˆ°æ‚¨çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ¡†æ¶å’Œæ•´ä½“ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰è§£å†³æ–¹æ¡ˆä¸­ï¼Œæä¾›äº†äº¤ä»˜æ–‡æ¡£æ•°æ®çš„æœ€å¿«å’Œæœ€å¯é çš„æ–¹æ³•ã€‚

æœ‰å‡ ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ LLM è§£å†³æ–¹æ¡ˆå…·æœ‰å®ƒä»¬è‡ªå·±çš„ç•Œé¢ä¸ PyMuPDF é›†æˆ - è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿå¢é•¿çš„é¢†åŸŸï¼Œå¦‚æœæ‚¨å‘ç°æ›´å¤šï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ï¼

å¦‚æœæ‚¨éœ€è¦å¯¼å‡ºä¸º Markdown æˆ–ä»æ–‡ä»¶è·å– LlamaIndex æ–‡æ¡£ï¼š

## ä¸ LangChain é›†æˆ

ä½¿ç”¨ä¸“ç”¨çš„åŠ è½½å™¨ï¼Œå¯ä»¥ç®€å•åœ°ä¸ LangChain ç›´æ¥é›†æˆï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```py
from langchain_community.document_loaders import PyMuPDFLoader
loader = PyMuPDFLoader("example.pdf")
data = loader.load() 
```

è¯¦ç»†ä¿¡æ¯è¯·å‚é˜…[ä½¿ç”¨ PyMuPDF çš„ LangChain](https://python.langchain.com/docs/modules/data_connection/document_loaders/pdf/#using-pymupdf)ã€‚

## ä¸ LlamaIndex é›†æˆ

ä½¿ç”¨ä¸“ç”¨çš„`PyMuPDFReader`ä» LlamaIndex ğŸ¦™ç®¡ç†æ–‡æ¡£åŠ è½½ã€‚

```py
from llama_index.readers.file import PyMuPDFReader
loader = PyMuPDFReader()
documents = loader.load(file_path="example.pdf") 
```

æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[ä»å¤´å¼€å§‹æ„å»º RAG](https://docs.llamaindex.ai/en/stable/examples/low_level/oss_ingestion_retrieval)ã€‚

## ä¸ºåˆ†å—å‡†å¤‡æ•°æ®

å°†æ•°æ®è¿›è¡Œåˆ†å—ï¼ˆæˆ–åˆ†å‰²ï¼‰å¯¹äºèµ‹äºˆ LLM æ•°æ®ä¸Šä¸‹æ–‡è‡³å…³é‡è¦ï¼Œè€Œç°åœ¨ PyMuPDF æ”¯æŒ Markdown è¾“å‡ºï¼Œè¿™æ„å‘³ç€æ”¯æŒ[Level 3 chunking](https://medium.com/@anuragmishra_27746/five-levels-of-chunking-strategies-in-rag-notes-from-gregs-video-7b735895694d#b123)ã€‚

### è¾“å‡ºä¸º Markdown

ä¸ºäº†ä»¥ Markdown æ ¼å¼å¯¼å‡ºæ–‡æ¡£ï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªå•ç‹¬çš„åŠ©æ‰‹ã€‚[pymupdf4llm](https://pypi.org/project/pymupdf4llm/)åŒ…æ˜¯ PyMuPDF å‡½æ•°çš„é«˜çº§å°è£…ï¼Œå¯¹äºæ¯ä¸ªé¡µé¢ï¼Œè¾“å‡ºæ‰€æœ‰æ–‡æ¡£é¡µé¢ä¸Šçš„æ ‡å‡†æ–‡æœ¬å’Œè¡¨æ ¼æ–‡æœ¬çš„é›†æˆ Markdown æ ¼å¼å­—ç¬¦ä¸²ï¼š

```py
# convert the document to markdown
import pymupdf4llm
md_text = pymupdf4llm.to_markdown("input.pdf")

# Write the text to some file in UTF8-encoding
import pathlib
pathlib.Path("output.md").write_bytes(md_text.encode()) 
```

æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š[pymupdf4llm æ–‡æ¡£](https://pymupdf4llm.readthedocs.io)

### å¦‚ä½•ä½¿ç”¨ Markdown è¾“å‡º

ä¸€æ—¦æ‚¨çš„æ•°æ®ä»¥ Markdown æ ¼å¼å‡†å¤‡å¥½ï¼Œæ‚¨å°±å¯ä»¥å°†å…¶åˆ†å—/åˆ†å‰²å¹¶æä¾›ç»™æ‚¨çš„ LLMï¼Œä¾‹å¦‚ï¼Œå¦‚æœè¿™æ˜¯ LangChainï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```py
import pymupdf4llm
from langchain.text_splitter import MarkdownTextSplitter

# Get the MD text
md_text = pymupdf4llm.to_markdown("input.pdf")  # get markdown for all pages

splitter = MarkdownTextSplitter(chunk_size=40, chunk_overlap=0)

splitter.create_documents([md_text]) 
```

æ¬²äº†è§£æ›´å¤šï¼Œè¯·å‚é˜…[5 ä¸ªçº§åˆ«çš„æ–‡æœ¬æ‹†åˆ†](https://github.com/FullStackRetrieval-com/RetrievalTutorials/blob/main/tutorials/LevelsOfTextSplitting/5_Levels_Of_Text_Splitting.ipynb)

## ç›¸å…³åšå®¢

è¦äº†è§£æ›´å¤šå…³äº PyMuPDFã€LLM å’Œ RAG çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„åšå®¢ä»¥è·å–å®æ–½å’Œæ•™ç¨‹ã€‚

### æå–æ–‡æœ¬çš„æ–¹æ³•

+   [å¢å¼ºæ–‡æœ¬æå–](https://artifex.com/blog/rag-llm-and-pdf-enhanced-text-extraction)

+   [ä½¿ç”¨ PyMuPDF è½¬æ¢ä¸º Markdown æ–‡æœ¬](https://artifex.com/blog/rag-llm-and-pdf-conversion-to-markdown-text-with-pymupdf)

### åˆ›å»ºä¸€ä¸ªèŠå¤©æœºå™¨äººæ¥è®¨è®ºæ‚¨çš„æ–‡æ¡£

+   [åˆ›å»ºä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡ŒèŠå¤©æœºå™¨äºº](https://artifex.com/blog/creating-a-rag-chatbot-with-chatgpt-and-pymupdf)

+   [åˆ›å»ºä¸€ä¸ªèŠå¤©æœºå™¨äºº GUI](https://artifex.com/blog/building-a-rag-chatbot-gui-with-the-chatgpt-api-and-pymupdf)

å¯¹æœ¬é¡µé¢æœ‰ä»»ä½•åé¦ˆæ„è§å—ï¼Ÿ

* * *

æœ¬è½¯ä»¶æŒ‰åŸæ ·æä¾›ï¼Œä¸é™„ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„ä¿è¯ã€‚æœ¬è½¯ä»¶æ ¹æ®è®¸å¯åˆ†å‘ï¼Œé™¤éæ ¹æ®è¯¥è®¸å¯çš„æ¡æ¬¾å¾—åˆ°æ˜ç¡®æˆæƒï¼Œå¦åˆ™ä¸å¾—å¤åˆ¶ã€ä¿®æ”¹æˆ–åˆ†å‘ã€‚è¯·å‚è€ƒ[artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)çš„è®¸å¯ä¿¡æ¯æˆ–è”ç³»ç¾å›½åŠ åˆ©ç¦å°¼äºšå·æ—§é‡‘å±±å¸‚ Mesa è¡— 39 å· 108A å¥—æˆ¿çš„ Artifex Software Inc.è·å–æ›´å¤šä¿¡æ¯ã€‚

æœ¬æ–‡æ¡£æ¶µç›–äº†æ‰€æœ‰ç‰ˆæœ¬ï¼Œç›´è‡³ 1.24.4ã€‚

![Discord logo](https://discord.gg/TSpYGBW4eq)

## ä¸ LangChain é›†æˆ

é€šè¿‡ä½¿ç”¨ä¸“ç”¨åŠ è½½å™¨ï¼Œç›´æ¥ä¸ LangChain é›†æˆéå¸¸ç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```py
from langchain_community.document_loaders import PyMuPDFLoader
loader = PyMuPDFLoader("example.pdf")
data = loader.load() 
```

æŸ¥çœ‹[LangChain ä½¿ç”¨ PyMuPDF](https://python.langchain.com/docs/modules/data_connection/document_loaders/pdf/#using-pymupdf)è·å–è¯¦ç»†ä¿¡æ¯ã€‚

## ä¸ LlamaIndex é›†æˆ

ä½¿ç”¨ LlamaIndex ğŸ¦™ çš„ä¸“ç”¨`PyMuPDFReader`æ¥ç®¡ç†ä½ çš„æ–‡æ¡£åŠ è½½ã€‚

```py
from llama_index.readers.file import PyMuPDFReader
loader = PyMuPDFReader()
documents = loader.load(file_path="example.pdf") 
```

æŸ¥çœ‹[ä»å¤´å¼€å§‹æ„å»º RAG](https://docs.llamaindex.ai/en/stable/examples/low_level/oss_ingestion_retrieval)è·å–æ›´å¤šä¿¡æ¯ã€‚

## ä¸ºåˆ†å—å‡†å¤‡æ•°æ®

å¯¹æ•°æ®è¿›è¡Œåˆ†å—ï¼ˆæˆ–åˆ†å‰²ï¼‰æ˜¯ä¸ºä½ çš„ LLM æ•°æ®æä¾›ä¸Šä¸‹æ–‡çš„å…³é”®ï¼Œè€Œç°åœ¨ PyMuPDF æ”¯æŒ Markdown è¾“å‡ºæ„å‘³ç€æ”¯æŒ[ç¬¬ 3 çº§åˆ†å—](https://medium.com/@anuragmishra_27746/five-levels-of-chunking-strategies-in-rag-notes-from-gregs-video-7b735895694d#b123)ã€‚

### ä»¥ Markdown è¾“å‡º

ä¸ºäº†ä»¥ Markdown æ ¼å¼å¯¼å‡ºä½ çš„æ–‡æ¡£ï¼Œä½ éœ€è¦ä¸€ä¸ªå•ç‹¬çš„è¾…åŠ©å·¥å…·ã€‚åŒ…[PyMuPDF4LLM](https://pypi.org/project/pymupdf4llm/)æ˜¯ PyMuPDF åŠŸèƒ½çš„é«˜çº§å°è£…ï¼Œå®ƒä¸ºæ¯ä¸€é¡µè¾“å‡ºæ•´åˆçš„ Markdown æ ¼å¼å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬æ‰€æœ‰æ–‡æ¡£é¡µé¢ä¸Šçš„æ ‡å‡†æ–‡æœ¬å’Œè¡¨æ ¼æ–‡æœ¬ï¼š

```py
# convert the document to markdown
import pymupdf4llm
md_text = pymupdf4llm.to_markdown("input.pdf")

# Write the text to some file in UTF8-encoding
import pathlib
pathlib.Path("output.md").write_bytes(md_text.encode()) 
```

å¦‚éœ€è¿›ä¸€æ­¥ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š[pymupdf4llm æ–‡æ¡£](https://pymupdf4llm.readthedocs.io)

### å¦‚ä½•ä½¿ç”¨ Markdown è¾“å‡º

ä¸€æ—¦ä½ çš„æ•°æ®ä»¥ Markdown æ ¼å¼å‡†å¤‡å¥½ï¼Œä½ å°±å¯ä»¥å¯¹å…¶è¿›è¡Œåˆ†å—/åˆ†å‰²å¹¶ä¾›ç»™ä½ çš„ LLMï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨ LangChainï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```py
import pymupdf4llm
from langchain.text_splitter import MarkdownTextSplitter

# Get the MD text
md_text = pymupdf4llm.to_markdown("input.pdf")  # get markdown for all pages

splitter = MarkdownTextSplitter(chunk_size=40, chunk_overlap=0)

splitter.create_documents([md_text]) 
```

æŸ¥çœ‹æ›´å¤šè¯·å‚é˜…[æ–‡æœ¬åˆ†å‰²çš„ 5 ä¸ªçº§åˆ«](https://github.com/FullStackRetrieval-com/RetrievalTutorials/blob/main/tutorials/LevelsOfTextSplitting/5_Levels_Of_Text_Splitting.ipynb)

### ä»¥ Markdown è¾“å‡º

ä¸ºäº†ä»¥ Markdown æ ¼å¼å¯¼å‡ºä½ çš„æ–‡æ¡£ï¼Œä½ éœ€è¦ä¸€ä¸ªå•ç‹¬çš„è¾…åŠ©å·¥å…·ã€‚åŒ…[PyMuPDF4LLM](https://pypi.org/project/pymupdf4llm/)æ˜¯ PyMuPDF åŠŸèƒ½çš„é«˜çº§å°è£…ï¼Œå®ƒä¸ºæ¯ä¸€é¡µè¾“å‡ºæ•´åˆçš„ Markdown æ ¼å¼å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬æ‰€æœ‰æ–‡æ¡£é¡µé¢ä¸Šçš„æ ‡å‡†æ–‡æœ¬å’Œè¡¨æ ¼æ–‡æœ¬ï¼š

```py
# convert the document to markdown
import pymupdf4llm
md_text = pymupdf4llm.to_markdown("input.pdf")

# Write the text to some file in UTF8-encoding
import pathlib
pathlib.Path("output.md").write_bytes(md_text.encode()) 
```

å¦‚éœ€è¿›ä¸€æ­¥ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š[pymupdf4llm æ–‡æ¡£](https://pymupdf4llm.readthedocs.io)

### å¦‚ä½•ä½¿ç”¨ Markdown è¾“å‡º

ä¸€æ—¦ä½ çš„æ•°æ®ä»¥ Markdown æ ¼å¼å‡†å¤‡å¥½ï¼Œä½ å°±å¯ä»¥å¯¹å…¶è¿›è¡Œåˆ†å—/åˆ†å‰²å¹¶ä¾›ç»™ä½ çš„ LLMï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨ LangChainï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```py
import pymupdf4llm
from langchain.text_splitter import MarkdownTextSplitter

# Get the MD text
md_text = pymupdf4llm.to_markdown("input.pdf")  # get markdown for all pages

splitter = MarkdownTextSplitter(chunk_size=40, chunk_overlap=0)

splitter.create_documents([md_text]) 
```

æŸ¥çœ‹æ›´å¤šè¯·å‚è§[æ–‡æœ¬åˆ†å‰²çš„ 5 ä¸ªå±‚æ¬¡](https://github.com/FullStackRetrieval-com/RetrievalTutorials/blob/main/tutorials/LevelsOfTextSplitting/5_Levels_Of_Text_Splitting.ipynb)

## ç›¸å…³åšå®¢

è¦äº†è§£æ›´å¤šå…³äº PyMuPDFã€LLM å’Œ RAG çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„åšå®¢ä»¥è·å–å®æ–½å’Œæ•™ç¨‹ã€‚

### æå–æ–‡æœ¬çš„æ–¹æ³•

+   [å¢å¼ºæ–‡æœ¬æå–](https://artifex.com/blog/rag-llm-and-pdf-enhanced-text-extraction)

+   [ä½¿ç”¨ PyMuPDF è½¬æ¢ä¸º Markdown æ–‡æœ¬](https://artifex.com/blog/rag-llm-and-pdf-conversion-to-markdown-text-with-pymupdf)

### åˆ›å»ºä¸€ä¸ªèŠå¤©æœºå™¨äººæ¥è®¨è®ºæ‚¨çš„æ–‡æ¡£

+   [åˆ›å»ºä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡ŒèŠå¤©æœºå™¨äºº](https://artifex.com/blog/creating-a-rag-chatbot-with-chatgpt-and-pymupdf)

+   [åˆ¶ä½œèŠå¤©æœºå™¨äºº GUI](https://artifex.com/blog/building-a-rag-chatbot-gui-with-the-chatgpt-api-and-pymupdf)

æ‚¨å¯¹æœ¬é¡µé¢æœ‰ä»»ä½•åé¦ˆå—ï¼Ÿ

* * *

æ­¤è½¯ä»¶æŒ‰åŸæ ·æä¾›ï¼Œä¸æä¾›ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„æ‹…ä¿ã€‚æ­¤è½¯ä»¶åœ¨è®¸å¯ä¸‹åˆ†å‘ï¼Œé™¤éæ˜ç¡®æˆæƒï¼Œå¦åˆ™ä¸å¾—å¤åˆ¶ã€ä¿®æ”¹æˆ–åˆ†å‘ã€‚è¯·å‚é˜…è®¸å¯ä¿¡æ¯ï¼Œè¯¦è§[artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)ï¼Œæˆ–è”ç³»ç¾å›½åŠ åˆ©ç¦å°¼äºšå·æ—§é‡‘å±± Mesa è¡— 39 å· 108A å¥—æˆ¿çš„ Artifex Software Inc.è·å–æ›´å¤šä¿¡æ¯ã€‚

æœ¬æ–‡æ¡£æ¶µç›–äº†æ‰€æœ‰ç‰ˆæœ¬ï¼Œç›´è‡³ 1.24.4ã€‚

![Discord logo](https://discord.gg/TSpYGBW4eq)

### æå–æ–‡æœ¬çš„æ–¹æ³•

+   [å¢å¼ºæ–‡æœ¬æå–](https://artifex.com/blog/rag-llm-and-pdf-enhanced-text-extraction)

+   [ä½¿ç”¨ PyMuPDF è½¬æ¢ä¸º Markdown æ–‡æœ¬](https://artifex.com/blog/rag-llm-and-pdf-conversion-to-markdown-text-with-pymupdf)

### åˆ›å»ºä¸€ä¸ªèŠå¤©æœºå™¨äººæ¥è®¨è®ºæ‚¨çš„æ–‡æ¡£

+   [åˆ›å»ºä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡ŒèŠå¤©æœºå™¨äºº](https://artifex.com/blog/creating-a-rag-chatbot-with-chatgpt-and-pymupdf)

+   [åˆ¶ä½œèŠå¤©æœºå™¨äºº GUI](https://artifex.com/blog/building-a-rag-chatbot-gui-with-the-chatgpt-api-and-pymupdf)

æ‚¨å¯¹æœ¬é¡µé¢æœ‰ä»»ä½•åé¦ˆå—ï¼Ÿ

* * *

æ­¤è½¯ä»¶æŒ‰åŸæ ·æä¾›ï¼Œä¸æä¾›ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„æ‹…ä¿ã€‚æ­¤è½¯ä»¶åœ¨è®¸å¯ä¸‹åˆ†å‘ï¼Œé™¤éæ˜ç¡®æˆæƒï¼Œå¦åˆ™ä¸å¾—å¤åˆ¶ã€ä¿®æ”¹æˆ–åˆ†å‘ã€‚è¯·å‚é˜…è®¸å¯ä¿¡æ¯ï¼Œè¯¦è§[artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)ï¼Œæˆ–è”ç³»ç¾å›½åŠ åˆ©ç¦å°¼äºšå·æ—§é‡‘å±± Mesa è¡— 39 å· 108A å¥—æˆ¿çš„ Artifex Software Inc.è·å–æ›´å¤šä¿¡æ¯ã€‚

æœ¬æ–‡æ¡£æ¶µç›–äº†æ‰€æœ‰ç‰ˆæœ¬ï¼Œç›´è‡³ 1.24.4ã€‚

![Discord logo](https://discord.gg/TSpYGBW4eq)
