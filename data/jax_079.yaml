- en: 'JEP 18137: Scope of JAX NumPy & SciPy Wrappers'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: JEP 18137ï¼šJAX NumPy å’Œ SciPy åŒ…çš„èŒƒå›´
- en: åŸæ–‡ï¼š[`jax.readthedocs.io/en/latest/jep/18137-numpy-scipy-scope.html`](https://jax.readthedocs.io/en/latest/jep/18137-numpy-scipy-scope.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[`jax.readthedocs.io/en/latest/jep/18137-numpy-scipy-scope.html`](https://jax.readthedocs.io/en/latest/jep/18137-numpy-scipy-scope.html)
- en: '*Jake VanderPlas*'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '*Jake VanderPlas*'
- en: '*October 2023*'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '*2023 å¹´ 10 æœˆ*'
- en: Until now, the intended scope of `jax.numpy` and `jax.scipy` has been relatively
    ill-defined. This document proposes a well-defined scope for these packages to
    better guide and evaluate future contributions, and to motivate the removal of
    some out-of-scope code.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ`jax.numpy` å’Œ `jax.scipy` çš„é¢„æœŸèŒƒå›´ç›¸å¯¹æ¨¡ç³Šã€‚æœ¬æ–‡æå‡ºäº†è¿™äº›åŒ…çš„æ˜ç¡®å®šä¹‰èŒƒå›´ï¼Œä»¥æ›´å¥½åœ°æŒ‡å¯¼å’Œè¯„ä¼°æœªæ¥çš„è´¡çŒ®ï¼Œå¹¶ä¿ƒä½¿ç§»é™¤ä¸€äº›è¶…å‡ºèŒƒå›´çš„ä»£ç ã€‚
- en: Background
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: èƒŒæ™¯
- en: From the beginning, JAX has aimed to provide a NumPy-like API for executing
    code in XLA, and a big part of the projectâ€™s development has been building out
    the `jax.numpy` and `jax.scipy` namespaces as JAX-based implementations of NumPy
    and SciPy APIs. There has always been an implicit understanding that some parts
    of [`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy "(in
    NumPy v2.0)") and [`scipy`](https://docs.scipy.org/doc/scipy/index.html#module-scipy
    "(in SciPy v1.13.1)") are out-of-scope for JAX, but this scope has not been well
    defined. This can lead to confusion and frustration for contributors, because
    thereâ€™s no clear answer to whether potential `jax.numpy` and `jax.scipy` contributions
    will be accepted into JAX.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: ä»ä¸€å¼€å§‹ï¼ŒJAX çš„ç›®æ ‡æ˜¯ä¸ºåœ¨ XLA ä¸­æ‰§è¡Œä»£ç æä¾›ç±»ä¼¼äº NumPy çš„ APIï¼Œé¡¹ç›®çš„å‘å±•çš„ä¸€å¤§éƒ¨åˆ†æ˜¯å»ºç«‹ `jax.numpy` å’Œ `jax.scipy`
    å‘½åç©ºé—´ï¼Œä½œä¸ºåŸºäº JAX çš„ NumPy å’Œ SciPy API å®ç°ã€‚ä¸€ç›´æœ‰ä¸€ä¸ªéšå«çš„è®¤è¯†ï¼Œå³[`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(åœ¨ NumPy v2.0 ä¸­)")å’Œ [`scipy`](https://docs.scipy.org/doc/scipy/index.html#module-scipy
    "(åœ¨ SciPy v1.13.1 ä¸­)") çš„æŸäº›éƒ¨åˆ†è¶…å‡ºäº† JAX çš„èŒƒå›´ï¼Œä½†è¿™ä¸€èŒƒå›´å¹¶æ²¡æœ‰æ˜ç¡®å®šä¹‰ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´è´¡çŒ®è€…å›°æƒ‘å’Œæ²®ä¸§ï¼Œå› ä¸ºå¯¹äºæ½œåœ¨çš„ `jax.numpy`
    å’Œ `jax.scipy` è´¡çŒ®æ˜¯å¦ä¼šè¢«æ¥å—ï¼Œæ²¡æœ‰æ˜ç¡®çš„ç­”æ¡ˆã€‚
- en: Why Limit the Scope?
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆé™åˆ¶èŒƒå›´ï¼Ÿ
- en: 'To avoid leaving this unsaid, we should be explicit: it is a fact that any
    code included in a project like JAX incurs a small but nonzero ongoing maintenance
    burden for the developers. The success of a project over time directly relates
    to the ability of maintainers to continue this maintenance for the sum of all
    the projectâ€™s parts: documenting functionality, responding to questions, fixing
    bugs, etc. For long-term success and sustainability of any software tool, itâ€™s
    vital that maintainers carefully weigh whether any particular contribution will
    be a net positive for the project given its goals and resources.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†é¿å…é—æ¼ï¼Œæˆ‘ä»¬åº”è¯¥æ˜ç¡®ä¸€ç‚¹ï¼šåƒ JAX è¿™æ ·çš„é¡¹ç›®ä¸­åŒ…å«çš„ä»»ä½•ä»£ç éƒ½ä¼šä¸ºå¼€å‘è€…å¸¦æ¥ä¸€å®šçš„æŒç»­ç»´æŠ¤è´Ÿæ‹…ï¼Œè™½ç„¶å°ä½†éé›¶ã€‚é¡¹ç›®é•¿æœŸæˆåŠŸç›´æ¥ä¸ç»´æŠ¤è€…èƒ½å¦ç»§ç»­ä¸ºé¡¹ç›®çš„æ‰€æœ‰éƒ¨åˆ†æ‰¿æ‹…ç»´æŠ¤å·¥ä½œæœ‰å…³ï¼šåŒ…æ‹¬æ–‡æ¡£åŠŸèƒ½çš„è®°å½•ã€å›ç­”é—®é¢˜ã€ä¿®å¤é”™è¯¯ç­‰ã€‚å¯¹äºä»»ä½•è½¯ä»¶å·¥å…·çš„é•¿æœŸæˆåŠŸå’Œå¯æŒç»­æ€§ï¼Œç»´æŠ¤è€…å¿…é¡»ä»”ç»†æƒè¡¡æ¯ä¸€é¡¹è´¡çŒ®æ˜¯å¦å¯¹é¡¹ç›®çš„ç›®æ ‡å’Œèµ„æºæ˜¯å‡€æ­£é¢å½±å“ã€‚
- en: Evaluation Rubric
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¯„ä¼°æ ‡å‡†
- en: This document proposes a rubric of six axes along which the scope of any particular
    [`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy "(in
    NumPy v2.0)") or [`scipy`](https://docs.scipy.org/doc/scipy/index.html#module-scipy
    "(in SciPy v1.13.1)") API can be judged for inclusion into JAX. An API which is
    strong along all axes is an excellent candidate for inclusion in the JAX package;
    a strong weakness along *any* of the six axes is a good argument against inclusion
    in JAX.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ–‡æå‡ºäº†ä¸€ä¸ªå…­è½´è¯„ä¼°æ ‡å‡†ï¼Œç”¨æ¥è¯„åˆ¤ä»»ä½•ç‰¹å®š[`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(åœ¨ NumPy v2.0 ä¸­)")æˆ–[`scipy`](https://docs.scipy.org/doc/scipy/index.html#module-scipy
    "(åœ¨ SciPy v1.13.1 ä¸­)") API çš„é€‚ç”¨èŒƒå›´ï¼Œä»¥ç¡®å®šæ˜¯å¦é€‚åˆçº³å…¥ JAXã€‚åœ¨æ‰€æœ‰è½´ä¸Šè¡¨ç°å¼ºåŠ²çš„ API æ˜¯çº³å…¥ JAX åŒ…çš„æä½³å€™é€‰ï¼›åœ¨å…­ä¸ªè½´ä¸­çš„ä»»ä½•ä¸€ä¸ªä¸Šè¡¨ç°æå·®éƒ½æ˜¯ä¸é€‚åˆçº³å…¥
    JAX çš„å……åˆ†ç†ç”±ã€‚
- en: 'Axis 1: XLA alignment'
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è½´ 1ï¼šXLA å¯¹é½
- en: 'The first axis we consider is the degree to which the proposed API aligns with
    native XLA operations. For example, `jax.numpy.exp()` is a function that more-or-less
    directly mirrors `jax.lax.exp`. A large number of functions in [`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(in NumPy v2.0)"), [`scipy.special`](https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special
    "(in SciPy v1.13.1)"), [`numpy.linalg`](https://numpy.org/doc/stable/reference/routines.linalg.html#module-numpy.linalg
    "(in NumPy v2.0)"), `scipy.linalg`, and others meet this criteria: such functions
    pass the XLA-alignment check when considering their inclusion into JAX.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è€ƒè™‘çš„ç¬¬ä¸€ä¸ªæ–¹å‘æ˜¯å»ºè®® API ä¸æœ¬åœ° XLA æ“ä½œçš„å¯¹é½ç¨‹åº¦ã€‚ä¾‹å¦‚ï¼Œ`jax.numpy.exp()` å‡½æ•°å‡ ä¹ç›´æ¥é•œåƒäº† `jax.lax.exp`ã€‚[`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(åœ¨ NumPy v2.0)")ã€[`scipy.special`](https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special
    "(åœ¨ SciPy v1.13.1)")ã€[`numpy.linalg`](https://numpy.org/doc/stable/reference/routines.linalg.html#module-numpy.linalg
    "(åœ¨ NumPy v2.0)")ã€`scipy.linalg` ç­‰ä¸­çš„å¤§å¤šæ•°å‡½æ•°ç¬¦åˆæ­¤æ ‡å‡†ï¼šè¿™ç±»å‡½æ•°åœ¨è€ƒè™‘å…¶æ˜¯å¦åº”åŒ…å«åœ¨ JAX ä¸­æ—¶é€šè¿‡äº† XLA å¯¹é½æ£€æŸ¥ã€‚
- en: On the other end, there are functions like [`numpy.unique()`](https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique
    "(in NumPy v2.0)"), which do not directly correspond to any XLA operation, and
    in some cases are fundamentally incompatible with JAXâ€™s current computational
    model, which requires statically-shaped arrays (e.g. `unique` returns a value-dependent
    dynamic array shape). Such functions do not pass the XLA alignment check when
    considering their inclusion into JAX.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€æ–¹é¢ï¼Œæœ‰äº›å‡½æ•°å¦‚[`numpy.unique()`](https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique
    "(åœ¨ NumPy v2.0)")ï¼Œå®ƒä»¬ä¸ç›´æ¥å¯¹åº”ä»»ä½• XLA æ“ä½œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ç”šè‡³ä¸ JAX çš„å½“å‰è®¡ç®—æ¨¡å‹æ ¹æœ¬ä¸å…¼å®¹ï¼Œåè€…è¦æ±‚é™æ€å½¢çŠ¶çš„æ•°ç»„ï¼ˆä¾‹å¦‚ `unique`
    è¿”å›ä¾èµ–äºå€¼çš„åŠ¨æ€æ•°ç»„å½¢çŠ¶ï¼‰ã€‚è¿™ç±»å‡½æ•°åœ¨è€ƒè™‘å…¶æ˜¯å¦åº”åŒ…å«åœ¨ JAX ä¸­æ—¶æœªèƒ½é€šè¿‡ XLA å¯¹é½æ£€æŸ¥ã€‚
- en: We also consider as part of this axis the need for pure function semantics.
    For example, [`numpy.random`](https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random
    "(in NumPy v2.0)") is built on an implicitly-updated state-based RNG, which is
    fundamentally incompatible with JAXâ€™s computational model built on XLA.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜è€ƒè™‘çº¯å‡½æ•°è¯­ä¹‰çš„å¿…è¦æ€§ã€‚ä¾‹å¦‚ï¼Œ[`numpy.random`](https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random
    "(åœ¨ NumPy v2.0)") åŸºäºä¸€ä¸ªéšå¼æ›´æ–°çš„åŸºäºçŠ¶æ€çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œè¿™ä¸åŸºäº XLA çš„ JAX è®¡ç®—æ¨¡å‹æ ¹æœ¬ä¸å…¼å®¹ã€‚
- en: 'Axis 2: Array API Alignment'
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è½´ 2ï¼šæ•°ç»„ API å¯¹é½
- en: 'The second axis we consider focuses on the [Python Array API Standard](https://data-apis.org/array-api/2022.12/):
    this is in some senses a community-driven outline of which array operations are
    central to array-oriented programming across a wide range of user communities.
    If an API in [`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(in NumPy v2.0)") or [`scipy`](https://docs.scipy.org/doc/scipy/index.html#module-scipy
    "(in SciPy v1.13.1)") is listed within the Array API standard, it is a strong
    signal that JAX should include it. Using the example from above, the Array API
    standard includes several variants of [`numpy.unique()`](https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique
    "(in NumPy v2.0)") (`unique_all`, `unique_counts`, `unique_inverse`, `unique_values`)
    which suggests that, despite the function not being precisely aligned with XLA,
    it is important enough to the Python user community that JAX should perhaps implement
    it.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è€ƒè™‘çš„ç¬¬äºŒä¸ªæ–¹å‘é›†ä¸­åœ¨[Python æ•°ç»„ API æ ‡å‡†](https://data-apis.org/array-api/2022.12/)ä¸Šï¼šåœ¨æŸäº›æ„ä¹‰ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„å¤§çº²ï¼Œç”¨äºå®šä¹‰åœ¨å„ç§ç”¨æˆ·ç¤¾åŒºä¸­é‡è¦çš„é¢å‘æ•°ç»„ç¼–ç¨‹çš„æ•°ç»„æ“ä½œã€‚å¦‚æœ[`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(åœ¨ NumPy v2.0)") æˆ– [`scipy`](https://docs.scipy.org/doc/scipy/index.html#module-scipy
    "(åœ¨ SciPy v1.13.1)") ä¸­çš„ API åˆ—åœ¨æ•°ç»„ API æ ‡å‡†ä¸­ï¼Œè¿™è¡¨æ˜ JAX åº”è¯¥åŒ…å«å®ƒã€‚ä»¥ä¸Šè¿°ç¤ºä¾‹ä¸ºä¾‹ï¼Œæ•°ç»„ API æ ‡å‡†åŒ…å«äº† [`numpy.unique()`](https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique
    "(åœ¨ NumPy v2.0)") çš„å¤šä¸ªå˜ä½“ï¼ˆ`unique_all`ã€`unique_counts`ã€`unique_inverse`ã€`unique_values`ï¼‰ï¼Œè¿™è¡¨æ˜ï¼Œå°½ç®¡è¯¥å‡½æ•°ä¸
    XLA çš„ç²¾ç¡®å¯¹é½å¹¶ä¸å®Œå…¨ï¼Œä½†å®ƒå¯¹äº Python ç”¨æˆ·ç¤¾åŒºéå¸¸é‡è¦ï¼Œå› æ­¤ JAX æˆ–è®¸åº”è¯¥å®ç°å®ƒã€‚
- en: 'Axis 3: Existence of Downstream Implementations'
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è½´ 3ï¼šä¸‹æ¸¸å®ç°çš„å­˜åœ¨
- en: 'For functionality that does not align with Axis 1 or 2, an important consideration
    for inclusion into JAX is whether there exist well-supported downstream packages
    that supply the functionality in question. A good example of this is [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(in SciPy v1.13.1)"): while JAX does include a minimal set of wrappers of [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(in SciPy v1.13.1)") functionality, a much more complete treatment exists in
    the [JAXopt](https://jaxopt.github.io/) package, which is actively maintained
    by JAX collaborators. In cases like this, we should lean toward pointing users
    and contributors to these specialized packages rather than re-implementing such
    APIs in JAX itself.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºä¸ç¬¦åˆ Axis 1 æˆ– 2 çš„åŠŸèƒ½ï¼Œæ˜¯å¦å­˜åœ¨è‰¯å¥½æ”¯æŒçš„ä¸‹æ¸¸åŒ…ä¾›åº”è¯¥åŠŸèƒ½æ˜¯çº³å…¥ JAX çš„ä¸€ä¸ªé‡è¦è€ƒè™‘å› ç´ ã€‚ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(åœ¨ SciPy v1.13.1)")ï¼šè™½ç„¶ JAX åŒ…å«äº†å¯¹ [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(åœ¨ SciPy v1.13.1)") åŠŸèƒ½çš„æœ€å°åŒ…è£…é›†ï¼Œä½†æ›´å®Œæ•´çš„å®ç°å­˜åœ¨äºç”± JAX åä½œè€…ç§¯æç»´æŠ¤çš„ [JAXopt](https://jaxopt.github.io/)
    åŒ…ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”å€¾å‘äºæŒ‡å‘ç”¨æˆ·å’Œè´¡çŒ®è€…è¿™äº›ä¸“ä¸šåŒ–çš„åŒ…ï¼Œè€Œä¸æ˜¯åœ¨ JAX è‡ªèº«é‡æ–°å®ç°è¿™äº› APIã€‚
- en: 'Axis 4: Complexity & Robustness of Implementation'
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 'Axis 4: Implementation çš„å¤æ‚æ€§ä¸å¥å£®æ€§'
- en: 'For functionality that does not align with XLA, one consideration is the degree
    of complexity of the proposed implementation. This aligns to some degree with
    Axis 1, but nevertheless is important to call out. A number of functions have
    been contributed to JAX which have relatively complex implementations which are
    difficult to validate and introduce outsized maintenance burdens; an example is
    `jax.scipy.special.bessel_jn()`: as of the writing of this JEP, its current implementation
    is a non-straightforward iterative approximation that has [convergence issues
    in some domains](https://github.com/google/jax/issues/12402#issuecomment-1384828637),
    and [proposed fixes](https://github.com/google/jax/pull/17038/files) introduce
    further complexity. Had we more carefully weighed the complexity and robustness
    of the implementation when accepting the contribution, we may have chosen not
    to accept this contribution to the package.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºä¸ç¬¦åˆ XLA çš„åŠŸèƒ½ï¼Œä¸€ä¸ªè€ƒè™‘å› ç´ æ˜¯æè®®å®ç°çš„å¤æ‚ç¨‹åº¦ã€‚è¿™åœ¨æŸç§ç¨‹åº¦ä¸Šä¸ Axis 1 ä¸€è‡´ï¼Œä½†ä»ç„¶æ˜¯éœ€è¦å¼ºè°ƒçš„ã€‚æœ‰è®¸å¤šå‡½æ•°å·²ç»è´¡çŒ®ç»™ JAXï¼Œå®ƒä»¬å…·æœ‰ç›¸å¯¹å¤æ‚çš„å®ç°ï¼Œéš¾ä»¥éªŒè¯å¹¶å¼•å…¥äº†è¿‡å¤šçš„ç»´æŠ¤è´Ÿæ‹…ï¼›ä¸€ä¸ªä¾‹å­æ˜¯
    `jax.scipy.special.bessel_jn()`ï¼šåœ¨æ’°å†™æœ¬ JEP æ—¶ï¼Œå…¶å½“å‰å®ç°æ˜¯ä¸€ä¸ªéç›´è§‚çš„è¿­ä»£é€¼è¿‘ï¼Œå­˜åœ¨ [æŸäº›é¢†åŸŸçš„æ”¶æ•›é—®é¢˜](https://github.com/google/jax/issues/12402#issuecomment-1384828637)ï¼Œè€Œ
    [æå‡ºçš„ä¿®å¤æ–¹æ¡ˆ](https://github.com/google/jax/pull/17038/files) åˆ™å¼•å…¥äº†æ›´å¤šçš„å¤æ‚æ€§ã€‚å¦‚æœåœ¨æ¥å—è´¡çŒ®æ—¶æ›´åŠ ä»”ç»†åœ°æƒè¡¡äº†å®ç°çš„å¤æ‚æ€§å’Œå¥å£®æ€§ï¼Œæˆ‘ä»¬å¯èƒ½é€‰æ‹©ä¸æ¥å—è¿™ä¸ªåŒ…çš„è´¡çŒ®ã€‚
- en: 'Axis 5: Functional vs. Object-Oriented APIs'
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 'Axis 5: åŠŸèƒ½å‹ vs. é¢å‘å¯¹è±¡çš„ API'
- en: JAX works best with functional APIs rather than object-oriented APIs. Object-oriented
    APIs can often hide impure semantics, making them often difficult to implement
    well. NumPy and SciPy generally stick to functional APIs, but sometimes provide
    object-oriented convenience wrappers.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: JAX æœ€é€‚åˆä½¿ç”¨åŠŸèƒ½å‹ API è€Œä¸æ˜¯é¢å‘å¯¹è±¡çš„ APIã€‚é¢å‘å¯¹è±¡çš„ API é€šå¸¸ä¼šéšè—ä¸çº¯çš„è¯­ä¹‰ï¼Œä½¿å…¶å¾€å¾€éš¾ä»¥å®ç°è‰¯å¥½ã€‚NumPy å’Œ SciPy
    é€šå¸¸åšæŒä½¿ç”¨åŠŸèƒ½å‹ APIï¼Œä½†æœ‰æ—¶æä¾›é¢å‘å¯¹è±¡çš„ä¾¿åˆ©åŒ…è£…å™¨ã€‚
- en: Examples of this are `numpy.polynomial.Polynomial`, which wraps lower-level
    operations like [`numpy.polyadd()`](https://numpy.org/doc/stable/reference/generated/numpy.polyadd.html#numpy.polyadd
    "(in NumPy v2.0)"), [`numpy.polydiv()`](https://numpy.org/doc/stable/reference/generated/numpy.polydiv.html#numpy.polydiv
    "(in NumPy v2.0)"), etc. In general, when there are both functional and object-oriented
    APIs available, JAX should avoid providing wrappers for the object-oriented APIs
    and instead provide wrappers for the functional APIs.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ `numpy.polynomial.Polynomial`ï¼Œå®ƒåŒ…è£…äº†åƒ [`numpy.polyadd()`](https://numpy.org/doc/stable/reference/generated/numpy.polyadd.html#numpy.polyadd
    "(åœ¨ NumPy v2.0)")ï¼Œ[`numpy.polydiv()`](https://numpy.org/doc/stable/reference/generated/numpy.polydiv.html#numpy.polydiv
    "(åœ¨ NumPy v2.0)") ç­‰ä½çº§æ“ä½œã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“æ—¢æœ‰åŠŸèƒ½å‹ API åˆæœ‰é¢å‘å¯¹è±¡ API æ—¶ï¼ŒJAX åº”é¿å…ä¸ºé¢å‘å¯¹è±¡ API æä¾›åŒ…è£…å™¨ï¼Œè€Œåº”ä¸ºåŠŸèƒ½å‹
    API æä¾›åŒ…è£…å™¨ã€‚
- en: In cases where only the object-oriented APIs exist, JAX should avoid providing
    wrappers unless the case is strong along other axes.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨åªå­˜åœ¨é¢å‘å¯¹è±¡çš„ API çš„æƒ…å†µä¸‹ï¼ŒJAX åº”é¿å…æä¾›åŒ…è£…å™¨ï¼Œé™¤éåœ¨å…¶ä»–è½´ä¸Šæœ‰å¾ˆå¼ºçš„æ¡ˆä¾‹æ”¯æŒã€‚
- en: 'Axis 6: General â€œImportanceâ€ to JAX Users & Stakeholders'
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 'Axis 6: å¯¹ JAX ç”¨æˆ·å’Œåˆ©ç›Šç›¸å…³è€…çš„â€œé‡è¦æ€§â€'
- en: The decision to include a NumPy/SciPy API in JAX should also take into account
    the importance of the algorithm to the general user community. It is admittedly
    difficult to quantify who is a â€œstakeholderâ€ and how this importance should be
    measured; but we include this to make clear that any decision about what to include
    in JAXâ€™s NumPy and SciPy wrappers will involve some amount of discretion that
    cannot be easily quantified.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: å†³å®šåœ¨JAXä¸­åŒ…å«NumPy/SciPy APIè¿˜åº”è€ƒè™‘åˆ°è¯¥ç®—æ³•å¯¹ä¸€èˆ¬ç”¨æˆ·ç¤¾åŒºçš„é‡è¦æ€§ã€‚è¯šç„¶ï¼Œå¾ˆéš¾é‡åŒ–è°æ˜¯â€œåˆ©ç›Šç›¸å…³è€…â€ä»¥åŠå¦‚ä½•è¡¡é‡è¿™ç§é‡è¦æ€§ï¼›ä½†æˆ‘ä»¬åŒ…æ‹¬è¿™ä¸€ç‚¹æ˜¯ä¸ºäº†æ˜ç¡®è¯´æ˜ï¼Œåœ¨JAXçš„NumPyå’ŒSciPyåŒ…è£…ä¸­åŒ…å«ä»€ä¹ˆçš„ä»»ä½•å†³å®šéƒ½å°†æ¶‰åŠæŸç§ä¸å®¹æ˜“é‡åŒ–çš„è‡ªç”±è£é‡æƒã€‚
- en: 'For existing APIs, searches for usage in github may be useful in establishing
    importance or lack thereof; as an example, we might return to `jax.scipy.special.bessel_jn()`
    discussed above: a search shows that this function has only a [handful of uses](https://github.com/search?q=jax+AND+%22bessel_jn%28%22+NOT+MathJax&amp;type=code)
    on github, probably partly to do with the previously mentioned accuracy issues.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºç°æœ‰APIï¼Œé€šè¿‡åœ¨githubä¸­æœç´¢ä½¿ç”¨æƒ…å†µå¯èƒ½æœ‰åŠ©äºç¡®å®šå…¶é‡è¦æ€§æˆ–ç¼ºå¤±ï¼›ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å›åˆ°ä¸Šé¢è®¨è®ºè¿‡çš„ `jax.scipy.special.bessel_jn()`
    ï¼šæœç´¢æ˜¾ç¤ºï¼Œè¿™ä¸ªå‡½æ•°åœ¨githubä¸Šä»…æœ‰å°‘æ•°ç”¨ä¾‹ï¼Œè¿™å¯èƒ½éƒ¨åˆ†åŸå› ä¸å…ˆå‰æåˆ°çš„ç²¾åº¦é—®é¢˜æœ‰å…³ã€‚
- en: 'Evaluation: whatâ€™s in scope?'
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¯„ä¼°ï¼šä»€ä¹ˆåœ¨èŒƒå›´å†…ï¼Ÿ
- en: In this section, weâ€™ll attempt to evaluate the NumPy and SciPy APIs, including
    some examples from the current JAX API, in light of the above rubric. This will
    not be a comprehensive listing of all existing functions and classes, but rather
    a more general discussion by submodule and topic, with relevant examples.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å°è¯•æ ¹æ®ä¸Šè¿°æ ‡å‡†è¯„ä¼°NumPyå’ŒSciPyçš„APIï¼ŒåŒ…æ‹¬å½“å‰JAX APIä¸­çš„ä¸€äº›ç¤ºä¾‹ã€‚è¿™ä¸ä¼šæ˜¯æ‰€æœ‰ç°æœ‰å‡½æ•°å’Œç±»çš„è¯¦å°½åˆ—è¡¨ï¼Œè€Œæ˜¯ä¸€ä¸ªæ›´ä¸€èˆ¬çš„å­æ¨¡å—å’Œä¸»é¢˜è®¨è®ºï¼Œé™„å¸¦ç›¸å…³ç¤ºä¾‹ã€‚
- en: NumPy APIs
  id: totrans-30
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: NumPy API
- en: âœ… `numpy` namespace
  id: totrans-31
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âœ… `numpy` å‘½åç©ºé—´
- en: We consider the functions in the main [`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(in NumPy v2.0)") namespace to be essentially all in-scope for JAX, due to its
    general alignment with XLA (Axis 1) and the Python Array API (Axis 2), as well
    as its general importance to the JAX user community (Axis 6). Some functions are
    perhaps borderline (functions like [`numpy.intersect1d()`](https://numpy.org/doc/stable/reference/generated/numpy.intersect1d.html#numpy.intersect1d
    "(in NumPy v2.0)"), `np.setdiff1d()`, `np.union1d()` arguably fail parts of the
    rubric) but for simplicity we declare that all array functions in the main numpy
    namespace are in-scope for JAX.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è®¤ä¸ºä¸»è¦ [`numpy`](https://numpy.org/doc/stable/reference/index.html#module-numpy
    "(åœ¨ NumPy v2.0)") å‘½åç©ºé—´ä¸­çš„å‡½æ•°åŸºæœ¬ä¸Šéƒ½é€‚ç”¨äºJAXï¼Œå› ä¸ºå®ƒä¸XLAï¼ˆè½´ 1ï¼‰å’ŒPythonæ•°ç»„APIï¼ˆè½´ 2ï¼‰çš„ä¸€èˆ¬å¯¹é½æ€§ä»¥åŠå¯¹JAXç”¨æˆ·ç¤¾åŒºçš„ä¸€èˆ¬é‡è¦æ€§ï¼ˆè½´
    6ï¼‰ä¿æŒä¸€è‡´ã€‚ä¸€äº›å‡½æ•°å¯èƒ½å¤„äºè¾¹ç•Œåœ°å¸¦ï¼ˆä¾‹å¦‚ [`numpy.intersect1d()`](https://numpy.org/doc/stable/reference/generated/numpy.intersect1d.html#numpy.intersect1d
    "(åœ¨ NumPy v2.0)")ï¼Œ`np.setdiff1d()`ï¼Œ`np.union1d()` å¯èƒ½åœ¨æŸäº›æ ‡å‡†ä¸‹ä¸å®Œå…¨ç¬¦åˆï¼‰ï¼Œä½†ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å£°æ˜æ‰€æœ‰ä¸»è¦numpyå‘½åç©ºé—´ä¸­çš„æ•°ç»„å‡½æ•°éƒ½é€‚ç”¨äºJAXã€‚
- en: âœ… `numpy.linalg` & `numpy.fft`
  id: totrans-33
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âœ… `numpy.linalg` å’Œ `numpy.fft`
- en: The [`numpy.linalg`](https://numpy.org/doc/stable/reference/routines.linalg.html#module-numpy.linalg
    "(in NumPy v2.0)") and [`numpy.fft`](https://numpy.org/doc/stable/reference/routines.fft.html#module-numpy.fft
    "(in NumPy v2.0)") submodules contain many functions that broadly align with functionality
    provided by XLA. Others have complicated device-specific lowerings, but represent
    a case where importance to stakeholders (Axis 6) outweighs complexity. For this
    reason, we deem both of these submodules in-scope for JAX.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '[`numpy.linalg`](https://numpy.org/doc/stable/reference/routines.linalg.html#module-numpy.linalg
    "(åœ¨ NumPy v2.0)") å’Œ [`numpy.fft`](https://numpy.org/doc/stable/reference/routines.fft.html#module-numpy.fft
    "(åœ¨ NumPy v2.0)") å­æ¨¡å—åŒ…å«è®¸å¤šä¸XLAæä¾›çš„åŠŸèƒ½å¹¿æ³›å¯¹é½çš„å‡½æ•°ã€‚å…¶ä»–å‡½æ•°å…·æœ‰å¤æ‚çš„ç‰¹å®šè®¾å¤‡çš„ä½çº§å®ç°ï¼Œä½†ä»£è¡¨ä¸€ç§æƒ…å†µï¼Œå…¶ä¸­å¯¹åˆ©ç›Šç›¸å…³è€…çš„é‡è¦æ€§ï¼ˆè½´
    6ï¼‰è¶…è¿‡äº†å¤æ‚æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸¤ä¸ªå­æ¨¡å—éƒ½é€‚ç”¨äºJAXã€‚'
- en: âŒ `numpy.random`
  id: totrans-35
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `numpy.random`
- en: '[`numpy.random`](https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random
    "(in NumPy v2.0)") is out-of-scope for JAX, because state-based RNGs are fundamentally
    incompatible with JAXâ€™s computation model. We instead focus on `jax.random`, which
    offers similar functionality using a counter-based PRNG.'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '[`numpy.random`](https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random
    "(åœ¨ NumPy v2.0)") å¯¹äºJAXè€Œè¨€è¶…å‡ºèŒƒå›´ï¼Œå› ä¸ºåŸºäºçŠ¶æ€çš„éšæœºæ•°ç”Ÿæˆå™¨ä¸JAXçš„è®¡ç®—æ¨¡å‹åŸºæœ¬ä¸å…¼å®¹ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†é‡ç‚¹æ”¾åœ¨ `jax.random`
    ä¸Šï¼Œå®ƒä½¿ç”¨åŸºäºè®¡æ•°å™¨çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨æä¾›ç±»ä¼¼çš„åŠŸèƒ½ã€‚'
- en: âŒ `numpy.ma` & `numpy.polynomial`
  id: totrans-37
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `numpy.ma` å’Œ `numpy.polynomial`
- en: The [`numpy.ma`](https://numpy.org/doc/stable/reference/maskedarray.generic.html#module-numpy.ma
    "(in NumPy v2.0)") and [`numpy.polynomial`](https://numpy.org/doc/stable/reference/routines.polynomials-package.html#module-numpy.polynomial
    "(in NumPy v2.0)") submodules are mostly concerned with providing object-oriented
    interfaces to computations that can be expressed via other functional means (Axis
    5); for this reason, we deem them out-of-scope for JAX.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[`numpy.ma`](https://numpy.org/doc/stable/reference/maskedarray.generic.html#module-numpy.ma
    "(åœ¨ NumPy v2.0)") å’Œ [`numpy.polynomial`](https://numpy.org/doc/stable/reference/routines.polynomials-package.html#module-numpy.polynomial
    "(åœ¨ NumPy v2.0)") å­æ¨¡å—ä¸»è¦å…³æ³¨é€šè¿‡å…¶ä»–å‡½æ•°æ‰‹æ®µè¡¨è¾¾çš„è®¡ç®—çš„é¢å‘å¯¹è±¡æ¥å£ï¼ˆè½´5ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬ä¸é€‚ç”¨äº JAXã€‚'
- en: âŒ `numpy.testing`
  id: totrans-39
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `numpy.testing`
- en: NumPyâ€™s testing functionality only really makes sense for host-side computation,
    and so we donâ€™t include any wrappers for it in JAX. That said, JAX arrays are
    compatible with [`numpy.testing`](https://numpy.org/doc/stable/reference/routines.testing.html#module-numpy.testing
    "(in NumPy v2.0)"), and JAX makes frequent use of it throughout the JAX test suite.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: NumPy çš„æµ‹è¯•åŠŸèƒ½åªå¯¹ä¸»æœºç«¯è®¡ç®—æœ‰æ„ä¹‰ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ JAX ä¸­ä¸åŒ…å«ä»»ä½•åŒ…è£…å™¨ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒJAX æ•°ç»„ä¸ [`numpy.testing`](https://numpy.org/doc/stable/reference/routines.testing.html#module-numpy.testing
    "(åœ¨ NumPy v2.0)") å…¼å®¹ï¼Œå¹¶ä¸”åœ¨æ•´ä¸ª JAX æµ‹è¯•å¥—ä»¶ä¸­é¢‘ç¹ä½¿ç”¨å®ƒã€‚
- en: SciPy APIs
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SciPy API
- en: SciPy has no functions in the top-level namespace, but includes a number of
    submodules. We consider each below, leaving out modules which have been deprecated.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: SciPy æ²¡æœ‰é¡¶å±‚å‘½åç©ºé—´ä¸­çš„å‡½æ•°ï¼Œä½†åŒ…å«å¤šä¸ªå­æ¨¡å—ã€‚æˆ‘ä»¬é€ä¸€è€ƒè™‘æ¯ä¸ªå­æ¨¡å—ï¼Œç•¥è¿‡å·²å¼ƒç”¨çš„æ¨¡å—ã€‚
- en: âŒ `scipy.cluster`
  id: totrans-43
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.cluster`
- en: 'The [`scipy.cluster`](https://docs.scipy.org/doc/scipy/reference/cluster.html#module-scipy.cluster
    "(in SciPy v1.13.1)") module includes tools for hierarchical clustering, k-means,
    and related algorithms. These are weak along several axes, and would be better
    served by a downstream package. One function already exists within JAX (`jax.scipy.cluster.vq.vq()`)
    but has [no obvious usage](https://github.com/search?q=%22jax.scipy.cluster%22+AND+vq&amp;type=code&amp;p=5)
    on github: this suggests that clustering is not broadly important to JAX users.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.cluster`](https://docs.scipy.org/doc/scipy/reference/cluster.html#module-scipy.cluster
    "(åœ¨ SciPy v1.13.1)") æ¨¡å—åŒ…å«ç”¨äºå±‚æ¬¡èšç±»ã€Kå‡å€¼å’Œç›¸å…³ç®—æ³•çš„å·¥å…·ã€‚è¿™äº›åœ¨å¤šä¸ªæ–¹é¢è¡¨ç°ä¸ä½³ï¼Œæ›´é€‚åˆç”±ä¸‹æ¸¸åŒ…å¤„ç†ã€‚JAX ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªå‡½æ•°ï¼ˆ`jax.scipy.cluster.vq.vq()`ï¼‰ï¼Œä½†åœ¨
    [github](https://github.com/search?q=%22jax.scipy.cluster%22+AND+vq&amp;type=code&amp;p=5)
    ä¸Šæ²¡æœ‰æ˜æ˜¾çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œè¿™è¡¨æ˜èšç±»å¯¹äº JAX ç”¨æˆ·å¹¶ä¸å¹¿æ³›é‡è¦ã€‚'
- en: '*Recommendation: deprecate and remove `jax.scipy.cluster.vq()`.*'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šå¼ƒç”¨å¹¶ç§»é™¤ `jax.scipy.cluster.vq()`ã€‚*'
- en: âŒ `scipy.constants`
  id: totrans-46
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.constants`
- en: The [`scipy.constants`](https://docs.scipy.org/doc/scipy/reference/constants.html#module-scipy.constants
    "(in SciPy v1.13.1)") module includes mathematical and physical constants. These
    constants can be used directly with JAX, and so there is no reason to re-implement
    this in JAX.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.constants`](https://docs.scipy.org/doc/scipy/reference/constants.html#module-scipy.constants
    "(åœ¨ SciPy v1.13.1)") æ¨¡å—åŒ…å«æ•°å­¦å’Œç‰©ç†å¸¸æ•°ã€‚è¿™äº›å¸¸æ•°å¯ä»¥ç›´æ¥åœ¨ JAX ä¸­ä½¿ç”¨ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦åœ¨ JAX ä¸­é‡æ–°å®ç°ã€‚'
- en: âŒ `scipy.datasets`
  id: totrans-48
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.datasets`
- en: The [`scipy.datasets`](https://docs.scipy.org/doc/scipy/reference/datasets.html#module-scipy.datasets
    "(in SciPy v1.13.1)") module includes tools to fetch and load datasets. These
    fetched datasets can be used directly with JAX, and so there is no reason to re-implement
    this in JAX.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.datasets`](https://docs.scipy.org/doc/scipy/reference/datasets.html#module-scipy.datasets
    "(åœ¨ SciPy v1.13.1)") æ¨¡å—åŒ…å«è·å–å’ŒåŠ è½½æ•°æ®é›†çš„å·¥å…·ã€‚è¿™äº›è·å–çš„æ•°æ®é›†å¯ä»¥ç›´æ¥åœ¨ JAX ä¸­ä½¿ç”¨ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦åœ¨ JAX ä¸­é‡æ–°å®ç°ã€‚'
- en: âœ… `scipy.fft`
  id: totrans-50
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âœ… `scipy.fft`
- en: The [`scipy.fft`](https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft
    "(in SciPy v1.13.1)") module contains functions that broadly align with functionality
    provided by XLA, and fare well along other axes as well. For this reason, we deem
    them in-scope for JAX.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.fft`](https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft
    "(åœ¨ SciPy v1.13.1)") æ¨¡å—åŒ…å«ä¸ XLA æä¾›çš„åŠŸèƒ½å¤§è‡´å¯¹é½çš„å‡½æ•°ï¼Œå¹¶ä¸”åœ¨å…¶ä»–æ–¹é¢è¡¨ç°è‰¯å¥½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬é€‚ç”¨äº JAX çš„èŒƒå›´å†…ã€‚'
- en: âŒ `scipy.integrate`
  id: totrans-52
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.integrate`
- en: The [`scipy.integrate`](https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate
    "(in SciPy v1.13.1)") module contains functions for numerical integration. The
    more sophisticated of these (`quad`, `dblquad`, `ode`) are out-of-scope for JAX
    by axes 1 & 4, since they tend to be loopy algorithms based on dynamic numbers
    of evaluations. `jax.experimental.ode.odeint()` is related, but rather limited
    and not under any active development.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.integrate`](https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate
    "(åœ¨ SciPy v1.13.1 ä¸­)") æ¨¡å—åŒ…å«ç”¨äºæ•°å€¼ç§¯åˆ†çš„å‡½æ•°ã€‚å…¶ä¸­æ›´å¤æ‚çš„å‡½æ•°ï¼ˆ`quad`ã€`dblquad`ã€`ode`ï¼‰åŸºäºåŠ¨æ€è¯„ä¼°çš„å¾ªç¯ç®—æ³•ï¼Œæ ¹æ®è½´
    1 å’Œ 4 åº”è§†ä¸º JAX èŒƒå›´ä¹‹å¤–ã€‚`jax.experimental.ode.odeint()` ç›¸å…³ï¼Œä½†ç›¸å½“æœ‰é™ï¼Œæœªå¤„äºä»»ä½•æ´»è·ƒå¼€å‘çŠ¶æ€ã€‚'
- en: JAX does currently include `jax.scipy.integrate.trapezoid()`, but this is only
    because `numpy.trapz()` was recently deprecated in favor of this. For any particular
    input, its implementation could be replaced with one line of `jax.numpy` expressions,
    so itâ€™s not a particularly useful API to provide.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: JAX å½“å‰ç¡®å®åŒ…æ‹¬ `jax.scipy.integrate.trapezoid()`ï¼Œä½†è¿™ä»…å› ä¸º`numpy.trapz()` æœ€è¿‘å·²å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨æ­¤åŠŸèƒ½ã€‚å¯¹äºä»»ä½•ç‰¹å®šè¾“å…¥ï¼Œå…¶å®ç°å¯ä»¥ç”¨ä¸€è¡Œ
    `jax.numpy` è¡¨è¾¾å¼æ›¿æ¢ï¼Œå› æ­¤å®ƒå¹¶ä¸æ˜¯æä¾›çš„ç‰¹åˆ«æœ‰ç”¨çš„ APIã€‚
- en: Based on Axes 1, 2, 4, and 6, [`scipy.integrate`](https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate
    "(in SciPy v1.13.1)") should be considered out-of-scope for JAX.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºäºè½´ 1ã€2ã€4 å’Œ 6ï¼Œ[`scipy.integrate`](https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate
    "(åœ¨ SciPy v1.13.1 ä¸­)") åº”è¢«è§†ä¸º JAX èŒƒå›´ä¹‹å¤–ã€‚
- en: '*Recommendation: remove `jax.scipy.integrate.trapezoid()`, which was added
    in JAX 0.4.14.*'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šç§»é™¤ `jax.scipy.integrate.trapezoid()`ï¼Œæ­¤åŠŸèƒ½å·²åœ¨ JAX 0.4.14 ä¸­æ·»åŠ ã€‚*'
- en: âŒ `scipy.interpolate`
  id: totrans-57
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.interpolate`
- en: 'The [`scipy.interpolate`](https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate
    "(in SciPy v1.13.1)") module provides both low-level and object-oriented routines
    for interpolating in one or more dimensions. These APIs rate poorly along a number
    of the axes above: they are class-based rather than low-level, and none but the
    simplest methods can be expressed efficiently in terms of XLA operations.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.interpolate`](https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate
    "(åœ¨ SciPy v1.13.1 ä¸­)") æ¨¡å—æä¾›äº†åœ¨ä¸€ç»´æˆ–å¤šç»´ä¸­è¿›è¡Œæ’å€¼çš„ä½çº§å’Œé¢å‘å¯¹è±¡çš„ä¾‹ç¨‹ã€‚ä»å¤šä¸ªè§’åº¦è¯„ä¼°ï¼Œè¿™äº› API è¡¨ç°ä¸ä½³ï¼šå®ƒä»¬åŸºäºç±»è€Œéä½çº§ï¼Œé™¤äº†æœ€ç®€å•çš„æ–¹æ³•å¤–ï¼Œæ— æ³•æœ‰æ•ˆåœ°ç”¨
    XLA æ“ä½œè¡¨è¾¾ã€‚'
- en: JAX does currently have wrappers for [`scipy.interpolate.RegularGridInterpolator`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.RegularGridInterpolator.html#scipy.interpolate.RegularGridInterpolator
    "(in SciPy v1.13.1)"). Were we considering this contribution today, we would probably
    reject it by the above criteria. But this code has been fairly stable so there
    is not much downside to continuing to maintain it.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: JAX å½“å‰å…·æœ‰ [`scipy.interpolate.RegularGridInterpolator`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.RegularGridInterpolator.html#scipy.interpolate.RegularGridInterpolator
    "(åœ¨ SciPy v1.13.1 ä¸­)") çš„åŒ…è£…å™¨ã€‚å¦‚æœä»Šå¤©è€ƒè™‘æ­¤è´¡çŒ®ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ ¹æ®ä»¥ä¸Šæ ‡å‡†æ‹’ç»å®ƒã€‚ä½†æ­¤ä»£ç ç›¸å½“ç¨³å®šï¼Œå› æ­¤ç»§ç»­ç»´æŠ¤æ²¡æœ‰å¤ªå¤§çš„é£é™©ã€‚
- en: Going forward, we should consider other members of [`scipy.interpolate`](https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate
    "(in SciPy v1.13.1)") to be out-of-scope for JAX.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: æœªæ¥ï¼Œæˆ‘ä»¬åº”è€ƒè™‘å°† [`scipy.interpolate`](https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate
    "(åœ¨ SciPy v1.13.1 ä¸­)") çš„å…¶ä»–æˆå‘˜è§†ä¸º JAX èŒƒå›´ä¹‹å¤–ã€‚
- en: âŒ `scipy.io`
  id: totrans-61
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.io`
- en: The [`scipy.io`](https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io
    "(in SciPy v1.13.1)") submodule has to do with file input/output. There is no
    reason to re-implement this in JAX.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.io`](https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io
    "(åœ¨ SciPy v1.13.1 ä¸­)") å­æ¨¡å—æ¶‰åŠæ–‡ä»¶è¾“å…¥/è¾“å‡ºã€‚åœ¨ JAX ä¸­é‡æ–°å®ç°è¿™ä¸€åŠŸèƒ½æ²¡æœ‰å¿…è¦ã€‚'
- en: âœ… `scipy.linalg`
  id: totrans-63
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âœ… `scipy.linalg`
- en: The [`scipy.linalg`](https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg
    "(in SciPy v1.13.1)") submodule contains functions that broadly align with functionality
    provided by XLA, and fast linear algebra is broadly important to the JAX user
    community. For this reason, we deem it in-scope for JAX.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.linalg`](https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg
    "(åœ¨ SciPy v1.13.1 ä¸­)") å­æ¨¡å—åŒ…å«ä¸ XLA æä¾›çš„åŠŸèƒ½å¤§è‡´å¯¹åº”çš„å‡½æ•°ï¼Œå¿«é€Ÿçº¿æ€§ä»£æ•°å¯¹ JAX ç”¨æˆ·ç¤¾åŒºè‡³å…³é‡è¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒé€‚ç”¨äº
    JAX çš„èŒƒå›´ä¹‹å†…ã€‚'
- en: âŒ `scipy.ndimage`
  id: totrans-65
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.ndimage`
- en: The [`scipy.ndimage`](https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage
    "(in SciPy v1.13.1)") submodule contains a set of tools for working on image data.
    Many of these overlap with tools in [`scipy.signal`](https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal
    "(in SciPy v1.13.1)") (e.g. convolutions and filtering). JAX currently provides
    one [`scipy.ndimage`](https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage
    "(in SciPy v1.13.1)") API, in `jax.scipy.ndimage.map_coordinates()`. Additionally,
    JAX provides some image-related tools in the `jax.image` module. The deepmind
    ecosystem includes [dm-pix](https://github.com/google-deepmind/dm_pix), a more
    full-featured set of tools for image manipulation in JAX. Given all these factors,
    Iâ€™d suggest that [`scipy.ndimage`](https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage
    "(in SciPy v1.13.1)") should be considered out-of-scope for JAX core; we can point
    interested users and contributors to dm-pix. We can consider moving `map_coordinates`
    to `dm-pix` or to another appropriate package.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.ndimage`](https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage
    "(åœ¨ SciPy v1.13.1)") å­æ¨¡å—åŒ…å«ä¸€ç»„ç”¨äºå¤„ç†å›¾åƒæ•°æ®çš„å·¥å…·ã€‚å…¶ä¸­è®¸å¤šä¸ [`scipy.signal`](https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal
    "(åœ¨ SciPy v1.13.1)") ä¸­çš„å·¥å…·é‡å ï¼ˆä¾‹å¦‚å·ç§¯å’Œæ»¤æ³¢ï¼‰ã€‚JAX ç›®å‰åœ¨ `jax.scipy.ndimage.map_coordinates()`
    ä¸­æä¾›äº†ä¸€ä¸ª [`scipy.ndimage`](https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage
    "(åœ¨ SciPy v1.13.1)") APIã€‚æ­¤å¤–ï¼ŒJAX åœ¨ `jax.image` æ¨¡å—ä¸­æä¾›äº†ä¸€äº›ä¸å›¾åƒç›¸å…³çš„å·¥å…·ã€‚DeepMind ç”Ÿæ€ç³»ç»ŸåŒ…æ‹¬
    [dm-pix](https://github.com/google-deepmind/dm_pix)ï¼Œä¸€ä¸ªæ›´å…¨é¢çš„ç”¨äºåœ¨ JAX ä¸­è¿›è¡Œå›¾åƒå¤„ç†çš„å·¥å…·é›†ã€‚è€ƒè™‘åˆ°æ‰€æœ‰è¿™äº›å› ç´ ï¼Œæˆ‘å»ºè®®
    [`scipy.ndimage`](https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage
    "(åœ¨ SciPy v1.13.1)") åº”è¢«è§†ä¸º JAX æ ¸å¿ƒä¹‹å¤–çš„èŒƒç•´ï¼›æˆ‘ä»¬å¯ä»¥å°†æ„Ÿå…´è¶£çš„ç”¨æˆ·å’Œè´¡çŒ®è€…æŒ‡å‘ dm-pixã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°† `map_coordinates`
    ç§»è‡³ `dm-pix` æˆ–å…¶ä»–é€‚å½“çš„åŒ…ä¸­ã€‚'
- en: âŒ `scipy.odr`
  id: totrans-67
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.odr`
- en: The [`scipy.odr`](https://docs.scipy.org/doc/scipy/reference/odr.html#module-scipy.odr
    "(in SciPy v1.13.1)") module provides an object-oriented wrapper around `ODRPACK`
    for performing orthogonal distance regressions. It is not clear that this could
    be cleanly expressed using existing JAX primitives, and so we deem it out of scope
    for JAX itself.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.odr`](https://docs.scipy.org/doc/scipy/reference/odr.html#module-scipy.odr
    "(åœ¨ SciPy v1.13.1)") æ¨¡å—æä¾›äº†ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ `ODRPACK` åŒ…è£…å™¨ï¼Œç”¨äºæ‰§è¡Œæ­£äº¤è·ç¦»å›å½’ã€‚ç›®å‰å°šä¸æ¸…æ¥šæ˜¯å¦å¯ä»¥ä½¿ç”¨ç°æœ‰çš„ JAX
    åŸè¯­æ¸…æ™°åœ°è¡¨è¾¾è¿™ä¸€åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬è®¤ä¸ºå®ƒè¶…å‡ºäº† JAX æœ¬èº«çš„èŒƒç•´ã€‚'
- en: âŒ `scipy.optimize`
  id: totrans-69
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.optimize`
- en: The [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(in SciPy v1.13.1)") module provides high-level and low-level interfaces for
    optimization. Such functionality is important to a lot of JAX users, and very
    early on JAX created `jax.scipy.optimize` wrappers. However, developers of these
    routines soon realized that the [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(in SciPy v1.13.1)") API was too constraining, and different teams began working
    on the [JAXopt](https://jaxopt.github.io/) package and the [Optimistix](https://github.com/patrick-kidger/optimistix)
    package, each of which contain a much more comprehensive and better-tested set
    of optimization routines in JAX.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(åœ¨ SciPy v1.13.1)") æ¨¡å—æä¾›äº†ç”¨äºä¼˜åŒ–çš„é«˜çº§å’Œä½çº§æ¥å£ã€‚è¿™æ ·çš„åŠŸèƒ½å¯¹è®¸å¤š JAX ç”¨æˆ·éå¸¸é‡è¦ï¼Œåœ¨ JAX åˆ›å»º `jax.scipy.optimize`
    åŒ…è£…å™¨æ—¶éå¸¸æ—©å°±å¼€å§‹ã€‚ç„¶è€Œï¼Œè¿™äº›ç¨‹åºçš„å¼€å‘äººå‘˜å¾ˆå¿«æ„è¯†åˆ° [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(åœ¨ SciPy v1.13.1)") API è¿‡äºçº¦æŸï¼Œå¹¶ä¸”ä¸åŒçš„å›¢é˜Ÿå¼€å§‹å¼€å‘ [JAXopt](https://jaxopt.github.io/)
    åŒ…å’Œ [Optimistix](https://github.com/patrick-kidger/optimistix) åŒ…ï¼Œæ¯ä¸ªåŒ…éƒ½åŒ…å«äº†åœ¨ JAX ä¸­æ›´å…¨é¢å’Œç»è¿‡æ›´å¥½æµ‹è¯•çš„ä¼˜åŒ–ç¨‹åºé›†ã€‚'
- en: Because of these well-supported external packages, we now consider [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(in SciPy v1.13.1)") to be out-of-scope for JAX.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºè¿™äº›å—åˆ°è‰¯å¥½æ”¯æŒçš„å¤–éƒ¨åŒ…ï¼Œæˆ‘ä»¬ç°åœ¨è®¤ä¸º [`scipy.optimize`](https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize
    "(åœ¨ SciPy v1.13.1)") è¶…å‡ºäº† JAX çš„èŒƒå›´ã€‚
- en: '*Recommendation: deprecate `jax.scipy.optimize` and/or make it a lightweight
    wrapper around an optional JAXopt or Optimistix dependency.*'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šå¼ƒç”¨ `jax.scipy.optimize` æˆ–ä½¿å…¶æˆä¸ºä¸€ä¸ªè½»é‡çº§çš„åŒ…è£…å™¨ï¼Œå‘¨å›´åŒ…è£…ä¸€ä¸ªå¯é€‰çš„ JAXopt æˆ– Optimistix ä¾èµ–ã€‚*'
- en: ğŸŸ¡ `scipy.signal`
  id: totrans-73
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: ğŸŸ¡ `scipy.signal`
- en: 'The [`scipy.signal`](https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal
    "(in SciPy v1.13.1)") module is mixed: some functions are squarely in-scope for
    JAX (e.g. `correlate` and `convolve`, which are more user-friendly wrappers of
    `lax.conv_general_dilated`), while many others are squarely out-of-scope (domain-specific
    tools with no viable lowering path to XLA). Potential contributions to `jax.scipy.signal`
    will have to be weighed on a case-by-case basis.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.signal`](https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal
    "(åœ¨SciPy v1.13.1ä¸­)") æ¨¡å—åˆ™æœ‰æ‰€ä¸åŒï¼šä¸€äº›å‡½æ•°å®Œå…¨é€‚ç”¨äºJAXï¼ˆä¾‹å¦‚`correlate`å’Œ`convolve`ï¼Œè¿™äº›å‡½æ•°æ˜¯`lax.conv_general_dilated`çš„æ›´å‹å¥½çš„åŒ…è£…ï¼‰ï¼Œè€Œå…¶ä»–è®¸å¤šå‡½æ•°åˆ™å®Œå…¨ä¸é€‚ç”¨äºJAXï¼ˆä¸“é—¨é¢†åŸŸçš„å·¥å…·æ²¡æœ‰åˆé€‚çš„é™ä½è·¯å¾„åˆ°XLAï¼‰ã€‚å¯¹äº`jax.scipy.signal`çš„æ½œåœ¨è´¡çŒ®å°†éœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚'
- en: ğŸŸ¡ `scipy.sparse`
  id: totrans-75
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: ğŸŸ¡ `scipy.sparse`
- en: The [`scipy.sparse`](https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse
    "(in SciPy v1.13.1)") submodule mainly contains data structures for storing and
    operating on sparse matrices and arrays in a variety of formats. Additionally,
    [`scipy.sparse.linalg`](https://docs.scipy.org/doc/scipy/reference/sparse.linalg.html#module-scipy.sparse.linalg
    "(in SciPy v1.13.1)") contains a number of matrix-free solvers, suitable for use
    with sparse matrices, dense matrices, and linear operators.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.sparse`](https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse
    "(åœ¨SciPy v1.13.1ä¸­)") å­æ¨¡å—ä¸»è¦åŒ…å«äº†å¤šç§æ ¼å¼çš„ç¨€ç–çŸ©é˜µå’Œæ•°ç»„çš„å­˜å‚¨å’Œæ“ä½œæ•°æ®ç»“æ„ã€‚æ­¤å¤–ï¼Œ[`scipy.sparse.linalg`](https://docs.scipy.org/doc/scipy/reference/sparse.linalg.html#module-scipy.sparse.linalg
    "(åœ¨SciPy v1.13.1ä¸­)") è¿˜åŒ…å«äº†è®¸å¤šæ— çŸ©é˜µçš„æ±‚è§£å™¨ï¼Œé€‚ç”¨äºç¨€ç–çŸ©é˜µã€ç¨ å¯†çŸ©é˜µå’Œçº¿æ€§ç®—å­ã€‚'
- en: The [`scipy.sparse`](https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse
    "(in SciPy v1.13.1)") array and matrix data structures are out-of-scope for JAX,
    because they do not align with JAXâ€™s computational model (e.g. many operations
    depend on dynamically-sized buffers). JAX has developed the `jax.experimental.sparse`
    module as an alternative set of data structures that are more in-line with JAXâ€™s
    computational constraints. For these reasons, we consider the data structures
    in [`scipy.sparse`](https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse
    "(in SciPy v1.13.1)") to be out-of-scope for JAX.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.sparse`](https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse
    "(åœ¨SciPy v1.13.1ä¸­)") çš„æ•°ç»„å’ŒçŸ©é˜µæ•°æ®ç»“æ„ä¹Ÿè¶…å‡ºäº†JAXçš„èŒƒå›´ï¼Œå› ä¸ºå®ƒä»¬ä¸JAXçš„è®¡ç®—æ¨¡å‹ä¸ç¬¦ï¼ˆä¾‹å¦‚ï¼Œè®¸å¤šæ“ä½œä¾èµ–äºåŠ¨æ€å¤§å°çš„ç¼“å†²åŒºï¼‰ã€‚JAXå·²ç»å¼€å‘äº†`jax.experimental.sparse`æ¨¡å—ä½œä¸ºä¸€ç»„æ›´ç¬¦åˆJAXè®¡ç®—çº¦æŸçš„æ›¿ä»£æ•°æ®ç»“æ„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸º[`scipy.sparse`](https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse
    "(åœ¨SciPy v1.13.1ä¸­)") ä¸­çš„æ•°æ®ç»“æ„è¶…å‡ºäº†JAXçš„èŒƒå›´ã€‚'
- en: On the other hand, [`scipy.sparse.linalg`](https://docs.scipy.org/doc/scipy/reference/sparse.linalg.html#module-scipy.sparse.linalg
    "(in SciPy v1.13.1)") has proven to be an interesting area, and `jax.scipy.sparse.linalg`
    includes the `bicgstab`, `cg`, and `gmres` solvers. These are useful to the JAX
    user community (Axis 6) but aside from this do not fare well along other axes.
    They would be very suitable for moving into a downstream library; one potential
    option may be [Lineax](https://github.com/google/lineax), which features a number
    of linear solvers built on JAX.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€æ–¹é¢ï¼Œ[`scipy.sparse.linalg`](https://docs.scipy.org/doc/scipy/reference/sparse.linalg.html#module-scipy.sparse.linalg
    "(åœ¨SciPy v1.13.1ä¸­)") å·²ç»è¢«è¯æ˜æ˜¯ä¸€ä¸ªæœ‰è¶£çš„é¢†åŸŸï¼Œ`jax.scipy.sparse.linalg`åŒ…æ‹¬äº†`bicgstab`ã€`cg`å’Œ`gmres`æ±‚è§£å™¨ã€‚è¿™äº›å¯¹äºJAXç”¨æˆ·ç¤¾åŒºï¼ˆè½´6ï¼‰éå¸¸æœ‰ç”¨ï¼Œä½†åœ¨å…¶ä»–è½´ä¸Šå¹¶ä¸é€‚ç”¨ã€‚å®ƒä»¬éå¸¸é€‚åˆç§»å…¥ä¸€ä¸ªä¸‹æ¸¸åº“ï¼›ä¸€ä¸ªæ½œåœ¨çš„é€‰æ‹©å¯èƒ½æ˜¯[Lineax](https://github.com/google/lineax)ï¼Œå®ƒåŒ…æ‹¬äº†å¤šä¸ªåŸºäºJAXæ„å»ºçš„çº¿æ€§æ±‚è§£å™¨ã€‚
- en: '*Recommendation: explore moving sparse solvers into Lineax, and otherwise treat
    `scipy.sparse`` as out-of-scope for JAX.*'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šè€ƒè™‘å°†ç¨€ç–æ±‚è§£å™¨ç§»å…¥Lineaxï¼Œå¹¶ä¸”å°†`scipy.sparse`è§†ä¸ºJAXèŒƒå›´å¤–çš„å†…å®¹ã€‚*'
- en: âŒ `scipy.spatial`
  id: totrans-80
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âŒ `scipy.spatial`
- en: The [`scipy.spatial`](https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial
    "(in SciPy v1.13.1)") module contains mainly object-oriented interfaces to spatial/distance
    computations and nearest neighbor searches. It is mostly out-of-scope for JAX
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.spatial`](https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial
    "(åœ¨SciPy v1.13.1ä¸­)") æ¨¡å—ä¸»è¦åŒ…å«é¢å‘å¯¹è±¡çš„ç©ºé—´/è·ç¦»è®¡ç®—å’Œæœ€è¿‘é‚»æœç´¢æ¥å£ã€‚è¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¶…å‡ºäº†JAXçš„èŒƒå›´ã€‚'
- en: The [`scipy.spatial.transform`](https://docs.scipy.org/doc/scipy/reference/spatial.transform.html#module-scipy.spatial.transform
    "(in SciPy v1.13.1)") submodule provides tools for manipulating three-dimensional
    spatial rotations. It is a relatively complicated object-oriented interface, and
    could perhaps be better served by a downstream project. JAX currently contains
    partial implementations of `Rotation` and `Slerp` within `jax.scipy.spatial.transform`;
    these are object-oriented wrappers of otherwise basic functions, which introduce
    a very large API surface and have very few users. It is our judgment that they
    are out-of-scope for JAX itself, with users better-served by a hypothetical downstream
    project.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.spatial.transform`](https://docs.scipy.org/doc/scipy/reference/spatial.transform.html#module-scipy.spatial.transform
    "(åœ¨SciPy v1.13.1ä¸­)") å­æ¨¡å—æä¾›äº†ç”¨äºæ“ä½œä¸‰ç»´ç©ºé—´æ—‹è½¬çš„å·¥å…·ã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹å¤æ‚çš„é¢å‘å¯¹è±¡æ¥å£ï¼Œä¹Ÿè®¸æœ€å¥½ç”±ä¸‹æ¸¸é¡¹ç›®æ›´å¥½åœ°æœåŠ¡ã€‚JAXç›®å‰åœ¨`jax.scipy.spatial.transform`ä¸­éƒ¨åˆ†å®ç°äº†`Rotation`å’Œ`Slerp`ï¼›è¿™äº›æ˜¯å¯¹åŸºæœ¬å‡½æ•°çš„é¢å‘å¯¹è±¡åŒ…è£…å™¨ï¼Œå¼•å…¥äº†éå¸¸åºå¤§çš„APIè¡¨é¢ï¼Œä¸”ä½¿ç”¨è€…éå¸¸å°‘ã€‚æˆ‘ä»¬è®¤ä¸ºå®ƒä»¬è¶…å‡ºäº†JAXæœ¬èº«çš„èŒƒå›´ï¼Œç”¨æˆ·æœ€å¥½ç”±ä¸€ä¸ªå‡è®¾çš„ä¸‹æ¸¸é¡¹ç›®æ›´å¥½åœ°æœåŠ¡ã€‚'
- en: The [`scipy.spatial.distance`](https://docs.scipy.org/doc/scipy/reference/spatial.distance.html#module-scipy.spatial.distance
    "(in SciPy v1.13.1)") submodule contains a useful collection of distance metrics,
    and it might be tempting to provide JAX wrappers for these. That said, with jit
    and vmap it would be straightforward for a user to define efficient versions of
    most of these from scratch if needed, so adding them to JAX is not particularly
    beneficial.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.spatial.distance`](https://docs.scipy.org/doc/scipy/reference/spatial.distance.html#module-scipy.spatial.distance
    "(åœ¨SciPy v1.13.1ä¸­)") å­æ¨¡å—åŒ…å«ä¸€ç»„æœ‰ç”¨çš„è·ç¦»åº¦é‡æ ‡å‡†ï¼Œå¯èƒ½ä¼šè¯±äººåœ°ä¸ºè¿™äº›æä¾›JAXåŒ…è£…å™¨ã€‚å°½ç®¡å¦‚æ­¤ï¼Œé€šè¿‡`jit`å’Œ`vmap`ï¼Œç”¨æˆ·å¯ä»¥å¾ˆå®¹æ˜“åœ°æ ¹æ®éœ€è¦ä»å¤´å¼€å§‹å®šä¹‰å¤§å¤šæ•°è¿™äº›çš„é«˜æ•ˆç‰ˆæœ¬ï¼Œå› æ­¤å°†å®ƒä»¬æ·»åŠ åˆ°JAXä¸­å¹¶ä¸ç‰¹åˆ«æœ‰ç›Šã€‚'
- en: '*Recommendation: consider deprecating and removing the `Rotation` and `Slerp`
    APIs, and consider [`scipy.spatial`](https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial
    "(in SciPy v1.13.1)") as a whole out-of-scope for future contributions.*'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šè€ƒè™‘åºŸå¼ƒå’Œç§»é™¤`Rotation`å’Œ`Slerp` APIï¼Œå¹¶è€ƒè™‘å°†[`scipy.spatial`](https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial
    "(åœ¨SciPy v1.13.1ä¸­)")æ•´ä½“è§†ä¸ºä¸é€‚åˆæœªæ¥è´¡çŒ®ã€‚*'
- en: âœ… `scipy.special`
  id: totrans-85
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âœ… `scipy.special`
- en: 'The [`scipy.special`](https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special
    "(in SciPy v1.13.1)") module includes implementations of a number of more specialized
    functions. In many cases, these functions are squarely in scope: for example,
    functions like `gammaln`, `betainc`, `digamma`, and many others correspond directly
    to available XLA primitives, and are clearly in-scope by Axis 1 and others.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.special`](https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special
    "(åœ¨SciPy v1.13.1ä¸­)") æ¨¡å—åŒ…æ‹¬ä¸€äº›æ›´ä¸“ä¸šå‡½æ•°çš„å®ç°ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™äº›å‡½æ•°å®Œå…¨åœ¨èŒƒå›´å†…ï¼šä¾‹å¦‚ï¼Œåƒ`gammaln`ã€`betainc`ã€`digamma`å’Œè®¸å¤šå…¶ä»–å‡½æ•°ç›´æ¥å¯¹åº”äºå¯ç”¨çš„XLAåŸºå…ƒï¼Œå¹¶ä¸”æ˜æ˜¾åœ¨è½´1å’Œå…¶ä»–è½´ä¸Šåœ¨èŒƒå›´å†…ã€‚'
- en: 'Other functions require more complicated implementations; one example mentioned
    above is `bessel_jn`. Despite not aligning on Axes 1 and 2, these functions tend
    to be very strong along Axis 6: [`scipy.special`](https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special
    "(in SciPy v1.13.1)") provides fundamental functions necessary for computation
    in a variety of domains, so even functions with complicated implementations should
    lean toward in-scope, so long as the implementations are well-designed and robust.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä»–å‡½æ•°éœ€è¦æ›´å¤æ‚çš„å®ç°ï¼›ä¸€ä¸ªä¸Šé¢æåˆ°çš„ä¾‹å­æ˜¯`bessel_jn`ã€‚å°½ç®¡åœ¨è½´1å’Œ2ä¸Šä¸å¯¹é½ï¼Œä½†è¿™äº›å‡½æ•°å¾€å¾€åœ¨è½´6ä¸Šéå¸¸å¼ºå¤§ï¼š[`scipy.special`](https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special
    "(åœ¨SciPy v1.13.1ä¸­)") æä¾›äº†åœ¨å¤šä¸ªé¢†åŸŸä¸­è¿›è¡Œè®¡ç®—æ‰€éœ€çš„åŸºæœ¬å‡½æ•°ï¼Œå› æ­¤å³ä½¿æ˜¯å…·æœ‰å¤æ‚å®ç°çš„å‡½æ•°ï¼Œåªè¦å®ç°è‰¯å¥½ä¸”å¥å£®ï¼Œä¹Ÿåº”å€¾å‘äºåœ¨èŒƒå›´å†…ã€‚
- en: 'There are a few existing function wrappers that we should take a closer look
    at; for example:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰ä¸€äº›ç°æœ‰çš„å‡½æ•°åŒ…è£…å™¨å€¼å¾—æˆ‘ä»¬æ›´ä»”ç»†åœ°çœ‹ä¸€çœ‹ï¼›ä¾‹å¦‚ï¼š
- en: '`jax.scipy.special.lpmn()`: this generates legendre polynomials via a complicated
    fori_loop, in a way that does not match the scipy API (e.g. for `scipy`, `z` must
    be a scalar, while for JAX, `z` must be a 1D array). The function has few discoverable
    uses making it a weak candidate along Axes 1, 2, 4, and 6.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`jax.scipy.special.lpmn()`: è¿™ä¸ªå‡½æ•°é€šè¿‡ä¸€ä¸ªå¤æ‚çš„`fori_loop`ç”ŸæˆLegendreå¤šé¡¹å¼ï¼Œå…¶æ–¹å¼ä¸scipyçš„APIä¸åŒ¹é…ï¼ˆä¾‹å¦‚ï¼Œå¯¹äº`scipy`ï¼Œ`z`å¿…é¡»æ˜¯æ ‡é‡ï¼Œè€Œå¯¹äºJAXï¼Œåˆ™`z`å¿…é¡»æ˜¯1Dæ•°ç»„ï¼‰ã€‚è¯¥å‡½æ•°æœ‰å°‘æ•°å‘ç°çš„ç”¨é€”ï¼Œä½¿å…¶æˆä¸ºAxes
    1ã€2ã€4å’Œ6ä¸Šçš„ä¸€ä¸ªè–„å¼±å€™é€‰è€…ã€‚'
- en: '`jax.scipy.special.lpmn_values()`: this has similar weaknesses to `lmpn` above.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`jax.scipy.special.lpmn_values()`: è¿™ä¸ä¸Šè¿°çš„`lmpn`æœ‰ç±»ä¼¼çš„å¼±ç‚¹ã€‚'
- en: '`jax.scipy.special.sph_harm()`: this is built on lpmn, and similarly has an
    API that diverges from the corresponding `scipy` function.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`jax.scipy.special.sph_harm()`ï¼šæ­¤å‡½æ•°åŸºäºlpmnæ„å»ºï¼Œå…¶APIä¸å¯¹åº”çš„`scipy`å‡½æ•°ä¸åŒã€‚'
- en: '`jax.scipy.special.bessel_jn()`: as discussed under Axis 4 above, this has
    weaknesses in terms of robustness of implementation and little usage. We might
    consider replacing it with a new, more robust implementation (e.g. [#17038](https://github.com/google/jax/issues/17038)).'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`jax.scipy.special.bessel_jn()`ï¼šå¦‚ä¸Šè¿°ç¬¬4è½´ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œè¿™åœ¨å®ç°çš„å¥å£®æ€§æ–¹é¢å­˜åœ¨å¼±ç‚¹ï¼Œä½¿ç”¨è¾ƒå°‘ã€‚æˆ‘ä»¬å¯èƒ½ä¼šè€ƒè™‘ç”¨ä¸€ä¸ªæ–°çš„ã€æ›´å¥å£®çš„å®ç°æ›¿æ¢å®ƒï¼ˆä¾‹å¦‚
    [#17038](https://github.com/google/jax/issues/17038)ï¼‰ã€‚'
- en: '*Recommendation: refactor and improve robustness & test coverage for `bessel_jn`.
    Consider deprecating `lpmn`, `lpmn_values`, and `sph_harm` if they cannot be modified
    to more closely match the `scipy` APIs.*'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šé‡æ„å¹¶æé«˜`bessel_jn`çš„å¥å£®æ€§å’Œæµ‹è¯•è¦†ç›–ç‡ã€‚å¦‚æœæ— æ³•ä¿®æ”¹ä»¥æ›´æ¥è¿‘`scipy`çš„APIï¼Œåˆ™è€ƒè™‘åºŸå¼ƒ`lpmn`ã€`lpmn_values`å’Œ`sph_harm`ã€‚*'
- en: âœ… `scipy.stats`
  id: totrans-94
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: âœ… `scipy.stats`
- en: 'The [`scipy.stats`](https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats
    "(in SciPy v1.13.1)") module contains a wide range of statistical functions, including
    discrete and continuous distributions, summary statistics, and hypothesis testing.
    JAX currently wraps a number of these in `jax.scipy.stats`, primarily including
    20 or so statistical distributions, along with a few other functions (`mode`,
    `rankdata`, `gaussian_kde`). In general these are well-aligned with JAX: distributions
    usually are expressible in terms of efficient XLA operations, and the APIs are
    clean and functional.'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '[`scipy.stats`](https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats
    "(åœ¨SciPy v1.13.1ä¸­)") æ¨¡å—åŒ…å«å¹¿æ³›çš„ç»Ÿè®¡å‡½æ•°ï¼ŒåŒ…æ‹¬ç¦»æ•£å’Œè¿ç»­åˆ†å¸ƒã€æ±‡æ€»ç»Ÿè®¡ä»¥åŠå‡è®¾æ£€éªŒã€‚JAXç›®å‰åœ¨`jax.scipy.stats`ä¸­åŒ…è£…äº†å…¶ä¸­ä¸€äº›ï¼Œä¸»è¦åŒ…æ‹¬å¤§çº¦20ç§ç»Ÿè®¡åˆ†å¸ƒä»¥åŠä¸€äº›å…¶ä»–å‡½æ•°ï¼ˆå¦‚`mode`ã€`rankdata`ã€`gaussian_kde`ï¼‰ã€‚æ€»ä½“æ¥è¯´ï¼Œè¿™äº›ä¸JAXå¾ˆå¥½åœ°å¯¹é½ï¼šåˆ†å¸ƒé€šå¸¸å¯ä»¥ç”¨é«˜æ•ˆçš„XLAæ“ä½œè¡¨è¾¾ï¼ŒAPIæ¸…æ™°ä¸”åŠŸèƒ½é½å…¨ã€‚'
- en: We donâ€™t currently have any wrappers for hypothesis testing functions, probably
    because these are less useful to the primary user-base of JAX.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰æˆ‘ä»¬æ²¡æœ‰ä»»ä½•å‡è®¾æ£€éªŒå‡½æ•°çš„åŒ…è£…å™¨ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºè¿™äº›å¯¹äºJAXçš„ä¸»è¦ç”¨æˆ·ç¾¤ä½“ä¸å¤ªæœ‰ç”¨ã€‚
- en: Regarding distributions, in some cases, `tensorflow_probability` provides similar
    functionality, and in the future we might consider whether to deprecate the scipy.stats
    distributions in favor of that implementation.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: å…³äºåˆ†å¸ƒï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ`tensorflow_probability`æä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼Œæœªæ¥æˆ‘ä»¬å¯èƒ½ä¼šè€ƒè™‘æ˜¯å¦åº”è¯¥åºŸå¼ƒscipy.statsä¸­çš„åˆ†å¸ƒä»¥æ”¯æŒè¿™ç§å®ç°ã€‚
- en: '*Recommendation: going forward, we should treat statistical distributions and
    summary statistics as in-scope, and consider hypothesis tests and related functionality
    generally out-of-scope.*'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '*å»ºè®®ï¼šæœªæ¥ï¼Œæˆ‘ä»¬åº”å°†ç»Ÿè®¡åˆ†å¸ƒå’Œæ±‡æ€»ç»Ÿè®¡è§†ä¸ºèŒƒå›´å†…çš„å†…å®¹ï¼Œå¹¶è€ƒè™‘å‡è®¾æ£€éªŒåŠå…¶ç›¸å…³åŠŸèƒ½é€šå¸¸ä¸åœ¨èŒƒå›´å†…ã€‚*'
