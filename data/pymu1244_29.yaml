- en: Document
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 文档
- en: 原文：[https://pymupdf.readthedocs.io/en/latest/document.html](https://pymupdf.readthedocs.io/en/latest/document.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://pymupdf.readthedocs.io/en/latest/document.html](https://pymupdf.readthedocs.io/en/latest/document.html)
- en: This class represents a document. It can be constructed from a file or from
    memory.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 此类表示一个文档。它可以从文件或内存构建。
- en: There exists the alias *open* for this class, i.e. `pymupdf.Document(...)` and
    `pymupdf.open(...)` do exactly the same thing.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 此类还存在别名*open*，即`pymupdf.Document(...)`和`pymupdf.open(...)`完全相同。
- en: For details on **embedded files** refer to Appendix 3.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 有关嵌入文件的详细信息，请参阅附录3。
- en: Note
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Starting with v1.17.0, a new page addressing mechanism for **EPUB files only**
    is supported. This document type is internally organized in chapters such that
    pages can most efficiently be found by their so-called “location”. The location
    is a tuple *(chapter, pno)* consisting of the chapter number and the page number
    **in that chapter**. Both numbers are zero-based.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 从v1.17.0开始，仅支持**EPUB文件**的新页面寻址机制。此文档类型在内部组织为章节，因此可以通过其所谓的“位置”最有效地找到页面。位置是一个由章节号和该章节中的页号**组成的元组***(chapter,
    pno)*，两个数字都是从零开始计数的。
- en: While it is still possible to locate a page via its (absolute) number, doing
    so may mean that the complete EPUB document must be laid out before the page can
    be addressed. This may have a significant performance impact if the document is
    very large. Using the page’s *(chapter, pno)* prevents this from happening.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管仍然可以通过（绝对）页码定位页面，但这样做可能意味着必须在地址页面之前对完整的EPUB文档进行布局。如果文档非常庞大，这可能会对性能产生显著影响。使用页面的*(章节，页号)*可以避免这种情况发生。
- en: To maintain a consistent API, PyMuPDF supports the page *location* syntax for
    **all file types** – documents without this feature simply have just one chapter.
    [`Document.load_page()`](#Document.load_page "Document.load_page") and the equivalent
    index access now also support a *location* argument.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保持一致的API，PyMuPDF支持所有文件类型的页面*位置*语法 - 没有此功能的文档只有一个章节。[`Document.load_page()`](#Document.load_page
    "Document.load_page")和等效的索引访问现在也支持*位置*参数。
- en: There are a number of methods for converting between page numbers and locations,
    for determining the chapter count, the page count per chapter, for computing the
    next and the previous locations, and the last page location of a document.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种方法可以在页面号和位置之间进行转换，确定章节数，每章的页数，计算下一个和前一个位置，以及文档的最后一页位置。
- en: '| **Method / Attribute** | **Short Description** |'
  id: totrans-10
  prefs: []
  type: TYPE_TB
  zh: '| **方法/属性** | **简短描述** |'
- en: '| --- | --- |'
  id: totrans-11
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| [`Document.add_layer()`](#Document.add_layer "Document.add_layer") | PDF
    only: make new optional content configuration |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.add_layer()`](#Document.add_layer "Document.add_layer") | 仅限PDF：创建新的可选内容配置
    |'
- en: '| [`Document.add_ocg()`](#Document.add_ocg "Document.add_ocg") | PDF only:
    add new optional content group |'
  id: totrans-13
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.add_ocg()`](#Document.add_ocg "Document.add_ocg") | 仅限PDF：添加新的可选内容组
    |'
- en: '| [`Document.authenticate()`](#Document.authenticate "Document.authenticate")
    | gain access to an encrypted document |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.authenticate()`](#Document.authenticate "Document.authenticate")
    | 访问加密文档 |'
- en: '| [`Document.bake()`](#Document.bake "Document.bake") | PDF only: make annotations
    / fields permanent content |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.bake()`](#Document.bake "Document.bake") | 仅限PDF：使注释/字段内容永久化 |'
- en: '| [`Document.can_save_incrementally()`](#Document.can_save_incrementally "Document.can_save_incrementally")
    | check if incremental save is possible |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.can_save_incrementally()`](#Document.can_save_incrementally "Document.can_save_incrementally")
    | 检查是否可以增量保存 |'
- en: '| [`Document.chapter_page_count()`](#Document.chapter_page_count "Document.chapter_page_count")
    | number of pages in chapter |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.chapter_page_count()`](#Document.chapter_page_count "Document.chapter_page_count")
    | 章节中的页数 |'
- en: '| [`Document.close()`](#Document.close "Document.close") | close the document
    |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.close()`](#Document.close "Document.close") | 关闭文档 |'
- en: '| [`Document.convert_to_pdf()`](#Document.convert_to_pdf "Document.convert_to_pdf")
    | write a PDF version to memory |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.convert_to_pdf()`](#Document.convert_to_pdf "Document.convert_to_pdf")
    | 将版本写入内存中的PDF文件 |'
- en: '| [`Document.copy_page()`](#Document.copy_page "Document.copy_page") | PDF
    only: copy a page reference |'
  id: totrans-20
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.copy_page()`](#Document.copy_page "Document.copy_page") | 仅限PDF：复制页面引用
    |'
- en: '| [`Document.del_toc_item()`](#Document.del_toc_item "Document.del_toc_item")
    | PDF only: remove a single TOC item |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.del_toc_item()`](#Document.del_toc_item "Document.del_toc_item")
    | 仅限PDF：删除单个TOC项目 |'
- en: '| [`Document.delete_page()`](#Document.delete_page "Document.delete_page")
    | PDF only: delete a page |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.delete_page()`](#Document.delete_page "Document.delete_page")
    | 仅限PDF：删除页面 |'
- en: '| [`Document.delete_pages()`](#Document.delete_pages "Document.delete_pages")
    | PDF only: delete multiple pages |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.delete_pages()`](#Document.delete_pages "Document.delete_pages")
    | PDF only: 删除多个页面 |'
- en: '| [`Document.embfile_add()`](#Document.embfile_add "Document.embfile_add")
    | PDF only: add a new embedded file from buffer |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_add()`](#Document.embfile_add "Document.embfile_add")
    | PDF only: 添加新的嵌入文件 |'
- en: '| [`Document.embfile_count()`](#Document.embfile_count "Document.embfile_count")
    | PDF only: number of embedded files |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_count()`](#Document.embfile_count "Document.embfile_count")
    | PDF only: 嵌入文件数量 |'
- en: '| [`Document.embfile_del()`](#Document.embfile_del "Document.embfile_del")
    | PDF only: delete an embedded file entry |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_del()`](#Document.embfile_del "Document.embfile_del")
    | PDF only: 删除嵌入文件条目 |'
- en: '| [`Document.embfile_get()`](#Document.embfile_get "Document.embfile_get")
    | PDF only: extract an embedded file buffer |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_get()`](#Document.embfile_get "Document.embfile_get")
    | PDF only: 提取嵌入文件缓冲区 |'
- en: '| [`Document.embfile_info()`](#Document.embfile_info "Document.embfile_info")
    | PDF only: metadata of an embedded file |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_info()`](#Document.embfile_info "Document.embfile_info")
    | PDF only: 嵌入文件元数据 |'
- en: '| [`Document.embfile_names()`](#Document.embfile_names "Document.embfile_names")
    | PDF only: list of embedded files |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_names()`](#Document.embfile_names "Document.embfile_names")
    | PDF only: 嵌入文件列表 |'
- en: '| [`Document.embfile_upd()`](#Document.embfile_upd "Document.embfile_upd")
    | PDF only: change an embedded file |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.embfile_upd()`](#Document.embfile_upd "Document.embfile_upd")
    | PDF only: 更改嵌入文件 |'
- en: '| [`Document.extract_font()`](#Document.extract_font "Document.extract_font")
    | PDF only: extract a font by [`xref`](glossary.html#xref "xref") |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.extract_font()`](#Document.extract_font "Document.extract_font")
    | PDF only: 提取字体（通过 [`xref`](glossary.html#xref "xref")） |'
- en: '| [`Document.extract_image()`](#Document.extract_image "Document.extract_image")
    | PDF only: extract an embedded image by [`xref`](glossary.html#xref "xref") |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.extract_image()`](#Document.extract_image "Document.extract_image")
    | PDF only: 提取嵌入图像（通过 [`xref`](glossary.html#xref "xref")） |'
- en: '| [`Document.ez_save()`](#Document.ez_save "Document.ez_save") | PDF only:
    [`Document.save()`](#Document.save "Document.save") with different defaults |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.ez_save()`](#Document.ez_save "Document.ez_save") | PDF only:
    以不同默认设置保存 |'
- en: '| [`Document.find_bookmark()`](#Document.find_bookmark "Document.find_bookmark")
    | retrieve page location after laid out document |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.find_bookmark()`](#Document.find_bookmark "Document.find_bookmark")
    | 排版后文档中书签位置的检索 |'
- en: '| [`Document.fullcopy_page()`](#Document.fullcopy_page "Document.fullcopy_page")
    | PDF only: duplicate a page |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.fullcopy_page()`](#Document.fullcopy_page "Document.fullcopy_page")
    | PDF only: 复制页面 |'
- en: '| [`Document.get_layer()`](#Document.get_layer "Document.get_layer") | PDF
    only: lists of OCGs in ON, OFF, RBGroups |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_layer()`](#Document.get_layer "Document.get_layer") | PDF
    only: ON、OFF、RBGroups 中 OCGs 列表 |'
- en: '| [`Document.get_layers()`](#Document.get_layers "Document.get_layers") | PDF
    only: list of optional content configurations |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_layers()`](#Document.get_layers "Document.get_layers") | PDF
    only: 可选内容配置列表 |'
- en: '| [`Document.get_oc()`](#Document.get_oc "Document.get_oc") | PDF only: get
    OCG /OCMD xref of image / form xobject |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_oc()`](#Document.get_oc "Document.get_oc") | PDF only: 获取图像/表单
    XObject 的 OCG /OCMD xref |'
- en: '| [`Document.get_ocgs()`](#Document.get_ocgs "Document.get_ocgs") | PDF only:
    info on all optional content groups |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_ocgs()`](#Document.get_ocgs "Document.get_ocgs") | PDF only:
    所有可选内容组的信息 |'
- en: '| [`Document.get_ocmd()`](#Document.get_ocmd "Document.get_ocmd") | PDF only:
    retrieve definition of an [`OCMD`](glossary.html#OCMD "OCMD") |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_ocmd()`](#Document.get_ocmd "Document.get_ocmd") | PDF only:
    获取 [`OCMD`](glossary.html#OCMD "OCMD") 的定义 |'
- en: '| [`Document.get_page_fonts()`](#Document.get_page_fonts "Document.get_page_fonts")
    | PDF only: list of fonts referenced by a page |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_fonts()`](#Document.get_page_fonts "Document.get_page_fonts")
    | PDF only: 页面引用的字体列表 |'
- en: '| [`Document.get_page_images()`](#Document.get_page_images "Document.get_page_images")
    | PDF only: list of images referenced by a page |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_images()`](#Document.get_page_images "Document.get_page_images")
    | PDF only: 页面引用的图像列表 |'
- en: '| [`Document.get_page_labels()`](#Document.get_page_labels "Document.get_page_labels")
    | PDF only: list of page label definitions |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_labels()`](#Document.get_page_labels "Document.get_page_labels")
    | PDF only: 页面标签定义列表 |'
- en: '| [`Document.get_page_numbers()`](#Document.get_page_numbers "Document.get_page_numbers")
    | PDF only: get page numbers having a given label |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_numbers()`](#Document.get_page_numbers "Document.get_page_numbers")
    | PDF only: 获取具有给定标签的页码 |'
- en: '| [`Document.get_page_pixmap()`](#Document.get_page_pixmap "Document.get_page_pixmap")
    | create a pixmap of a page by page number |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_pixmap()`](#Document.get_page_pixmap "Document.get_page_pixmap")
    | 按页码创建页面的位图 |'
- en: '| [`Document.get_page_text()`](#Document.get_page_text "Document.get_page_text")
    | extract the text of a page by page number |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_text()`](#Document.get_page_text "Document.get_page_text")
    | 按页码提取页面的文本 |'
- en: '| [`Document.get_page_xobjects()`](#Document.get_page_xobjects "Document.get_page_xobjects")
    | PDF only: list of XObjects referenced by a page |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_page_xobjects()`](#Document.get_page_xobjects "Document.get_page_xobjects")
    | 仅限 PDF：页面引用的 XObjects 列表 |'
- en: '| [`Document.get_sigflags()`](#Document.get_sigflags "Document.get_sigflags")
    | PDF only: determine signature state |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_sigflags()`](#Document.get_sigflags "Document.get_sigflags")
    | 仅限 PDF：确定签名状态 |'
- en: '| [`Document.get_toc()`](#Document.get_toc "Document.get_toc") | extract the
    table of contents |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_toc()`](#Document.get_toc "Document.get_toc") | 提取目录 |'
- en: '| [`Document.get_xml_metadata()`](#Document.get_xml_metadata "Document.get_xml_metadata")
    | PDF only: read the XML metadata |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.get_xml_metadata()`](#Document.get_xml_metadata "Document.get_xml_metadata")
    | 仅限 PDF：读取 XML 元数据 |'
- en: '| [`Document.has_annots()`](#Document.has_annots "Document.has_annots") | PDF
    only: check if PDF contains any annots |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.has_annots()`](#Document.has_annots "Document.has_annots") | 仅限
    PDF：检查 PDF 是否包含任何注释 |'
- en: '| [`Document.has_links()`](#Document.has_links "Document.has_links") | PDF
    only: check if PDF contains any links |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.has_links()`](#Document.has_links "Document.has_links") | 仅限 PDF：检查
    PDF 是否包含任何链接 |'
- en: '| [`Document.insert_page()`](#Document.insert_page "Document.insert_page")
    | PDF only: insert a new page |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.insert_page()`](#Document.insert_page "Document.insert_page")
    | 仅限 PDF：插入新页面 |'
- en: '| [`Document.insert_pdf()`](#Document.insert_pdf "Document.insert_pdf") | PDF
    only: insert pages from another PDF |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.insert_pdf()`](#Document.insert_pdf "Document.insert_pdf") | 仅限
    PDF：从另一个 PDF 插入页面 |'
- en: '| [`Document.insert_file()`](#Document.insert_file "Document.insert_file")
    | PDF only: insert pages from arbitrary document |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.insert_file()`](#Document.insert_file "Document.insert_file")
    | 仅限 PDF：从任意文档插入页面 |'
- en: '| [`Document.journal_can_do()`](#Document.journal_can_do "Document.journal_can_do")
    | PDF only: which journal actions are possible |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_can_do()`](#Document.journal_can_do "Document.journal_can_do")
    | 仅限 PDF：哪些日志记录操作是可能的 |'
- en: '| [`Document.journal_enable()`](#Document.journal_enable "Document.journal_enable")
    | PDF only: enables journalling for the document |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_enable()`](#Document.journal_enable "Document.journal_enable")
    | 仅限 PDF：启用文档的日志记录 |'
- en: '| [`Document.journal_load()`](#Document.journal_load "Document.journal_load")
    | PDF only: load journal from a file |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_load()`](#Document.journal_load "Document.journal_load")
    | 仅限 PDF：从文件加载日志记录 |'
- en: '| [`Document.journal_op_name()`](#Document.journal_op_name "Document.journal_op_name")
    | PDF only: return name of a journalling step |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_op_name()`](#Document.journal_op_name "Document.journal_op_name")
    | 仅限 PDF：返回日志记录步骤的名称 |'
- en: '| [`Document.journal_position()`](#Document.journal_position "Document.journal_position")
    | PDF only: return journalling status |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_position()`](#Document.journal_position "Document.journal_position")
    | 仅限 PDF：返回日志记录状态 |'
- en: '| [`Document.journal_redo()`](#Document.journal_redo "Document.journal_redo")
    | PDF only: redo current operation |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_redo()`](#Document.journal_redo "Document.journal_redo")
    | 仅限 PDF：重做当前操作 |'
- en: '| [`Document.journal_save()`](#Document.journal_save "Document.journal_save")
    | PDF only: save journal to a file |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_save()`](#Document.journal_save "Document.journal_save")
    | 仅限 PDF：将日志记录保存到文件 |'
- en: '| [`Document.journal_start_op()`](#Document.journal_start_op "Document.journal_start_op")
    | PDF only: start an “operation” giving it a name |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_start_op()`](#Document.journal_start_op "Document.journal_start_op")
    | 仅限 PDF：启动一个“操作”，并为其命名 |'
- en: '| [`Document.journal_stop_op()`](#Document.journal_stop_op "Document.journal_stop_op")
    | PDF only: end current operation |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_stop_op()`](#Document.journal_stop_op "Document.journal_stop_op")
    | 仅限 PDF：结束当前操作 |'
- en: '| [`Document.journal_undo()`](#Document.journal_undo "Document.journal_undo")
    | PDF only: undo current operation |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.journal_undo()`](#Document.journal_undo "Document.journal_undo")
    | 仅限 PDF：撤消当前操作 |'
- en: '| [`Document.layer_ui_configs()`](#Document.layer_ui_configs "Document.layer_ui_configs")
    | PDF only: list of optional content intents |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.layer_ui_configs()`](#Document.layer_ui_configs "Document.layer_ui_configs")
    | 仅限 PDF：可选内容意图列表 |'
- en: '| [`Document.layout()`](#Document.layout "Document.layout") | re-paginate the
    document (if supported) |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.layout()`](#Document.layout "Document.layout") | 重新对文档进行分页（如果支持的话）
    |'
- en: '| [`Document.load_page()`](#Document.load_page "Document.load_page") | read
    a page |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.load_page()`](#Document.load_page "Document.load_page") | 读取一页
    |'
- en: '| [`Document.make_bookmark()`](#Document.make_bookmark "Document.make_bookmark")
    | create a page pointer in reflowable documents |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.make_bookmark()`](#Document.make_bookmark "Document.make_bookmark")
    | 在可重排文档中创建页面指针 |'
- en: '| [`Document.move_page()`](#Document.move_page "Document.move_page") | PDF
    only: move a page to different location in doc |'
  id: totrans-70
  prefs: []
  type: TYPE_TB
  zh: '[`Document.move_page()`](#Document.move_page "Document.move_page") | 仅适用于PDF：将页面移动到文档中的不同位置
    |'
- en: '| [`Document.need_appearances()`](#Document.need_appearances "Document.need_appearances")
    | PDF only: get/set `/NeedAppearances` property |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '[`Document.need_appearances()`](#Document.need_appearances "Document.need_appearances")
    | 仅适用于PDF：获取/设置`/NeedAppearances`属性 |'
- en: '| [`Document.new_page()`](#Document.new_page "Document.new_page") | PDF only:
    insert a new empty page |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '[`Document.new_page()`](#Document.new_page "Document.new_page") | 仅适用于PDF：插入一个新的空白页
    |'
- en: '| [`Document.next_location()`](#Document.next_location "Document.next_location")
    | return (chapter, pno) of following page |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '[`Document.next_location()`](#Document.next_location "Document.next_location")
    | 返回下一页的章节和页码 |'
- en: '| [`Document.outline_xref()`](#Document.outline_xref "Document.outline_xref")
    | PDF only: [`xref`](glossary.html#xref "xref") a TOC item |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '[`Document.outline_xref()`](#Document.outline_xref "Document.outline_xref")
    | 仅适用于PDF：将TOC项[xref](glossary.html#xref "xref")化 |'
- en: '| [`Document.page_cropbox()`](#Document.page_cropbox "Document.page_cropbox")
    | PDF only: the unrotated page rectangle |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '[`Document.page_cropbox()`](#Document.page_cropbox "Document.page_cropbox")
    | 仅适用于PDF：未旋转的页面矩形 |'
- en: '| [`Document.page_xref()`](#Document.page_xref "Document.page_xref") | PDF
    only: [`xref`](glossary.html#xref "xref") of a page number |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '[`Document.page_xref()`](#Document.page_xref "Document.page_xref") | 仅适用于PDF：页面号[xref](glossary.html#xref
    "xref") |'
- en: '| [`Document.pages()`](#Document.pages "Document.pages") | iterator over a
    page range |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '[`Document.pages()`](#Document.pages "Document.pages") | 迭代器，遍历页面范围 |'
- en: '| [`Document.pdf_catalog()`](#Document.pdf_catalog "Document.pdf_catalog")
    | PDF only: [`xref`](glossary.html#xref "xref") of catalog (root) |'
  id: totrans-78
  prefs: []
  type: TYPE_TB
  zh: '[`Document.pdf_catalog()`](#Document.pdf_catalog "Document.pdf_catalog") |
    仅适用于PDF：目录（根）的[xref](glossary.html#xref "xref") |'
- en: '| [`Document.pdf_trailer()`](#Document.pdf_trailer "Document.pdf_trailer")
    | PDF only: trailer source |'
  id: totrans-79
  prefs: []
  type: TYPE_TB
  zh: '[`Document.pdf_trailer()`](#Document.pdf_trailer "Document.pdf_trailer") |
    仅适用于PDF：尾部源 |'
- en: '| [`Document.prev_location()`](#Document.prev_location "Document.prev_location")
    | return (chapter, pno) of preceding page |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '[`Document.prev_location()`](#Document.prev_location "Document.prev_location")
    | 返回前一页的章节和页码 |'
- en: '| [`Document.reload_page()`](#Document.reload_page "Document.reload_page")
    | PDF only: provide a new copy of a page |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '[`Document.reload_page()`](#Document.reload_page "Document.reload_page") |
    仅适用于PDF：提供页面的新副本 |'
- en: '| [`Document.resolve_names()`](#Document.resolve_names "Document.resolve_names")
    | PDF only: Convert destination names into a Python dict |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '[`Document.resolve_names()`](#Document.resolve_names "Document.resolve_names")
    | 仅适用于PDF：将目标名称转换为Python字典 |'
- en: '| [`Document.save()`](#Document.save "Document.save") | PDF only: save the
    document |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '[`Document.save()`](#Document.save "Document.save") | 仅适用于PDF：保存文档 |'
- en: '| [`Document.saveIncr()`](#Document.saveIncr "Document.saveIncr") | PDF only:
    save the document incrementally |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '[`Document.saveIncr()`](#Document.saveIncr "Document.saveIncr") | 仅适用于PDF：增量保存文档
    |'
- en: '| [`Document.scrub()`](#Document.scrub "Document.scrub") | PDF only: remove
    sensitive data |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '[`Document.scrub()`](#Document.scrub "Document.scrub") | 仅适用于PDF：删除敏感数据 |'
- en: '| [`Document.search_page_for()`](#Document.search_page_for "Document.search_page_for")
    | search for a string on a page |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '[`Document.search_page_for()`](#Document.search_page_for "Document.search_page_for")
    | 在页面上搜索字符串 |'
- en: '| [`Document.select()`](#Document.select "Document.select") | PDF only: select
    a subset of pages |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '[`Document.select()`](#Document.select "Document.select") | 仅适用于PDF：选择页面的子集
    |'
- en: '| [`Document.set_layer_ui_config()`](#Document.set_layer_ui_config "Document.set_layer_ui_config")
    | PDF only: set OCG visibility temporarily |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_layer_ui_config()`](#Document.set_layer_ui_config "Document.set_layer_ui_config")
    | 仅适用于PDF：临时设置OCG可见性 |'
- en: '| [`Document.set_layer()`](#Document.set_layer "Document.set_layer") | PDF
    only: mass changing OCG states |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_layer()`](#Document.set_layer "Document.set_layer") | 仅适用于PDF：批量更改OCG状态
    |'
- en: '| [`Document.set_markinfo()`](#Document.set_markinfo "Document.set_markinfo")
    | PDF only: set the MarkInfo values |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_markinfo()`](#Document.set_markinfo "Document.set_markinfo")
    | 仅适用于PDF：设置MarkInfo值 |'
- en: '| [`Document.set_metadata()`](#Document.set_metadata "Document.set_metadata")
    | PDF only: set the metadata |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_metadata()`](#Document.set_metadata "Document.set_metadata")
    | 仅适用于PDF：设置元数据 |'
- en: '| [`Document.set_oc()`](#Document.set_oc "Document.set_oc") | PDF only: attach
    OCG/OCMD to image / form xobject |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_oc()`](#Document.set_oc "Document.set_oc") | 仅适用于PDF：将OCG/OCMD附加到图像/表单XObject
    |'
- en: '| [`Document.set_ocmd()`](#Document.set_ocmd "Document.set_ocmd") | PDF only:
    create or update an [`OCMD`](glossary.html#OCMD "OCMD") |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_ocmd()`](#Document.set_ocmd "Document.set_ocmd") | 仅适用于PDF：创建或更新[OCMD](glossary.html#OCMD
    "OCMD") |'
- en: '| [`Document.set_page_labels()`](#Document.set_page_labels "Document.set_page_labels")
    | PDF only: add/update page label definitions |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_page_labels()`](#Document.set_page_labels "Document.set_page_labels")
    | 仅适用于PDF：添加/更新页面标签定义 |'
- en: '| [`Document.set_pagemode()`](#Document.set_pagemode "Document.set_pagemode")
    | PDF only: set the PageMode |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_pagemode()`](#Document.set_pagemode "Document.set_pagemode")
    | 仅适用于PDF：设置页面模式 |'
- en: '| [`Document.set_pagelayout()`](#Document.set_pagelayout "Document.set_pagelayout")
    | PDF only: set the PageLayout |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_pagelayout()`](#Document.set_pagelayout "Document.set_pagelayout")
    | 仅适用于PDF：设置页面布局 |'
- en: '| [`Document.set_toc_item()`](#Document.set_toc_item "Document.set_toc_item")
    | PDF only: change a single TOC item |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_toc_item()`](#Document.set_toc_item "Document.set_toc_item")
    | 仅适用于PDF：更改单个TOC项 |'
- en: '| [`Document.set_toc()`](#Document.set_toc "Document.set_toc") | PDF only:
    set the table of contents (TOC) |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_toc()`](#Document.set_toc "Document.set_toc") | 仅适用于PDF：设置目录（TOC）
    |'
- en: '| [`Document.set_xml_metadata()`](#Document.set_xml_metadata "Document.set_xml_metadata")
    | PDF only: create or update document XML metadata |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '[`Document.set_xml_metadata()`](#Document.set_xml_metadata "Document.set_xml_metadata")
    | 仅适用于PDF：创建或更新文档的XML元数据 |'
- en: '| [`Document.subset_fonts()`](#Document.subset_fonts "Document.subset_fonts")
    | PDF only: create font subsets |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '[`Document.subset_fonts()`](#Document.subset_fonts "Document.subset_fonts")
    | 仅适用于PDF：创建字体子集 |'
- en: '| [`Document.switch_layer()`](#Document.switch_layer "Document.switch_layer")
    | PDF only: activate OC configuration |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '[`Document.switch_layer()`](#Document.switch_layer "Document.switch_layer")
    | 仅适用于PDF：激活OC配置 |'
- en: '| [`Document.tobytes()`](#Document.tobytes "Document.tobytes") | PDF only:
    writes document to memory |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '[`Document.tobytes()`](#Document.tobytes "Document.tobytes") | 仅适用于PDF：将文档写入内存
    |'
- en: '| [`Document.xref_copy()`](#Document.xref_copy "Document.xref_copy") | PDF
    only: copy a PDF dictionary to another [`xref`](glossary.html#xref "xref") |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_copy()`](#Document.xref_copy "Document.xref_copy") | 仅适用于PDF：将PDF字典复制到另一个[`xref`](glossary.html#xref
    "xref") |'
- en: '| [`Document.xref_get_key()`](#Document.xref_get_key "Document.xref_get_key")
    | PDF only: get the value of a dictionary key |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_get_key()`](#Document.xref_get_key "Document.xref_get_key")
    | 仅适用于PDF：获取字典键的值 |'
- en: '| [`Document.xref_get_keys()`](#Document.xref_get_keys "Document.xref_get_keys")
    | PDF only: list the keys of object at [`xref`](glossary.html#xref "xref") |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_get_keys()`](#Document.xref_get_keys "Document.xref_get_keys")
    | 仅适用于PDF：列出[`xref`](glossary.html#xref "xref")对象的键 |'
- en: '| [`Document.xref_object()`](#Document.xref_object "Document.xref_object")
    | PDF only: get the definition source of [`xref`](glossary.html#xref "xref") |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_object()`](#Document.xref_object "Document.xref_object") |
    仅适用于PDF：获取[`xref`](glossary.html#xref "xref")的定义源 |'
- en: '| [`Document.xref_set_key()`](#Document.xref_set_key "Document.xref_set_key")
    | PDF only: set the value of a dictionary key |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_set_key()`](#Document.xref_set_key "Document.xref_set_key")
    | 仅适用于PDF：设置字典键的值 |'
- en: '| [`Document.xref_stream_raw()`](#Document.xref_stream_raw "Document.xref_stream_raw")
    | PDF only: raw stream source at [`xref`](glossary.html#xref "xref") |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_stream_raw()`](#Document.xref_stream_raw "Document.xref_stream_raw")
    | 仅适用于PDF：[`xref`](glossary.html#xref "xref")的原始流源 |'
- en: '| [`Document.xref_xml_metadata()`](#Document.xref_xml_metadata "Document.xref_xml_metadata")
    | PDF only: [`xref`](glossary.html#xref "xref") of XML metadata |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '[`Document.xref_xml_metadata()`](#Document.xref_xml_metadata "Document.xref_xml_metadata")
    | 仅适用于PDF：XML元数据的[`xref`](glossary.html#xref "xref") |'
- en: '| [`Document.chapter_count`](#Document.chapter_count "Document.chapter_count")
    | number of chapters |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '[`Document.chapter_count`](#Document.chapter_count "Document.chapter_count")
    | 章节数量 |'
- en: '| [`Document.FormFonts`](#Document.FormFonts "Document.FormFonts") | PDF only:
    list of global widget fonts |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '[`Document.FormFonts`](#Document.FormFonts "Document.FormFonts") | 仅适用于PDF：全局小部件字体列表
    |'
- en: '| [`Document.is_closed`](#Document.is_closed "Document.is_closed") | has document
    been closed? |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_closed`](#Document.is_closed "Document.is_closed") | 文档是否已关闭？
    |'
- en: '| [`Document.is_dirty`](#Document.is_dirty "Document.is_dirty") | PDF only:
    has document been changed yet? |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_dirty`](#Document.is_dirty "Document.is_dirty") | 仅适用于PDF：文档是否已更改？
    |'
- en: '| [`Document.is_encrypted`](#Document.is_encrypted "Document.is_encrypted")
    | document (still) encrypted? |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_encrypted`](#Document.is_encrypted "Document.is_encrypted") |
    文档是否（仍然）加密？ |'
- en: '| [`Document.is_fast_webaccess`](#Document.is_fast_webaccess "Document.is_fast_webaccess")
    | is PDF linearized? |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_fast_webaccess`](#Document.is_fast_webaccess "Document.is_fast_webaccess")
    | PDF是否线性化？ |'
- en: '| [`Document.is_form_pdf`](#Document.is_form_pdf "Document.is_form_pdf") |
    is this a Form PDF? |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_form_pdf`](#Document.is_form_pdf "Document.is_form_pdf") | 这是表单PDF吗？
    |'
- en: '| [`Document.is_pdf`](#Document.is_pdf "Document.is_pdf") | is this a PDF?
    |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_pdf`](#Document.is_pdf "Document.is_pdf") | 这是PDF吗？ |'
- en: '| [`Document.is_reflowable`](#Document.is_reflowable "Document.is_reflowable")
    | is this a reflowable document? |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '[`Document.is_reflowable`](#Document.is_reflowable "Document.is_reflowable")
    | 这是可重排文档吗？ |'
- en: '| [`Document.is_repaired`](#Document.is_repaired "Document.is_repaired") |
    PDF only: has this PDF been repaired during open? |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.is_repaired`](#Document.is_repaired "Document.is_repaired") |
    仅限PDF：此PDF在打开时是否已修复？ |'
- en: '| [`Document.last_location`](#Document.last_location "Document.last_location")
    | (chapter, pno) of last page |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.last_location`](#Document.last_location "Document.last_location")
    | 最后一页的（章节，页号）位置 |'
- en: '| [`Document.metadata`](#Document.metadata "Document.metadata") | metadata
    |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.metadata`](#Document.metadata "Document.metadata") | 元数据 |'
- en: '| [`Document.markinfo`](#Document.markinfo "Document.markinfo") | PDF MarkInfo
    value |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.markinfo`](#Document.markinfo "Document.markinfo") | PDF标记信息值
    |'
- en: '| [`Document.name`](#Document.name "Document.name") | filename of document
    |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.name`](#Document.name "Document.name") | 文档的文件名 |'
- en: '| [`Document.needs_pass`](#Document.needs_pass "Document.needs_pass") | require
    password to access data? |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.needs_pass`](#Document.needs_pass "Document.needs_pass") | 需要密码访问数据吗？
    |'
- en: '| [`Document.outline`](#Document.outline "Document.outline") | first [Outline](outline.html#outline)
    item |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.outline`](#Document.outline "Document.outline") | 第一个[大纲](outline.html#outline)条目
    |'
- en: '| [`Document.page_count`](#Document.page_count "Document.page_count") | number
    of pages |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.page_count`](#Document.page_count "Document.page_count") | 页数
    |'
- en: '| [`Document.permissions`](#Document.permissions "Document.permissions") |
    permissions to access the document |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.permissions`](#Document.permissions "Document.permissions") |
    访问文档的权限 |'
- en: '| [`Document.pagemode`](#Document.pagemode "Document.pagemode") | PDF PageMode
    value |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.pagemode`](#Document.pagemode "Document.pagemode") | PDF页面模式值
    |'
- en: '| [`Document.pagelayout`](#Document.pagelayout "Document.pagelayout") | PDF
    PageLayout value |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.pagelayout`](#Document.pagelayout "Document.pagelayout") | PDF页面布局值
    |'
- en: '| [`Document.version_count`](#Document.version_count "Document.version_count")
    | PDF count of versions |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| [`Document.version_count`](#Document.version_count "Document.version_count")
    | PDF版本计数 |'
- en: '**Class API**'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '**类API**'
- en: '[PRE0]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Changed in v1.14.13: support `io.BytesIO` for memory documents.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自v1.14.13更改：支持`io.BytesIO`用于内存文档。
- en: 'Changed in v1.19.6: Clearer, shorter and more consistent exception messages.
    File type “pdf” is always assumed if not specified. Empty files and memory areas
    will always lead to exceptions.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自v1.19.6更改：更清晰、更简短和更一致的异常消息。如果未指定，文件类型将始终假定为“pdf”。空文件和内存区域将始终导致异常。
- en: Creates a *Document* object.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个*Document*对象。
- en: With default parameters, a **new empty PDF** document will be created.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 默认参数下，将创建一个**新的空白PDF**文档。
- en: If *stream* is given, then the document is created from memory and, if not a
    PDF, either *filename* or *filetype* must indicate its type.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果提供了*stream*，则文档将从内存中创建，如果不是PDF，则*filename*或*filetype*必须指示其类型。
- en: If *stream* is `None`, then a document is created from the file given by *filename*.
    Its type is inferred from the extension. This can be overruled by *filetype.*
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果*stream*为`None`，则文档将从*filename*指定的文件创建。其类型将根据扩展名推断。可以通过*filetype*覆盖此行为。
- en: 'Parameters:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**filename** (*str**,**pathlib*) – A UTF-8 string or *pathlib* object containing
    a file path. The document type is inferred from the filename extension. If not
    present or not matching [a supported type](how-to-open-a-file.html#supported-file-types),
    a PDF document is assumed. For memory documents, this argument may be used instead
    of `filetype`, see below.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filename** (*str**,**pathlib*) – 包含文件路径的UTF-8字符串或*pathlib*对象。文档类型将根据文件名扩展名推断。如果不存在或不匹配[支持的类型](how-to-open-a-file.html#supported-file-types)，则假定为PDF文档。对于内存文档，可以使用此参数代替`filetype`，请参见下文。'
- en: '**stream** (*bytes**,**bytearray**,**BytesIO*) – A memory area containing a
    supported document. If not a PDF, its type **must** be specified by either `filename`
    or `filetype`.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**stream** (*bytes**,**bytearray**,**BytesIO*) – 包含支持的文档的内存区域。如果不是PDF，必须通过`filename`或`filetype`指定其类型。'
- en: '**filetype** (*str*) – A string specifying the type of document. This may be
    anything looking like a filename (e.g. “x.pdf”), in which case MuPDF uses the
    extension to determine the type, or a mime type like *application/pdf*. Just using
    strings like “pdf” or “.pdf” will also work. May be omitted for PDF documents,
    otherwise must match [a supported document type](how-to-open-a-file.html#supported-file-types).'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filetype** (*str*) – 指定文档类型的字符串。这可以是类似文件名的任何内容（例如“x.pdf”），在这种情况下，MuPDF使用扩展名确定类型，或者像*application/pdf*这样的MIME类型。只需使用像“pdf”或“.pdf”这样的字符串也可以。对于PDF文档，可以省略，否则必须匹配[支持的文档类型](how-to-open-a-file.html#supported-file-types)。'
- en: '**rect** (*rect_like*) – a rectangle specifying the desired page size. This
    parameter is only meaningful for documents with a variable page layout (“reflowable”
    documents), like e-books or HTML, and ignored otherwise. If specified, it must
    be a non-empty, finite rectangle with top-left coordinates (0, 0). Together with
    parameter *fontsize*, each page will be accordingly laid out and hence also determine
    the number of pages.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**rect** (*rect_like*) – 指定所需页面大小的矩形。此参数仅适用于具有可变页面布局（“可重排”文档），如电子书或HTML，并且在其他情况下将被忽略。如果指定，它必须是一个非空的有限矩形，其左上坐标为
    (0, 0)。与参数 *fontsize* 一起，每个页面将相应地布局，并因此确定页数。'
- en: '**width** (*float*) – may used together with *height* as an alternative to
    *rect* to specify layout information.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**width** (*float*) – 可与 *height* 一起用作 *rect* 的替代，以指定布局信息。'
- en: '**height** (*float*) – may used together with *width* as an alternative to
    *rect* to specify layout information.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**height** (*float*) – 可与 *width* 一起用作 *rect* 的替代，以指定布局信息。'
- en: '**fontsize** (*float*) – the default [`fontsize`](glossary.html#fontsize "fontsize")
    for reflowable document types. This parameter is ignored if none of the parameters
    *rect* or *width* and *height* are specified. Will be used to calculate the page
    layout.'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**fontsize** (*float*) – 可重排文档类型的默认[`字体大小`](glossary.html#fontsize "fontsize")。如果未指定
    *rect* 或 *width* 和 *height* 中的任何一个参数，则此参数将被忽略。将用于计算页面布局。'
- en: 'Raises:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 引发：
- en: '**TypeError** – if the *type* of any parameter does not conform.'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TypeError** – 如果任何参数的*类型*不符合规范。'
- en: '**FileNotFoundError** – if the file / path cannot be found. Re-implemented
    as subclass of `RuntimeError`.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**FileNotFoundError** – 如果找不到文件/路径。重新实现为`RuntimeError`的子类。'
- en: '**EmptyFileError** – if the file / path is empty or the `bytes` object in memory
    has zero length. A subclass of `FileDataError` and `RuntimeError`.'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**EmptyFileError** – 如果文件/路径为空或内存中的`bytes`对象长度为零。是`FileDataError`和`RuntimeError`的子类。'
- en: '**ValueError** – if an unknown file type is explicitly specified.'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ValueError** – 如果显式指定未知文件类型。'
- en: '**FileDataError** – if the document has an invalid structure for the given
    type – or is no file at all (but e.g. a folder). A subclass of `RuntimeError`.'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**FileDataError** – 如果文档对于给定类型具有无效结构 – 或根本不是文件（而是例如文件夹）。是`RuntimeError`的子类。'
- en: 'Returns:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: A document object. If the document cannot be created, an exception is raised
    in the above sequence. Note that PyMuPDF-specific exceptions, `FileNotFoundError`,
    `EmptyFileError` and `FileDataError` are intercepted if you check for `RuntimeError`.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 文档对象。如果无法创建文档，则会按上述顺序引发异常。请注意，如果检查`RuntimeError`，PyMuPDF特定的异常，`FileNotFoundError`，`EmptyFileError`和`FileDataError`会被拦截。
- en: 'In case of problems you can see more detail in the internal messages store:
    `print(pymupdf.TOOLS.mupdf_warnings())` (which will be emptied by this call, but
    you can also prevent this – consult [`Tools.mupdf_warnings()`](tools.html#Tools.mupdf_warnings
    "Tools.mupdf_warnings")).'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有问题，您可以在内部消息存储中查看更多详细信息：`print(pymupdf.TOOLS.mupdf_warnings())`（此调用将清空，但您也可以防止此操作
    – 参考[`Tools.mupdf_warnings()`](tools.html#Tools.mupdf_warnings "Tools.mupdf_warnings")）。
- en: Note
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'Not all document types are checked for valid formats already at open time.
    Raster images for example will raise exceptions only later, when trying to access
    the content. Other types (notably with non-binary content) may also be opened
    (and sometimes **accessed**) successfully – sometimes even when having invalid
    content for the format:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有文档类型在打开时都会检查有效格式。例如，栅格图像只有在尝试访问内容时才会稍后引发异常。其他类型（特别是具有非二进制内容的类型）有时也会成功地打开（有时甚至**访问**），即使格式无效：
- en: 'HTM, HTML, XHTML: **always** opened, `metadata["format"]` is “HTML5”, resp.
    “XHTML”.'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: HTM，HTML，XHTML：**始终**打开，`metadata["format"]` 为“HTML5”，或“XHTML”。
- en: 'XML, FB2: **always** opened, `metadata["format"]` is “FictionBook2”.'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: XML，FB2：**始终**打开，`metadata["format"]` 为“FictionBook2”。
- en: 'Overview of possible forms, note: `open` is a synonym of [Document](#document):'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 可能的形式概述，注意：`open` 是 [文档](#document) 的同义词：
- en: '[PRE2]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Note
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Raster images with a wrong (but supported) file extension **are no problem**.
    MuPDF will determine the correct image type when file **content** is actually
    accessed and will process it without complaint. So `pymupdf.open("file.jpg")`
    will work even for a PNG image.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 具有错误（但支持的）文件扩展名的栅格图像**不成问题**。当实际访问文件**内容**并且没有投诉时，MuPDF将确定正确的图像类型。因此，即使对于PNG图像，`pymupdf.open("file.jpg")`也能正常工作。
- en: The Document class can be also be used as a **context manager**. On exit, the
    document will automatically be closed.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '`Document` 类也可以作为**上下文管理器**使用。退出时，文档将自动关闭。'
- en: '[PRE3]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: New in v1.18.4
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.4 中的新内容
- en: Return the cross reference number of an [`OCG`](glossary.html#OCG "OCG") or
    [`OCMD`](glossary.html#OCMD "OCMD") attached to an image or form xobject.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 返回图像或表单X对象附加的[`OCG`](glossary.html#OCG "OCG")或[`OCMD`](glossary.html#OCMD "OCMD")的交叉引用号。
- en: 'Parameters:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the [`xref`](glossary.html#xref "xref") of an image or form
    xobject. Valid such cross reference numbers are returned by [`Document.get_page_images()`](#Document.get_page_images
    "Document.get_page_images"), resp. [`Document.get_page_xobjects()`](#Document.get_page_xobjects
    "Document.get_page_xobjects"). For invalid numbers, an exception is raised.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – 图像或表单X对象的[`xref`](glossary.html#xref "xref")号。有效的交叉引用号由[`Document.get_page_images()`](#Document.get_page_images
    "Document.get_page_images")或[`Document.get_page_xobjects()`](#Document.get_page_xobjects
    "Document.get_page_xobjects")返回。对于无效的号码，会引发异常。'
- en: 'Return type:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the cross reference number of an optional contents object or zero if there is
    none.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 可选内容对象的交叉引用号，如果没有则为零。
- en: '[PRE5]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: New in v1.18.4
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.4版新功能
- en: If *xref* represents an image or form xobject, set or remove the cross reference
    number *ocxref* of an optional contents object.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 如果*xref*代表图像或表单X对象，则设置或删除可选内容对象的交叉引用号*ocxref*。
- en: 'Parameters:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the [`xref`](glossary.html#xref "xref") of an image or form
    xobject [[5]](#f5). Valid such cross reference numbers are returned by [`Document.get_page_images()`](#Document.get_page_images
    "Document.get_page_images"), resp. [`Document.get_page_xobjects()`](#Document.get_page_xobjects
    "Document.get_page_xobjects"). For invalid numbers, an exception is raised.'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – 图像或表单X对象的[`xref`](glossary.html#xref "xref") [[5]](#f5)。有效的交叉引用号由[`Document.get_page_images()`](#Document.get_page_images
    "Document.get_page_images")或[`Document.get_page_xobjects()`](#Document.get_page_xobjects
    "Document.get_page_xobjects")返回。对于无效的号码，会引发异常。'
- en: '**ocxref** (*int*) – the [`xref`](glossary.html#xref "xref") number of an [`OCG`](glossary.html#OCG
    "OCG") / [`OCMD`](glossary.html#OCMD "OCMD"). If not zero, an invalid reference
    raises an exception. If zero, any OC reference is removed.'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ocxref** (*int*) – [`OCG`](glossary.html#OCG "OCG") / [`OCMD`](glossary.html#OCMD
    "OCMD")的[`xref`](glossary.html#xref "xref")号。如果不为零，则无效引用会引发异常。如果为零，则删除任何OC引用。'
- en: '[PRE6]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: New in v1.18.3
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3版新功能
- en: Show optional layer configurations. There always is a standard one, which is
    not included in the response.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 显示可选层配置。总是有一个标准配置，不包含在响应中。
- en: '[PRE7]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: New in v1.18.3
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3版新功能
- en: Add an optional content configuration. Layers serve as a collection of ON /
    OFF states for optional content groups and allow fast visibility switches between
    different views on the same document.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 添加一个可选内容配置。层用作可选内容组的ON / OFF状态集合，并允许在同一文档上快速切换不同视图的可见性。
- en: 'Parameters:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**name** (*str*) – arbitrary name.'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name** (*str*) – 任意名称。'
- en: '**creator** (*str*) – (optional) creating software.'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**creator** (*str*) – （可选）创建软件。'
- en: '**on** (*sequ*) – a sequence of OCG [`xref`](glossary.html#xref "xref") numbers
    which should be set to ON when this layer gets activated. All OCGs not listed
    here will be set to OFF.'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**on** (*sequ*) – 应在激活此层时设置为ON的OCG [`xref`](glossary.html#xref "xref")号序列。未列出的所有OCG将被设置为OFF。'
- en: '[PRE9]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: New in v1.18.3
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3版新功能
- en: Switch to a document view as defined by the optional layer’s configuration number.
    This is temporary, except if established as default.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 切换到由可选层配置号定义的文档视图。这是临时的，除非设为默认。
- en: 'Parameters:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**number** (*int*) – config number as returned by `Document.layer_configs()`.'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**number** (*int*) – 由`Document.layer_configs()`返回的配置号。'
- en: '**as_default** (*bool*) – make this the default configuration.'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**as_default** (*bool*) – 将此配置设置为默认配置。'
- en: Activates the ON / OFF states of OCGs as defined in the identified layer. If
    *as_default=True*, then additionally all layers, including the standard one, are
    merged and the result is written back to the standard layer, and **all optional
    layers are deleted**.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 激活在识别的层中定义的OCG的ON / OFF状态。如果*as_default=True*，则还会合并所有层，包括标准层，并将结果写回标准层，并**删除所有可选层**。
- en: '[PRE10]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: New in v1.18.3
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3版新功能
- en: Add an optional content group. An OCG is the most important unit of information
    to determine object visibility. For a PDF, in order to be regarded as having optional
    content, at least one OCG must exist.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 添加一个可选内容组。OCG是确定对象可见性的最重要信息单元。对于PDF文档，至少必须存在一个OCG才能被视为具有可选内容。
- en: 'Parameters:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**name** (*str*) – arbitrary name. Will show up in supporting PDF viewers.'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name** (*str*) – 任意名称。将在支持PDF查看器中显示。'
- en: '**config** (*int*) – layer configuration number. Default -1 is the standard
    configuration.'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**config** (*int*) – 层配置号。默认为-1是标准配置。'
- en: '**on** (*bool*) – standard visibility status for objects pointing to this OCG.'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**on** (*bool*) – 指向此OCG的对象的标准可见性状态。'
- en: '**intent** (*str**,**list*) – a string or list of strings declaring the visibility
    intents. There are two PDF standard values to choose from: “View” and “Design”.
    Default is “View”. Correct **spelling is important**.'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**intent** (*str**,**list*) – 声明可见性意图的字符串或字符串列表。可以选择两个PDF标准值：“View”和“Design”。默认为“View”。**拼写非常重要**。'
- en: '**usage** (*str*) – another influencer for OCG visibility. This will become
    part of the OCG’s `/Usage` key. There are two PDF standard values to choose from:
    “Artwork” and “Technical”. Default is “Artwork”. Please only change when required.'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**usage** (*str*) – OCG可见性的另一个影响因素。这将成为OCG的`/Usage`键的一部分。可以选择两个PDF标准值：“Artwork”和“Technical”。默认为“Artwork”。请仅在必要时更改。'
- en: 'Returns:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '[`xref`](glossary.html#xref "xref") of the created OCG. Use as entry for `oc`
    parameter in supporting objects.'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 创建的OCG的[`xref`](glossary.html#xref "xref")。用作支持对象中`oc`参数的条目。
- en: Note
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Multiple OCGs with identical parameters may be created. This will not cause
    problems. Garbage option 3 of [`Document.save()`](#Document.save "Document.save")
    will get rid of any duplicates.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会创建具有相同参数的多个OCG。这不会引起问题。[`Document.save()`](#Document.save "Document.save")的垃圾选项3将清除任何重复项。
- en: '[PRE11]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: New in v1.18.4
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.4中的新功能
- en: Create or update an [`OCMD`](glossary.html#OCMD "OCMD"), **Optional Content
    Membership Dictionary.**
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 创建或更新一个[`OCMD`](glossary.html#OCMD "OCMD")，**Optional Content Membership Dictionary（可选内容成员字典）。**
- en: 'Parameters:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – [`xref`](glossary.html#xref "xref") of the OCMD to be updated,
    or 0 for a new OCMD.'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – 要更新的OCMD的[`xref`](glossary.html#xref "xref")，或者为新的OCMD为0。'
- en: '**ocgs** (*list*) – a sequence of [`xref`](glossary.html#xref "xref") numbers
    of existing [`OCG`](glossary.html#OCG "OCG") PDF objects.'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ocgs** (*list*) – 一系列现有[`xref`](glossary.html#xref "xref") PDF 对象的编号。'
- en: '**policy** (*str*) – one of “AnyOn” (default), “AnyOff”, “AllOn”, “AllOff”
    (mixed or lower case).'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**policy** (*str*) – “AnyOn”（默认），“AnyOff”，“AllOn”，“AllOff”（混合或小写）之一。'
- en: '**ve** (*list*) – a “visibility expression”. This is a list of arbitrarily
    nested other lists – see explanation below. Use as an alternative to the combination
    *ocgs* / *policy* if you need to formulate more complex conditions.'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ve** (*list*) – “可见性表达式”。这是一个任意嵌套其他列表的列表 – 详见下面的解释。如果需要制定更复杂的条件，可用作*ocgs*
    / *policy*的替代。'
- en: 'Return type:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '[`xref`](glossary.html#xref "xref") of the OCMD. Use as `oc=xref` parameter
    in supporting objects, and respectively in [`Document.set_oc()`](#Document.set_oc
    "Document.set_oc") or [`Annot.set_oc()`](annot.html#Annot.set_oc "Annot.set_oc").'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 创建OCMD的[`xref`](glossary.html#xref "xref")。用作支持对象中`oc=xref`参数，以及分别在[`Document.set_oc()`](#Document.set_oc
    "Document.set_oc")或[`Annot.set_oc()`](annot.html#Annot.set_oc "Annot.set_oc")中使用。
- en: Note
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Like an OCG, an OCMD has a visibility state ON or OFF, and it can be used like
    an OCG. In contrast to an OCG, the OCMD state is determined by evaluating the
    state of one or more OCGs via special forms of **boolean expressions.** If the
    expression evaluates to true, the OCMD state is ON and OFF for false.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于OCG，OCMD具有开启或关闭的可见性状态，并且可以像OCG一样使用。与OCG不同的是，通过评估一个或多个OCG的状态来确定OCMD的状态，通过特殊形式的**布尔表达式**。如果表达式评估为true，则OCMD状态为ON，false为OFF。
- en: 'There are two ways to formulate OCMD visibility:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种方式可以制定OCMD的可见性：
- en: 'Use the combination of *ocgs* and *policy*: The *policy* value is interpreted
    as follows:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用*ocgs*和*policy*的组合：*policy*的值解释如下：
- en: AnyOn – (default) true if at least one OCG is ON.
  id: totrans-229
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: AnyOn – （默认）如果至少有一个OCG打开，则为true。
- en: ''
  id: totrans-230
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-231
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: AnyOff – true if at least one OCG is OFF.
  id: totrans-232
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: AnyOff – 如果至少有一个OCG关闭，则为true。
- en: ''
  id: totrans-233
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-234
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: AllOn – true if all OCGs are ON.
  id: totrans-235
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: AllOn – 如果所有OCG都打开，则为true。
- en: ''
  id: totrans-236
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-237
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: AllOff – true if all OCGs are OFF.
  id: totrans-238
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: AllOff – 如果所有OCG都关闭，则为true。
- en: ''
  id: totrans-239
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-240
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-241
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Suppose you want two PDF objects be displayed exactly one at a time (if one
    is ON, then the other one must be OFF):'
  id: totrans-242
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 假设您希望两个PDF对象一次只显示一个（如果一个打开，则另一个必须关闭）：
- en: ''
  id: totrans-243
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Solution: use an **OCG** for object 1 and an **OCMD** for object 2\. Create
    the OCMD via `set_ocmd(ocgs=[xref], policy="AllOff")`, with the [`xref`](glossary.html#xref
    "xref") of the OCG.'
  id: totrans-244
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 解决方案：使用一个**OCG**作为对象1的对象，使用一个**OCMD**作为对象2的对象。通过`set_ocmd(ocgs=[xref], policy="AllOff")`创建OCMD，其中[`xref`](glossary.html#xref
    "xref")为OCG的编号。
- en: 'Use the **visibility expression** *ve*: This is a list of two or more items.
    The **first item** is a logical keyword: one of the strings **“and”**, **“or”**,
    or **“not”**. The **second** and all subsequent items must either be an integer
    or another list. An integer must be the [`xref`](glossary.html#xref "xref") number
    of an OCG. A list must again have at least two items starting with one of the
    boolean keywords. This syntax is a bit awkward, but quite powerful:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**可见性表达式** *ve*：这是一个包含两个或更多项的列表。第一个项是一个逻辑关键词：字符串**“and”**、**“or”**或**“not”**之一。第二个及其后的项必须是整数或另一个列表。整数必须是[`xref`](glossary.html#xref
    "xref")的编号。列表必须再次至少有两个以布尔关键词开头的项。这种语法有些笨拙，但非常强大：
- en: Each list must start with a logical keyword.
  id: totrans-246
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个列表必须以逻辑关键词开头。
- en: ''
  id: totrans-247
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-248
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: If the keyword is a **“not”**, then the list must have exactly two items. If
    it is **“and”** or **“or”**, any number of other items may follow.
  id: totrans-249
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果关键词是**“not”**，那么列表必须正好有两个项。如果是**“and”**或**“or”**，则可以跟随任意数量的其他项。
- en: ''
  id: totrans-250
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-251
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: Items following the logical keyword may be either integers or again a list.
    An *integer* must be the xref of an OCG. A *list* must conform to the previous
    rules.
  id: totrans-252
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: 逻辑关键词后面的项目可以是整数或者再次是一个列表。*整数*必须是OCG的xref。*列表*必须符合前述规则。
- en: ''
  id: totrans-253
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-254
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-255
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Examples:**'
  id: totrans-256
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**示例：**'
- en: ''
  id: totrans-257
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`set_ocmd(ve=["or", 4, ["not", 5], ["and", 6, 7]])`. This delivers ON if the
    following is true: **“4 is ON, or 5 is OFF, or 6 and 7 are both ON”**.'
  id: totrans-258
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`set_ocmd(ve=["or", 4, ["not", 5], ["and", 6, 7]])`。如果以下条件为真，则返回ON：**“4为ON，或者5为OFF，或者6和7同时为ON”**。'
- en: ''
  id: totrans-259
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-260
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '`set_ocmd(ve=["not", xref])`. This has the same effect as the OCMD example
    created under 1.'
  id: totrans-261
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`set_ocmd(ve=["not", xref])`。这与第1创建的OCMD示例具有相同的效果。'
- en: ''
  id: totrans-262
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-263
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-264
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: For more details and examples see page 224 of [Adobe PDF References](app3.html#adobemanual).
    Also do have a look at example scripts [here](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/optional-content).
  id: totrans-265
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 更多详细信息和示例请参见[Adobe PDF References](app3.html#adobemanual)第224页。还请查看示例脚本[这里](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/optional-content)。
- en: ''
  id: totrans-266
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Visibility expressions, `/VE`, are part of PDF specification version 1.6\. So
    not all PDF viewers / readers may already support this feature and hence will
    react in some standard way for those cases.
  id: totrans-267
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 可见性表达式`/VE`是PDF规范1.6版的一部分。因此，并非所有PDF查看器/阅读器可能已支持此功能，因此对于这些情况会以某种标准方式进行响应。
- en: '[PRE12]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: New in v1.18.4
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自v1.18.4起新增功能
- en: Retrieve the definition of an [`OCMD`](glossary.html#OCMD "OCMD").
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 检索[`OCMD`](glossary.html#OCMD "OCMD")的定义。
- en: 'Parameters:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the [`xref`](glossary.html#xref "xref") of the OCMD.'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – OCMD的[`xref`](glossary.html#xref "xref")。'
- en: 'Return type:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: dict
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 字典
- en: 'Returns:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a dictionary with the keys *xref*, *ocgs*, *policy* and *ve*.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 带有键*xref*、*ocgs*、*policy*和*ve*的字典。
- en: '[PRE13]'
  id: totrans-277
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: New in v1.18.3
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自v1.18.3起新增功能
- en: List of optional content groups by status in the specified configuration. This
    is a dictionary with lists of cross reference numbers for OCGs that occur in the
    arrays `/ON`, `/OFF` or in some radio button group (`/RBGroups`).
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 特定配置中可选内容组的状态列表。这是一个包含数组`/ON`、`/OFF`或某些单选按钮组(`/RBGroups`)中的OCG交叉引用号列表的字典。
- en: 'Parameters:'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**config** (*int*) – the configuration layer (default is the standard config
    layer).'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: '**config** (*int*) – 配置层（默认为标准配置层）。'
- en: '[PRE14]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: New in v1.18.3
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自v1.18.3起新增功能
- en: 'Changed in v1.22.5: Support list of *locked* OCGs.'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自v1.22.5起更改：支持*锁定*OCG的列表。
- en: Mass status changes of optional content groups. **Permanently** sets the status
    of OCGs.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 大量可选内容组的状态更改。**永久**设置OCG的状态。
- en: 'Parameters:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**config** (*int*) – desired configuration layer, choose -1 for the default
    one.'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**config** (*int*) – 所需的配置层，选择-1表示默认配置层。'
- en: '**on** (*list*) – list of [`xref`](glossary.html#xref "xref") of OCGs to set
    ON. Replaces previous values. An empty list will cause no OCG being set to ON
    anymore. Should be specified if `basestate="ON"` is used.'
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**on** (*list*) – 设置为ON的OCG的[`xref`](glossary.html#xref "xref")列表。替换以前的值。如果使用`basestate="ON"`，应指定为空列表将不再设置任何OCG为ON。'
- en: '**off** (*list*) – list of [`xref`](glossary.html#xref "xref") of OCGs to set
    OFF. Replaces previous values. An empty list will cause no OCG being set to OFF
    anymore. Should be specified if `basestate="OFF"` is used.'
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**off** (*list*) – 设置为OFF的OCG的[`xref`](glossary.html#xref "xref")列表。替换以前的值。如果使用`basestate="OFF"`，应指定为空列表将不再设置任何OCG为OFF。'
- en: '**basestate** (*str*) – state of OCGs that are not mentioned in *on* or *off*.
    Possible values are “ON”, “OFF” or “Unchanged”. Upper / lower case possible.'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**basestate** (*str*) – 未在*on*或*off*中提到的OCG的状态。可能的值为“ON”、“OFF”或“Unchanged”。大小写皆可。'
- en: '**rbgroups** (*list*) – a list of lists. Replaces previous values. Each sublist
    should contain two or more OCG xrefs. OCGs in the same sublist are handled like
    buttons in a radio button group: setting one to ON automatically sets all other
    group members to OFF.'
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**rbgroups** (*list*) – 一个列表的列表。替换以前的值。每个子列表应包含两个或更多个 OCG xrefs。同一子列表中的 OCG
    就像单选按钮组中的按钮：设置一个为 ON 将自动将所有其他组成员设置为 OFF。'
- en: '**locked** (*list*) – a list of OCG xref number that cannot be changed by the
    user interface.'
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**locked** (*list*) – 无法通过用户界面更改的 OCG xref 号列表。'
- en: Values `None` will not change the corresponding PDF array.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 值 `None` 将不更改相应的 PDF 数组。
- en: '[PRE16]'
  id: totrans-295
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: New in v1.18.3
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3 中的新功能
- en: 'Details of all optional content groups. This is a dictionary of dictionaries
    like this (key is the OCG’s [`xref`](glossary.html#xref "xref")):'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 所有可选内容组的详细信息。这是一个字典，形如（键是 OCG 的 [`xref`](glossary.html#xref "xref")）：
- en: '[PRE18]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: New in v1.18.3
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3 中的新功能
- en: Show the visibility status of optional content that is modifiable by the user
    interface of supporting PDF viewers.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 显示可由支持 PDF 查看器的用户界面修改的可选内容的可见性状态。
- en: Only reports items contained in the currently selected layer configuration.
  id: totrans-303
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仅报告当前选择的层配置中包含的项目。
- en: ''
  id: totrans-304
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-305
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: 'The meaning of the dictionary keys is as follows:'
  id: totrans-306
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: 字典键的含义如下：
- en: ''
  id: totrans-307
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-308
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-309
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-310
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-311
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '*depth:* item’s nesting level in the `/Order` array'
  id: totrans-312
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*depth:* 在 `/Order` 数组中的项目嵌套级别'
- en: ''
  id: totrans-313
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-314
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '*locked:* true if cannot be changed via user interfaces'
  id: totrans-315
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*locked:* 如果无法通过用户界面更改，则为 true'
- en: ''
  id: totrans-316
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-317
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '*number:* running sequence number'
  id: totrans-318
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*number:* 运行的顺序号'
- en: ''
  id: totrans-319
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-320
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '*on:* item state'
  id: totrans-321
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*on:* 项目状态'
- en: ''
  id: totrans-322
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-323
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '*text:* text string or name field of the originating OCG'
  id: totrans-324
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*text:* 源 OCG 的文本字符串或名称字段'
- en: ''
  id: totrans-325
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-326
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '*type:* one of “label” (set by a text string), “checkbox” (set by a single
    OCG) or “radiobox” (set by a set of connected OCGs)'
  id: totrans-327
  prefs:
  - PREF_BQ
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*type:* “label”（由文本字符串设置），“checkbox”（由单个 OCG 设置）或 “radiobox”（由一组连接的 OCG 设置之一）'
- en: '[PRE20]'
  id: totrans-328
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: New in v1.18.3
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.3 中的新功能
- en: Modify OC visibility status of content groups. This is analog to what supporting
    PDF viewers would offer.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 修改内容组的 OC 可见性状态。这类似于支持 PDF 查看器提供的功能。
- en: Please note that visibility is **not** a property stored with the OCG. It is
    not even information necessarily present in the PDF document at all. Instead,
    the current visibility is **temporarily** set using the user interface of some
    supporting PDF consumer software. The same type of functionality is offered by
    this method.
  id: totrans-331
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 请注意，可见性**不是**与 OCG 存储的属性。它甚至可能根本不在 PDF 文档中存在。相反，当前的可见性是使用某些支持 PDF 消费软件的用户界面**临时**设置的。此方法提供了相同类型的功能。
- en: ''
  id: totrans-332
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: To make **permanent** changes, use [`Document.set_layer()`](#Document.set_layer
    "Document.set_layer").
  id: totrans-333
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 要进行**永久**更改，请使用 [`Document.set_layer()`](#Document.set_layer "Document.set_layer")。
- en: 'Parameters:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**number** (*int**,**str*) – either the sequence number of the item in list
    `Document.layer_configs()` or the “text” of one of these items.'
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**number** (*int**,**str*) – 列表 `Document.layer_configs()` 中项目的顺序号或其中一个项目的“text”。'
- en: '**action** (*int*) – `PDF_OC_ON` = set on (default), `PDF_OC_TOGGLE` = toggle
    on/off, `PDF_OC_OFF` = set off.'
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**action** (*int*) – `PDF_OC_ON` = 设置为开启（默认），`PDF_OC_TOGGLE` = 切换开/关，`PDF_OC_OFF`
    = 设置为关闭。'
- en: '[PRE21]'
  id: totrans-337
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Decrypts the document with the string *password*. If successful, document data
    can be accessed. For PDF documents, the “owner” and the “user” have different
    privileges, and hence different passwords may exist for these authorization levels.
    The method will automatically establish the appropriate (owner or user) access
    rights for the provided password.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 使用字符串 *password* 解密文档。如果成功，可以访问文档数据。对于 PDF 文档，“所有者”和“用户”具有不同的特权，因此可能存在这些授权级别的不同密码。该方法将自动为提供的密码建立适当的（所有者或用户）访问权限。
- en: 'Parameters:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**password** (*str*) – owner or user password.'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: '**password** (*str*) – 所有者或用户密码。'
- en: 'Return type:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a positive value if successful, zero otherwise (the string does not match either
    password). If positive, the indicator [`Document.is_encrypted`](#Document.is_encrypted
    "Document.is_encrypted") is set to *False*. **Positive** return codes carry the
    following information detail:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功，则返回正值，否则返回零（字符串不匹配任何密码）。如果返回正值，则指示器 [`Document.is_encrypted`](#Document.is_encrypted
    "Document.is_encrypted") 将设置为 *False*。**正**返回代码携带以下详细信息：
- en: 1 => authenticated, but the PDF has neither owner nor user passwords.
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1 => 已验证，但 PDF 既没有所有者密码也没有用户密码。
- en: 2 => authenticated with the **user** password.
  id: totrans-346
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2 => 使用 **用户** 密码进行身份验证。
- en: 4 => authenticated with the **owner** password.
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 4 => 使用 **所有者** 密码进行身份验证。
- en: 6 => authenticated and both passwords are equal – probably a rare situation.
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 6 => 已验证，且两个密码相等 – 可能是一种罕见的情况。
- en: Note
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The document may be protected by an owner, but **not** by a user password. Detect
    this situation via `doc.authenticate("") == 2`. This allows opening and reading
    the document without authentication, but, depending on the [`Document.permissions`](#Document.permissions
    "Document.permissions") value, other actions may be prohibited. PyMuPDF (like
    MuPDF) in this case **ignores those restrictions**. So, – in contrast to any PDF
    viewers – you can for example extract text and add or modify content, even if
    the respective permission flags `PDF_PERM_COPY`, `PDF_PERM_MODIFY`, `PDF_PERM_ANNOTATE`,
    etc. are set off! It is your responsibility building a legally compliant application
    where applicable.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 文档可能由所有者保护，但**不是**由用户密码保护。通过 `doc.authenticate("") == 2` 可检测此情况。这允许无需验证即可打开和阅读文档，但依赖于[`Document.permissions`](#Document.permissions
    "Document.permissions")值，其他操作可能会受限制。在这种情况下，PyMuPDF（如MuPDF）**忽略这些限制**。因此，与任何PDF查看器相反，例如即使相应的权限标志`PDF_PERM_COPY`、`PDF_PERM_MODIFY`、`PDF_PERM_ANNOTATE`等被关闭，您也可以提取文本并添加或修改内容！在适用的情况下，您有责任构建合法合规的应用程序。
- en: '[PRE22]'
  id: totrans-351
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: New in v 1.18.6
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v 1.18.6 中引入
- en: 'PDF only: Return a list of page numbers that have the specified label – note
    that labels may not be unique in a PDF. This implies a sequential search through
    **all page numbers** to compare their labels.'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回具有指定标签的页面号列表 – 请注意，PDF 中的标签可能不唯一。这意味着需要对所有页面号进行顺序搜索以比较它们的标签。
- en: Note
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Implementation detail – pages are **not loaded** for this purpose.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 实施细节 – 用于此目的，页面**不会被加载**。
- en: 'Parameters:'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**label** (*str*) – the label to look for, e.g. “vii” (Roman number 7).'
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标签** (*str*) – 要查找的标签，例如“vii”（罗马数字7）。'
- en: '**only_one** (*bool*) – stop after first hit. Useful e.g. if labelling is known
    to be unique, or there are many pages, etc. The default will check every page
    number.'
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**only_one** (*bool*) – 在第一次命中后停止。如果标签是唯一的已知值或者页面很多等情况下非常有用。默认会检查每个页面号。'
- en: 'Return type:'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: list
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 列表
- en: 'Returns:'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: list of page numbers that have this label. Empty if none found, no labels defined,
    etc.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 具有此标签的页面号列表。如果找不到、未定义标签等，则为空。
- en: '[PRE23]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: New in v1.18.7
  id: totrans-364
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.18.7 中引入
- en: 'PDF only: Extract the list of page label definitions. Typically used for modifications
    before feeding it into [`Document.set_page_labels()`](#Document.set_page_labels
    "Document.set_page_labels").'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：提取页面标签定义列表。通常用于在输入[`Document.set_page_labels()`](#Document.set_page_labels
    "Document.set_page_labels")之前进行修改。
- en: 'Returns:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a list of dictionaries as defined in [`Document.set_page_labels()`](#Document.set_page_labels
    "Document.set_page_labels").
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 一个字典列表，如[`Document.set_page_labels()`](#Document.set_page_labels "Document.set_page_labels")中所定义。
- en: '[PRE24]'
  id: totrans-368
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: New in v1.18.6
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.18.6 中引入
- en: 'PDF only: Add or update the page label definitions of the PDF.'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：添加或更新PDF的页面标签定义。
- en: 'Parameters:'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**labels** (*list*) –'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: '**标签** (*列表*) –'
- en: 'a list of dictionaries. Each dictionary defines a label building rule and a
    0-based “start” page number. That start page is the first for which the label
    definition is valid. Each dictionary has up to 4 items and looks like `{''startpage'':
    int, ''prefix'': str, ''style'': str, ''firstpagenum'': int}` and has the following
    items.'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: '一个字典列表。每个字典定义一个标签构建规则和基于0的“起始”页码。该起始页是首个适用于该标签定义的页面。每个字典最多有4个条目，类似于 `{''startpage'':
    int, ''prefix'': str, ''style'': str, ''firstpagenum'': int}`，具有以下条目。'
- en: '`startpage`: (int) the first page number (0-based) to apply the label rule.
    This key **must be present**. The rule is applied to all subsequent pages until
    either end of document or superseded by the rule with the next larger page number.'
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`startpage`: (int) 应用标签规则的第一页号（基于0）。此键**必须存在**。规则适用于文档的所有后续页面，直到超过下一个较大页码的规则为止。'
- en: '`prefix`: (str) an arbitrary string to start the label with, e.g. “A-”. Default
    is “”.'
  id: totrans-375
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`prefix`: (str) 一个任意字符串，用于开始标签，例如“A-”。默认为“”。'
- en: '`style`: (str) the numbering style. Available are “D” (decimal), “r”/”R” (Roman
    numbers, lower / upper case), and “a”/”A” (lower / upper case alphabetical numbering:
    “a” through “z”, then “aa” through “zz”, etc.). Default is “”. If “”, no numbering
    will take place and the pages in that range will receive the same label consisting
    of the `prefix` value. If prefix is also omitted, then the label will be “”.'
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`style`: (str) 编号样式。可选的有“D”（十进制）、“r”/“R”（罗马数字，小写 / 大写）、“a”/“A”（字母编号，小写 / 大写：“a”到“z”，然后“aa”到“zz”等）。默认为“”。如果为空，则范围内的页面将获得相同的由
    `prefix` 值组成的标签。如果 `prefix` 也省略，则标签将是“”。'
- en: '`firstpagenum`: (int) start numbering with this value. Default is 1, smaller
    values are ignored.'
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`firstpagenum`: (int) 从该值开始编号。默认为1，较小的值将被忽略。'
- en: 'For example:'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 例如：
- en: '[PRE25]'
  id: totrans-379
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: will generate the labels “A-10”, “A-11”, “A-12”, “A-13”, “1”, “2”, “3”, … for
    pages 6, 7 and so on until end of document. Pages 0 through 5 will have the label
    “”.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 将为页面 6、7 等生成标签“A-10”、“A-11”、“A-12”、“A-13”、“1”、“2”、“3”等，直到文档末尾。页面 0 到 5 将标签为“”。
- en: '[PRE26]'
  id: totrans-381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: New in v.1.17.3
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v.1.17.3
- en: Return a page pointer in a reflowable document. After re-layouting the document,
    the result of this method can be used to find the new location of the page.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 返回可重新流动文档中的页面指针。在重新布局文档后，此方法的结果可用于查找页面的新位置。
- en: Note
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Do not confuse with items of a table of contents, TOC.
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 不要与目录项 TOC 混淆。
- en: 'Parameters:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**loc** (*list**,**tuple*) – page location. Must be a valid *(chapter, pno)*.'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: '**loc**（*列表**,**元组*） – 页面位置。必须是有效的 *(章节, 页数)*。'
- en: 'Return type:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: pointer
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 指针
- en: 'Returns:'
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a long integer in pointer format. To be used for finding the new location of
    the page after re-layouting the document. Do not touch or re-assign.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 以指针格式的长整数。用于找到文档重新布局后页面的新位置。不要触摸或重新分配。
- en: '[PRE27]'
  id: totrans-392
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: New in v.1.17.3
  id: totrans-393
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v.1.17.3
- en: Return the new page location after re-layouting the document.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 在重新布局文档后返回新的页面位置。
- en: 'Parameters:'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**bookmark** (*pointer*) – created by [`Document.make_bookmark()`](#Document.make_bookmark
    "Document.make_bookmark").'
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: '**bookmark**（*指针*） – 由 [`Document.make_bookmark()`](#Document.make_bookmark
    "Document.make_bookmark") 创建。'
- en: 'Return type:'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: tuple
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 元组
- en: 'Returns:'
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the new (chapter, pno) of the page.
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: 页面的新位置（章节, 页数）。
- en: '[PRE28]'
  id: totrans-401
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: New in v.1.17.0
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v.1.17.0
- en: Return the number of pages of a chapter.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 返回章节的页数。
- en: 'Parameters:'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**chapter** (*int*) – the 0-based chapter number.'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: '**chapter**（*整数*） – 基于 0 的章节编号。'
- en: 'Return type:'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 整数
- en: 'Returns:'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: number of pages in chapter. Relevant only for document types with chapter support
    (EPUB currently).
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 章节中的页数。仅适用于支持章节的文档类型（目前为 EPUB）。
- en: '[PRE29]'
  id: totrans-410
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: New in v.1.17.0
  id: totrans-411
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v.1.17.0
- en: Return the location of the following page.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 返回下一页的位置。
- en: 'Parameters:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**page_id** (*tuple*) – the current page id. This must be a tuple *(chapter,
    pno)* identifying an existing page.'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: '**page_id**（*元组*） – 当前页面 id。这必须是标识现有页面的元组 *(章节, 页数)*。'
- en: 'Returns:'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: The tuple of the following page, i.e. either *(chapter, pno + 1)* or *(chapter
    + 1, 0)*, **or** the empty tuple *()* if the argument was the last page. Relevant
    only for document types with chapter support (EPUB currently).
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 下一页的元组，即 *(章节, 页数 + 1)* 或 *(章节 + 1, 0)*，**或** 如果参数是最后一页，则为空元组 *()*。仅适用于支持章节的文档类型（目前为
    EPUB）。
- en: '[PRE30]'
  id: totrans-417
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: New in v.1.17.0
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v.1.17.0
- en: Return the locator of the preceding page.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 返回前一页的定位器。
- en: 'Parameters:'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**page_id** (*tuple*) – the current page id. This must be a tuple *(chapter,
    pno)* identifying an existing page.'
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: '**page_id**（*元组*） – 当前页面 id。这必须是标识现有页面的元组 *(章节, 页数)*。'
- en: 'Returns:'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: The tuple of the preceding page, i.e. either *(chapter, pno - 1)* or the last
    page of the preceding chapter, **or** the empty tuple *()* if the argument was
    the first page. Relevant only for document types with chapter support (EPUB currently).
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 前一页的元组，即 *(章节, 页数 - 1)* 或前一章节的最后一页，**或** 如果参数是第一页，则为空元组 *()*。仅适用于支持章节的文档类型（目前为
    EPUB）。
- en: '[PRE31]'
  id: totrans-424
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Changed in v1.17.0: For document types supporting a so-called “chapter structure”
    (like EPUB), pages can also be loaded via the combination of chapter number and
    relative page number, instead of the absolute page number. This should **significantly
    speed up access** for large documents.'
  id: totrans-425
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.17.0 中更改：对于支持所谓的“章节结构”（如 EPUB）的文档类型，页面也可以通过章节编号和相对页数的组合加载，而不是绝对页数。这应该 **显著加快**
    对大型文档的访问速度。
- en: Create a [Page](page.html#page) object for further processing (like rendering,
    text searching, etc.).
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 为进一步处理（如渲染、文本搜索等）创建一个 [Page](page.html#page) 对象。
- en: 'Parameters:'
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**page_id** (*int**,**tuple*) –'
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: '**page_id**（*整数**,**元组*） –'
- en: '*(Changed in v1.17.0)*'
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: '*(v1.17.0 中更改)*'
- en: 'Either a 0-based page number, or a tuple *(chapter, pno)*. For an **integer**,
    any `-∞ < page_id < page_count` is acceptable. While page_id is negative, [`page_count`](#Document.page_count
    "Document.page_count") will be added to it. For example: to load the last page,
    you can use *doc.load_page(-1)*. After this you have page.number = doc.page_count
    - 1.'
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 可以是基于 0 的页码，或元组 *(章节, 页数)*。对于 **整数**，任何 `-∞ < page_id < page_count` 都可以接受。当
    page_id 为负数时，将会添加 [`page_count`](#Document.page_count "Document.page_count")。例如：要加载最后一页，你可以使用
    *doc.load_page(-1)*。之后，你将拥有 page.number = doc.page_count - 1。
- en: For a tuple, *chapter* must be in range [`Document.chapter_count`](#Document.chapter_count
    "Document.chapter_count"), and *pno* must be in range [`Document.chapter_page_count()`](#Document.chapter_page_count
    "Document.chapter_page_count") of that chapter. Both values are 0-based. Using
    this notation, [`Page.number`](page.html#Page.number "Page.number") will equal
    the given tuple. Relevant only for document types with chapter support (EPUB currently).
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 对于元组，*chapter* 必须在 [`Document.chapter_count`](#Document.chapter_count "Document.chapter_count")
    范围内，并且 *pno* 必须在该章节的 [`Document.chapter_page_count()`](#Document.chapter_page_count
    "Document.chapter_page_count") 范围内。这两个值都是从0开始计数的。使用这种表示法，[`Page.number`](page.html#Page.number
    "Page.number") 将等于给定的元组。仅适用于支持章节结构的文档类型（目前仅限EPUB）。
- en: 'Return type:'
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: '[Page](page.html#page)'
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: '[Page](page.html#page)'
- en: Note
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'Documents also follow the Python sequence protocol with page numbers as indices:
    *doc.load_page(n) == doc[n]*.'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 文档还遵循带有页码索引的Python序列协议：*doc.load_page(n) == doc[n]*。
- en: 'For **absolute page numbers** only, expressions like *“for page in doc: …”*
    and *“for page in reversed(doc): …”* will successively yield the document’s pages.
    Refer to [`Document.pages()`](#Document.pages "Document.pages") which allows processing
    pages as with slicing.'
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: '仅限**绝对页码**，如*“for page in doc: …”* 和 *“for page in reversed(doc): …”* 将按顺序产生文档的页面。请参考
    [`Document.pages()`](#Document.pages "Document.pages")，允许像切片一样处理页面。'
- en: 'You can also use index notation with the new chapter-based page identification:
    use *page = doc[(5, 2)]* to load the third page of the sixth chapter.'
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用基于章节的新页面标识的索引表示法：使用 *page = doc[(5, 2)]* 加载第六章的第三页。
- en: To maintain a consistent API, for document types not supporting a chapter structure
    (like PDFs), [`Document.chapter_count`](#Document.chapter_count "Document.chapter_count")
    is 1, and pages can also be loaded via tuples *(0, pno)*. See this [[3]](#f3)
    footnote for comments on performance improvements.
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保持一致的API，在不支持章节结构（如PDF）的文档类型中，[`Document.chapter_count`](#Document.chapter_count
    "Document.chapter_count") 为1，也可以通过元组*(0, pno)*加载页面。参见 [[3]](#f3) 注释以获取性能改进的评论。
- en: '[PRE32]'
  id: totrans-439
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: New in v1.16.10
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.16.10版中的新功能
- en: 'PDF only: Provide a new copy of a page after finishing and updating all pending
    changes.'
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：在完成并更新所有待定更改后，提供页面的新副本。
- en: 'Parameters:'
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**page** ([Page](page.html#page)) – page object.'
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: '**page** ([Page](page.html#page)) – 页面对象。'
- en: 'Return type:'
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: '[Page](page.html#page)'
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: '[Page](page.html#page)'
- en: 'Returns:'
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a new copy of the same page. All pending updates (e.g. to annotations or widgets)
    will be finalized and a fresh copy of the page will be loaded.
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 相同页面的新副本。将会完成所有待定更新（如注释或小部件），并加载页面的新副本。
- en: Note
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: In a typical use case, a page [Pixmap](pixmap.html#pixmap) should be taken after
    annotations / widgets have been added or changed. To force all those changes being
    reflected in the page structure, this method re-instates a fresh copy while keeping
    the object hierarchy “document -> page -> annotations/widgets” intact.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 在典型用例中，在添加或更改注释/小部件后应获取页面 [Pixmap](pixmap.html#pixmap)。为了强制所有这些更改在页面结构中反映出来，该方法将重新加载一个新副本，同时保持对象层次结构“文档
    -> 页面 -> 注释/小部件”不变。
- en: '[PRE33]'
  id: totrans-450
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'PDF only: Convert destination names into a Python dict.'
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：将目标名称转换为Python字典。
- en: 'Returns:'
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'A dictionary with the following layout:'
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 具有以下布局的字典：
- en: '*key*: (str) the name.'
  id: totrans-454
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*key*: (str) 名称。'
- en: '*value*: (dict) with the following layout:'
  id: totrans-455
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*value*: (dict) 具有以下布局：'
- en: '”page”: target page number (0-based). If no page number found -1.'
  id: totrans-456
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '”page”: 目标页码（从0开始）。如果找不到页码，则返回-1。'
- en: '”to”: (x, y) target point on page. Currently in PDF coordinates, i.e. point
    (0,0) is the bottom-left of the page.'
  id: totrans-457
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '”to”: (x, y) 页面上的目标点。目前在PDF坐标中，即点(0,0)是页面的左下角。'
- en: '”zoom”: (float) the zoom factor.'
  id: totrans-458
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '”zoom”: (float) 缩放因子。'
- en: '”dest”: (str) only present if the target location on the page has not been
    provided as “/XYZ” or if no page number was found.'
  id: totrans-459
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '”dest”: (str) 仅在页面上的目标位置未提供为“/XYZ”或未找到页码时才存在。'
- en: 'Examples:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE34]'
  id: totrans-461
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'or:'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 或：
- en: '[PRE35]'
  id: totrans-463
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: All names found in the catalog under keys “/Dests” and “/Names/Dests” are included.
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 目录中所有在“/Dests”和“/Names/Dests”键下找到的名称都包含在内。
- en: New in v1.23.6
  id: totrans-465
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.23.6版中的新功能
- en: '[PRE36]'
  id: totrans-466
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: New in v1.17.7
  id: totrans-467
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.17.7版中的新功能
- en: 'PDF only: Return the unrotated page rectangle – **without loading the page**
    (via [`Document.load_page()`](#Document.load_page "Document.load_page")). This
    is meant for internal purpose requiring best possible performance.'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：返回未旋转的页面矩形 – **无需加载页面**（通过 [`Document.load_page()`](#Document.load_page
    "Document.load_page")）。这适用于需要最佳性能的内部目的。
- en: 'Parameters:'
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – 0-based page number.'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 从0开始的页面编号。'
- en: 'Returns:'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '[Rect](rect.html#rect) of the page like [`Page.rect()`](page.html#Page.rect
    "Page.rect"), but ignoring any rotation.'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 页面的 [Rect](rect.html#rect) 与 [`Page.rect()`](page.html#Page.rect "Page.rect")
    类似，但忽略任何旋转。
- en: '[PRE37]'
  id: totrans-473
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: New in v1.17.7
  id: totrans-474
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新增于 v1.17.7
- en: 'PDF only: Return the [`xref`](glossary.html#xref "xref") of the page – **without
    loading the page** (via [`Document.load_page()`](#Document.load_page "Document.load_page")).
    This is meant for internal purpose requiring best possible performance.'
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回页面的 [`xref`](glossary.html#xref "xref") – **不加载页面**（通过 [`Document.load_page()`](#Document.load_page
    "Document.load_page")）。这是为内部需要而设计，要求尽可能最佳性能。
- en: 'Parameters:'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – 0-based page number.'
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 基于 0 的页码数。'
- en: 'Returns:'
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '[`xref`](glossary.html#xref "xref") of the page like [`Page.xref`](page.html#Page.xref
    "Page.xref").'
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: 页面的 [`xref`](glossary.html#xref "xref") 与 [`Page.xref`](page.html#Page.xref
    "Page.xref") 类似。
- en: '[PRE38]'
  id: totrans-480
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: New in v1.16.4
  id: totrans-481
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新增于 v1.16.4
- en: 'A generator for a range of pages. Parameters have the same meaning as in the
    built-in function *range()*. Intended for expressions of the form *“for page in
    doc.pages(start, stop, step): …”*.'
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: '一个页面范围的生成器。参数的含义与内置函数 *range()* 相同。用于形如 *“for page in doc.pages(start, stop,
    step): …”* 的表达式。'
- en: 'Parameters:'
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**start** (*int*) – start iteration with this page number. Default is zero,
    allowed values are `-∞ < start < page_count`. While this is negative, [`page_count`](#Document.page_count
    "Document.page_count") is added **before** starting the iteration.'
  id: totrans-484
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**start** (*int*) – 从此页码开始迭代。默认为零，允许的值为 `-∞ < start < page_count`。如果为负数，将在开始迭代之前加上
    [`page_count`](#Document.page_count "Document.page_count")。'
- en: '**stop** (*int*) – stop iteration at this page number. Default is [`page_count`](#Document.page_count
    "Document.page_count"), possible are `-∞ < stop <= page_count`. Larger values
    are **silently replaced** by the default. Negative values will cyclically emit
    the pages in reversed order. As with the built-in *range()*, this is the first
    page **not** returned.'
  id: totrans-485
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**stop** (*int*) – 在此页码数停止迭代。默认为 [`page_count`](#Document.page_count "Document.page_count")，可选范围为
    `-∞ < stop <= page_count`。大于此值的将被 **静默替换** 为默认值。负值将循环发出倒序页面。与内置的 *range()* 相同，这不是第一个不返回的页面。'
- en: '**step** (*int*) – stepping value. Defaults are 1 if start < stop and -1 if
    start > stop. Zero is not allowed.'
  id: totrans-486
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**step** (*int*) – 步进值。如果起始页小于结束页，默认为 1；如果起始页大于结束页，默认为 -1。不允许为零。'
- en: 'Returns:'
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a generator iterator over the document’s pages. Some examples:'
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 文档页面的生成器迭代器。以下是一些示例：
- en: ”doc.pages()” emits all pages.
  id: totrans-489
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ”doc.pages()” 发出所有页面。
- en: ”doc.pages(4, 9, 2)” emits pages 4, 6, 8.
  id: totrans-490
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ”doc.pages(4, 9, 2)” 发出页面 4, 6, 8。
- en: ”doc.pages(0, None, 2)” emits all pages with even numbers.
  id: totrans-491
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ”doc.pages(0, None, 2)” 发出所有偶数编号的页面。
- en: ”doc.pages(-2)” emits the last two pages.
  id: totrans-492
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ”doc.pages(-2)” 发出最后两页。
- en: ”doc.pages(-1, -1)” emits all pages in reversed order.
  id: totrans-493
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ”doc.pages(-1, -1)” 以倒序方式发出所有页面。
- en: '”doc.pages(-1, -10)” always emits 10 pages in reversed order, starting with
    the last page – **repeatedly** if the document has less than 10 pages. So for
    a 4-page document the following page numbers are emitted: 3, 2, 1, 0, 3, 2, 1,
    0, 3, 2, 1, 0, 3.'
  id: totrans-494
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ”doc.pages(-1, -10)” 总是以倒序方式发出 10 页，从最后一页开始，**重复**，如果文档少于 10 页。因此，对于一个有 4 页的文档，将发出以下页码：3,
    2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0, 3。
- en: '[PRE39]'
  id: totrans-495
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Create a PDF version of the current document and write it to memory. **All document
    types** are supported. The parameters have the same meaning as in [`insert_pdf()`](#Document.insert_pdf
    "Document.insert_pdf"). In essence, you can restrict the conversion to a page
    subset, specify page rotation, and revert page sequence.
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: 创建当前文档的 PDF 版本并将其写入内存。支持**所有文档类型**。参数的含义与 [`insert_pdf()`](#Document.insert_pdf
    "Document.insert_pdf") 相同。实质上，您可以限制转换到页面子集，指定页面旋转并恢复页面顺序。
- en: 'Parameters:'
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**from_page** (*int*) – first page to copy (0-based). Default is first page.'
  id: totrans-498
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**from_page** (*int*) – 要复制的第一页（基于 0）。默认为第一页。'
- en: '**to_page** (*int*) – last page to copy (0-based). Default is last page.'
  id: totrans-499
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**to_page** (*int*) – 要复制的最后一页（基于 0）。默认为最后一页。'
- en: '**rotate** (*int*) – rotation angle. Default is 0 (no rotation). Should be
    *n * 90* with an integer n (not checked).'
  id: totrans-500
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**rotate** (*int*) – 旋转角度。默认为 0（无旋转）。应为整数 n 的 *n * 90*，未经检查。'
- en: 'Return type:'
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: bytes
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: bytes
- en: 'Returns:'
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a Python *bytes* object containing a PDF file image. It is created by internally
    using `tobytes(garbage=4, deflate=True)`. See [`tobytes()`](#Document.tobytes
    "Document.tobytes"). You can output it directly to disk or open it as a PDF. Here
    are some examples:'
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: 一个 Python *bytes* 对象，包含一个 PDF 文件图像。内部使用 `tobytes(garbage=4, deflate=True)` 创建。参见
    [`tobytes()`](#Document.tobytes "Document.tobytes")。您可以直接将其输出到磁盘或打开为 PDF。以下是一些示例：
- en: '[PRE40]'
  id: totrans-505
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '[PRE41]'
  id: totrans-506
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Note
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The method uses the same logic as the *mutool convert* CLI. This works very
    well in most cases – however, beware of the following limitations.
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: 该方法与*mutool convert* CLI使用相同的逻辑。在大多数情况下运行良好——但请注意以下限制。
- en: 'Image files: perfect, no issues detected. However, image transparency is ignored.
    If you need that (like for a watermark), use [`Page.insert_image()`](page.html#Page.insert_image
    "Page.insert_image") instead. Otherwise, this method is recommended for its much
    better performance.'
  id: totrans-509
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图像文件：完美，未检测到问题。但是，图像透明度被忽略。如果需要（例如水印），请改用[`Page.insert_image()`](page.html#Page.insert_image
    "Page.insert_image")。否则，由于其更佳性能，建议使用此方法。
- en: 'XPS: appearance very good. Links work fine, outlines (bookmarks) are lost,
    but can easily be recovered [[2]](#f2).'
  id: totrans-510
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: XPS：外观非常好。链接工作正常，大纲（书签）丢失，但可以轻松恢复[[2]](#f2)。
- en: 'EPUB, CBZ, FB2: similar to XPS.'
  id: totrans-511
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: EPUB、CBZ、FB2：类似于XPS。
- en: 'SVG: medium. Roughly comparable to [svglib](https://github.com/deeplook/svglib).'
  id: totrans-512
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SVG：中等。与[svglib](https://github.com/deeplook/svglib)大致相当。
- en: '[PRE42]'
  id: totrans-513
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Creates a table of contents (TOC) out of the document’s outline chain.
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: 创建目录（TOC），以文档的大纲链为基础。
- en: 'Parameters:'
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**simple** (*bool*) – Indicates whether a simple or a detailed TOC is required.
    If *False*, each item of the list also contains a dictionary with [linkDest](linkdest.html#linkdest)
    details for each outline entry.'
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: '**simple**（*bool*）– 指示是否需要简单或详细的TOC。如果为*False*，则列表的每个项目还包含用于每个大纲条目的[linkDest](linkdest.html#linkdest)详细信息的字典。'
- en: 'Return type:'
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: list
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: list
- en: 'Returns:'
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a list of lists. Each entry has the form *[lvl, title, page, dest]*. Its entries
    have the following meanings:'
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 一个列表的列表。每个条目的形式为*[lvl, title, page, dest]*。其条目具有以下含义：
- en: '*lvl* – hierarchy level (positive *int*). The first entry is always 1\. Entries
    in a row are either **equal**, **increase** by 1, or **decrease** by any number.'
  id: totrans-521
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*lvl* – 层次级别（正整数）。第一个条目始终为1。连续条目要么相等，要么递增1，要么以任何数字递减。'
- en: '*title* – title (*str*)'
  id: totrans-522
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*title* – 标题（*str*）'
- en: '*page* – 1-based source page number (*int*). `-1` if no destination or outside
    document.'
  id: totrans-523
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*page* – 基于1的源页面编号（*int*）。如果没有目标或在文档外部，则为`-1`。'
- en: '*dest* – (*dict*) included only if *simple=False*. Contains details of the
    TOC item as follows:'
  id: totrans-524
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*dest* – （*dict*）仅在*simple=False*时包含。包含如下TOC条目的详细信息：'
- en: 'kind: destination kind, see [Link Destination Kinds](vars.html#linkdest-kinds).'
  id: totrans-525
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: kind：目标类型，参见[链接目标类型](vars.html#linkdest-kinds)。
- en: 'file: filename if kind is [`LINK_GOTOR`](vars.html#LINK_GOTOR "LINK_GOTOR")
    or [`LINK_LAUNCH`](vars.html#LINK_LAUNCH "LINK_LAUNCH").'
  id: totrans-526
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件：如果kind为[`LINK_GOTOR`](vars.html#LINK_GOTOR "LINK_GOTOR") 或 [`LINK_LAUNCH`](vars.html#LINK_LAUNCH
    "LINK_LAUNCH")，则为文件名。
- en: 'page: target page, 0-based, [`LINK_GOTOR`](vars.html#LINK_GOTOR "LINK_GOTOR")
    or [`LINK_GOTO`](vars.html#LINK_GOTO "LINK_GOTO") only.'
  id: totrans-527
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: page：目标页面，基于0，[`LINK_GOTOR`](vars.html#LINK_GOTOR "LINK_GOTOR") 或 [`LINK_GOTO`](vars.html#LINK_GOTO
    "LINK_GOTO")。
- en: 'to: position on target page ([Point](point.html#point)).'
  id: totrans-528
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: to：目标页面上的位置（[Point](point.html#point)）。
- en: 'zoom: (float) zoom factor on target page.'
  id: totrans-529
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缩放：目标页面上的缩放因子（*float*）。
- en: 'xref: [`xref`](glossary.html#xref "xref") of the item (0 if no PDF).'
  id: totrans-530
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: xref：项目的[`xref`](glossary.html#xref "xref")（如果无PDF，则为0）。
- en: 'color: item color in PDF RGB format `(red, green, blue)`, or omitted (always
    omitted if no PDF).'
  id: totrans-531
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 颜色：PDF RGB格式中的项目颜色`(red, green, blue)`，或省略（如果没有PDF则始终省略）。
- en: 'bold: true if bold item text or omitted. PDF only.'
  id: totrans-532
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 粗体：如果为粗体项目文本或省略，则为true。仅适用于PDF。
- en: 'italic: true if italic item text, or omitted. PDF only.'
  id: totrans-533
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 斜体：如果为斜体项目文本，则为true，或省略。仅适用于PDF。
- en: 'collapse: true if sub-items are folded, or omitted. PDF only.'
  id: totrans-534
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: collapse：如果子项目折叠，则为true，或省略。仅适用于PDF。
- en: 'nameddest: target name if kind=4\. PDF only. (New in 1.23.7.)'
  id: totrans-535
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: nameddest：如果kind=4，则为目标名称。仅适用于PDF。（1.23.7新增。）
- en: '[PRE43]'
  id: totrans-536
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: New in v1.18.7
  id: totrans-537
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.7新增内容
- en: 'PDF only: Return the PDF dictionary keys of the [`dictionary`](glossary.html#dictionary
    "dictionary") object provided by its xref number.'
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：返回[`xref`](glossary.html#xref "xref")所提供的[`dictionary`](glossary.html#dictionary
    "dictionary")对象的PDF字典键。
- en: 'Parameters:'
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the [`xref`](glossary.html#xref "xref"). *(Changed in v1.18.10)*
    Use `-1` to access the special dictionary “PDF trailer”.'
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: '**xref**（*int*）– 项目的[`xref`](glossary.html#xref "xref")。*(v1.18.10中更改)* 使用`-1`访问特殊字典“PDF尾部”。'
- en: 'Returns:'
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a tuple of dictionary keys present in object [`xref`](glossary.html#xref "xref").
    Examples:'
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: '[`dictionary`](glossary.html#dictionary "dictionary")对象的PDF字典键的返回类型和值。'
- en: '[PRE44]'
  id: totrans-543
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '[PRE45]'
  id: totrans-544
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: New in v1.18.7
  id: totrans-545
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.7新增内容
- en: 'PDF only: Return type and value of a PDF dictionary key of a [`dictionary`](glossary.html#dictionary
    "dictionary") object given by its xref.'
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：给定其xref的[`dictionary`](glossary.html#dictionary "dictionary")对象的PDF字典键的返回类型和值。
- en: 'Parameters:'
  id: totrans-547
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the [`xref`](glossary.html#xref "xref"). *Changed in v1.18.10:*
    Use `-1` to access the special dictionary “PDF trailer”.'
  id: totrans-548
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – [`xref`](glossary.html#xref "xref")。*在 v1.18.10 中更改：* 使用
    `-1` 来访问特殊字典 “PDF 尾页”。'
- en: '**key** (*str*) – the desired PDF key. Must **exactly** match (case-sensitive)
    one of the keys contained in [`Document.xref_get_keys()`](#Document.xref_get_keys
    "Document.xref_get_keys").'
  id: totrans-549
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**key** (*str*) – 所需的 PDF 键。必须 **完全** 匹配（区分大小写），其中之一包含在 [`Document.xref_get_keys()`](#Document.xref_get_keys
    "Document.xref_get_keys") 中。'
- en: 'Return type:'
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: tuple
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: 元组
- en: 'Returns:'
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'A tuple (type, value) of strings, where type is one of “xref”, “array”, “dict”,
    “int”, “float”, “null”, “bool”, “name”, “string” or “unknown” (should not occur).
    Independent of “type”, the value of the key is **always** formatted as a string
    – see the following example – and (almost always) a faithful reflection of what
    is stored in the PDF. In most cases, the format of the value string also gives
    a clue about the key type:'
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 一个字符串元组 (type, value)，其中 type 是以下之一的字符串：“xref”, “array”, “dict”, “int”, “float”,
    “null”, “bool”, “name”, “string” 或 “unknown”（不应该出现）。无论 “type” 如何，键的值 **总是** 格式化为字符串
    – 见下面的示例 – 并且（几乎总是）忠实地反映了存储在 PDF 中的内容。在大多数情况下，值字符串的格式也提供了有关键类型的线索：
- en: A “name” always starts with a “/” slash.
  id: totrans-554
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “name” 总是以 “/” 斜杠开头。
- en: An “xref” always ends with “ 0 R”.
  id: totrans-555
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “xref” 总是以 “ 0 R” 结尾。
- en: An “array” is always enclosed in “[…]” brackets.
  id: totrans-556
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “array” 总是用 “[…]” 括起来。
- en: A “dict” is always enclosed in “<<…>>” brackets.
  id: totrans-557
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “dict” 总是用 “<<…>>” 括起来。
- en: A “bool”, resp. “null” always equal either “true”, “false”, resp. “null”.
  id: totrans-558
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “bool”，“null” 始终等于 “true”，“false”，“null”。
- en: “float” and “int” are represented by their string format – and are thus not
    always distinguishable.
  id: totrans-559
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “float” 和 “int” 用它们的字符串格式表示 – 因此不总是可以区分。
- en: A “string” is converted to UTF-8 and may therefore deviate from what is stored
    in the PDF. For example, the PDF key “Author” may have a value of “<FEFF004A006F0072006A00200058002E0020004D0063004B00690065>”
    in the file, but the method will return `('string', 'Jorj X. McKie')`.
  id: totrans-560
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “string” 被转换为 UTF-8，因此可能与存储在 PDF 中的内容不同。例如，PDF 键 “Author” 可能在文件中具有值 “<FEFF004A006F0072006A00200058002E0020004D0063004B00690065>”，但该方法将返回
    `('string', 'Jorj X. McKie')`。
- en: '[PRE46]'
  id: totrans-561
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '[PRE47]'
  id: totrans-562
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: New in v1.18.7, changed in v 1.18.13
  id: totrans-563
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.18.7 新增，v 1.18.13 中更改
- en: 'Changed in v1.19.4: remove a key “physically” if set to “null”.'
  id: totrans-564
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.19.4 中更改：如果设置为 “null”，则“物理”删除一个键。
- en: 'PDF only: Set (add, update, delete) the value of a PDF key for the [`dictionary`](glossary.html#dictionary
    "dictionary") object given by its xref.'
  id: totrans-565
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限于 PDF：为其 xref 指定的 [`dictionary`](glossary.html#dictionary "dictionary") 对象的键设置（添加，更新，删除）其值。
- en: Caution
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'This is an expert function: if you do not know what you are doing, there is
    a high risk to render (parts of) the PDF unusable. Please do consult [Adobe PDF
    References](app3.html#adobemanual) about object specification formats (page 18)
    and the structure of special dictionary types like page objects.'
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个专家功能：如果您不知道自己在做什么，可能会导致（部分）PDF 无法使用。请参阅[Adobe PDF References](app3.html#adobemanual)，了解对象规范格式（第18页）和特殊字典类型（如页面对象）的结构。
- en: 'Parameters:'
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the [`xref`](glossary.html#xref "xref"). *Changed in v1.18.13:*
    To update the PDF trailer, specify -1.'
  id: totrans-569
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – [`xref`](glossary.html#xref "xref")。*在 v1.18.13 中更改：* 要更新
    PDF 尾页，指定 -1。'
- en: '**key** (*str*) – the desired PDF key (without leading “/”). Must not be empty.
    Any valid PDF key – whether already present in the object (which will be overwritten)
    – or new. It is possible to use PDF path notation like `"Resources/ExtGState"`
    – which sets the value for key `"/ExtGState"` as a sub-object of `"/Resources"`.'
  id: totrans-570
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**key** (*str*) – 所需的 PDF 键（无前导 “/”）。必须不为空。任何有效的 PDF 键 – 无论已存在于对象中（将被覆盖） –
    或新键。可以使用类似 `"Resources/ExtGState"` 的 PDF 路径表示法，这会将键 `"/ExtGState"` 的值设置为 `"/Resources"`
    的子对象。'
- en: '**value** (*str*) – the value for the key. It must be a non-empty string and,
    depending on the desired PDF object type, the following rules must be observed.
    There is some syntax checking, but **no type checking** and no checking if it
    makes sense PDF-wise, i.e. **no semantics checking**. Upper / lower case is important!'
  id: totrans-571
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**value** (*str*) – 键的值。必须是非空字符串，并且根据所需的 PDF 对象类型必须遵守以下规则。有一些语法检查，但 **没有类型检查**
    和 PDF 方面的 **语义检查**。大小写很重要！'
- en: '**xref** – must be provided as `"nnn 0 R"` with a valid [`xref`](glossary.html#xref
    "xref") number nnn of the PDF. The suffix “`0 R`” is required to be recognizable
    as an xref by PDF applications.'
  id: totrans-572
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** – 必须提供为 `"nnn 0 R"`，带有 PDF 的有效 [`xref`](glossary.html#xref "xref")
    编号 nnn。后缀 “`0 R`” 是 PDF 应用程序能够识别 xref 的必要标识符。'
- en: '**array** – a string like `"[a b c d e f]"`. The brackets are required. Array
    items must be separated by at least one space (not commas like in Python). An
    empty array `"[]"` is possible and *equivalent* to removing the key. Array items
    may be any PDF objects, like dictionaries, xrefs, other arrays, etc. Like in Python,
    array items may be of different types.'
  id: totrans-573
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**array** – 像`"[a b c d e f]"`这样的字符串。括号是必需的。数组项必须至少用一个空格分隔（不像Python中的逗号）。空数组`"[]"`是可能的，并且等效于移除该键。数组项可以是任何PDF对象，如字典、xrefs、其他数组等。与Python类似，数组项可以是不同类型的。'
- en: '**dict** – a string like `"<< ... >>"`. The brackets are required and must
    enclose a valid PDF dictionary definition. The empty dictionary `"<<>>"` is possible
    and *equivalent* to removing the key.'
  id: totrans-574
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**dict** – 像`"<< ... >>"`这样的字符串。括号是必需的，必须包含有效的PDF字典定义。空字典`"<<>>"`是可能的，并且等效于移除该键。'
- en: '**int** – an integer formatted **as a string**.'
  id: totrans-575
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**int** – 作为字符串格式化的整数。'
- en: '**float** – a float formatted **as a string**. Scientific notation (with exponents)
    is **not allowed by PDF**.'
  id: totrans-576
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**float** – 作为字符串格式化的浮点数。PDF不允许使用科学计数法（带有指数）。'
- en: '**null** – the string `"null"`. This is the PDF equivalent to Python’s `None`
    and causes the key to be ignored – however not necessarily removed, resp. removed
    on saves with garbage collection. *Changed in v1.19.4:* If the key is no path
    hierarchy (i.e. contains no slash “/”), then it will be completely removed.'
  id: totrans-577
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**null** – 字符串`"null"`。这是PDF中类似于Python的`None`，会导致键被忽略 – 不过不一定在保存时移除，或在垃圾收集时移除。*在v1.19.4中更改：*如果键不是路径层次结构（即不包含斜杠“/”），则将完全删除该键。'
- en: '**bool** – one of the strings `"true"` or `"false"`.'
  id: totrans-578
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**bool** – 字符串之一`"true"`或`"false"`。'
- en: '**name** – a valid PDF name with a leading slash like this: `"/PageLayout"`.
    See page 16 of the [Adobe PDF References](app3.html#adobemanual).'
  id: totrans-579
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name** – 带有前导斜杠的有效PDF名称，例如`"/PageLayout"`。参见[Adobe PDF参考手册](app3.html#adobemanual)第16页。'
- en: '**string** – a valid PDF string. **All PDF strings must be enclosed by brackets**.
    Denote the empty string as `"()"`. Depending on its content, the possible brackets
    are'
  id: totrans-580
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**string** – 有效的PDF字符串。**所有PDF字符串必须用括号括起来**。空字符串表示为`"()"`。根据其内容，可能的括号是'
- en: '“(…)” for ASCII-only text. Reserved PDF characters must be backslash-escaped
    and non-ASCII characters must be provided as 3-digit backslash-escaped octals
    – including leading zeros. Example: 12 = 0x0C must be encoded as `014`.'
  id: totrans-581
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “(…)”用于仅ASCII文本。保留的PDF字符必须反斜杠转义，非ASCII字符必须作为3位数字反斜杠转义的八进制提供 – 包括前导零。例如：12 =
    0x0C必须编码为`014`。
- en: “<…>” for hex-encoded text. Every character must be represented by two hex-digits
    (lower or upper case).
  id: totrans-582
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “<…>”用于十六进制编码的文本。每个字符必须由两个十六进制数字（大小写不限）表示。
- en: 'If in doubt, we **strongly recommend** to use [`get_pdf_str()`](functions.html#get_pdf_str
    "get_pdf_str")! This function automatically generates the right brackets, escapes,
    and overall format. It will for example do conversions like these:'
  id: totrans-583
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果有疑问，我们**强烈建议**使用[`get_pdf_str()`](functions.html#get_pdf_str "get_pdf_str")！该函数会自动生成正确的括号、转义和整体格式。例如，它将执行如下转换：
- en: '[PRE48]'
  id: totrans-584
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '[PRE49]'
  id: totrans-585
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Creates a pixmap from page *pno* (zero-based). Invokes [`Page.get_pixmap()`](page.html#Page.get_pixmap
    "Page.get_pixmap").
  id: totrans-586
  prefs: []
  type: TYPE_NORMAL
  zh: 从第*pno*页（从零开始）创建一个位图。调用[`Page.get_pixmap()`](page.html#Page.get_pixmap "Page.get_pixmap")。
- en: All parameters except `pno` are *keyword-only.*
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
  zh: 除了`pno`之外的所有参数都是*仅限关键字*的。
- en: 'Parameters:'
  id: totrans-588
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – page number, 0-based in `-∞ < pno < page_count`.'
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 页面编号，在`-∞ < pno < page_count`中为基于零的。'
- en: 'Return type:'
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: '[Pixmap](pixmap.html#pixmap)'
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: '[Pixmap](pixmap.html#pixmap)'
- en: '[PRE50]'
  id: totrans-592
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: New in v1.16.13
  id: totrans-593
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.16.13中的新功能
- en: Changed in v1.18.11
  id: totrans-594
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在v1.18.11中更改
- en: 'PDF only: Return a list of all XObjects referenced by a page.'
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：返回页面引用的所有XObject的列表。
- en: 'Parameters:'
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – page number, 0-based, `-∞ < pno < page_count`.'
  id: totrans-597
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 页面编号，从0开始，`-∞ < pno < page_count`。'
- en: 'Return type:'
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: list
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
  zh: 列表
- en: 'Returns:'
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a list of (non-image) XObjects. These objects typically represent pages *embedded*
    (not copied) from other PDFs. For example, [`Page.show_pdf_page()`](page.html#Page.show_pdf_page
    "Page.show_pdf_page") will create this type of object. An item of this list has
    the following layout: `(xref, name, invoker, bbox)`, where'
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: 一个（非图像）XObject列表。这些对象通常代表从其他PDF文件*嵌入*（而不是复制）的页面。例如，[`Page.show_pdf_page()`](page.html#Page.show_pdf_page
    "Page.show_pdf_page")将创建这种类型的对象。列表中的每一项具有以下布局：`(xref, name, invoker, bbox)`，其中
- en: '**xref** (*int*) is the XObject’s [`xref`](glossary.html#xref "xref").'
  id: totrans-602
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) 是XObject的[`xref`](glossary.html#xref "xref")。'
- en: '**name** (*str*) is the symbolic name to reference the XObject.'
  id: totrans-603
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name** (*str*) 是用于引用XObject的符号名称。'
- en: '**invoker** (*int*) the [`xref`](glossary.html#xref "xref") of the invoking
    XObject or zero if the page directly invokes it.'
  id: totrans-604
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**invoker**（*int*）调用XObject的[`xref`](glossary.html#xref "xref")或如果页面直接调用它，则为零。'
- en: '**bbox** ([Rect](rect.html#rect)) the boundary box of the XObject’s location
    on the page **in untransformed coordinates**. To get actual, non-rotated page
    coordinates, multiply with the page’s transformation matrix [`Page.transformation_matrix`](page.html#Page.transformation_matrix
    "Page.transformation_matrix"). *Changed in v.18.11:* the bbox is now formatted
    as [Rect](rect.html#rect).'
  id: totrans-605
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**bbox**（[Rect](rect.html#rect)）XObject在页面上未转换坐标中的边界框。要获取实际的非旋转页面坐标，请与页面的变换矩阵[`Page.transformation_matrix`](page.html#Page.transformation_matrix
    "Page.transformation_matrix")相乘。*在v.18.11中更改：*bbox现在格式为[Rect](rect.html#rect)。'
- en: '[PRE51]'
  id: totrans-606
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'PDF only: Return a list of all images (directly or indirectly) referenced by
    the page.'
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：返回页面直接或间接引用的所有图像列表。
- en: 'Parameters:'
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – page number, 0-based, `-∞ < pno < page_count`.'
  id: totrans-609
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno**（*int*） - 页面编号，从0开始，`-∞ < pno < page_count`。'
- en: '**full** (*bool*) – whether to also include the referencer’s [`xref`](glossary.html#xref
    "xref") (which is zero if this is the page).'
  id: totrans-610
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**full**（*bool*） - 是否还包括引用者的[`xref`](glossary.html#xref "xref")（如果这是页面，则为零）。'
- en: 'Return type:'
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: list
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: 列表
- en: 'Returns:'
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a list of images **referenced** by this page. Each item looks like
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: 由此页面引用的图像列表。每个项看起来像
- en: '`(xref, smask, width, height, bpc, colorspace, alt. colorspace, name, filter,
    referencer)`'
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
  zh: '`(xref, smask, width, height, bpc, colorspace, alt. colorspace, name, filter,
    referencer)`'
- en: Where
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: 在哪里
- en: '**xref** (*int*) is the image object number'
  id: totrans-617
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref**（*int*）是图像对象编号。'
- en: ''
  id: totrans-618
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-619
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**smask** (*int*) is the object number of its soft-mask image'
  id: totrans-620
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**smask**（*int*）是其软蒙版图像的对象编号。'
- en: ''
  id: totrans-621
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-622
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**width** and **height** (*ints*) are the image dimensions'
  id: totrans-623
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**width**和**height**（*ints*）是图像的尺寸。'
- en: ''
  id: totrans-624
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-625
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**bpc** (*int*) denotes the number of bits per component (normally 8)'
  id: totrans-626
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**bpc**（*int*）表示每个组件的位数（通常为8）。'
- en: ''
  id: totrans-627
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-628
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**colorspace** (*str*) a string naming the colorspace (like **DeviceRGB**)'
  id: totrans-629
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**colorspace**（*str*）是命名颜色空间的字符串（例如**DeviceRGB**）。'
- en: ''
  id: totrans-630
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-631
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**alt. colorspace** (*str*) is any alternate colorspace depending on the value
    of **colorspace**'
  id: totrans-632
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**alt. colorspace**（*str*）是依赖于**colorspace**值的任何备选颜色空间。'
- en: ''
  id: totrans-633
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-634
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**name** (*str*) is the symbolic name by which the image is referenced'
  id: totrans-635
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name**（*str*）是引用图像的符号名称。'
- en: ''
  id: totrans-636
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-637
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**filter** (*str*) is the decode filter of the image ([Adobe PDF References](app3.html#adobemanual),
    pp. 22).'
  id: totrans-638
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filter**（*str*）是图像的解码滤波器（[Adobe PDF References](app3.html#adobemanual)，第22页）。'
- en: ''
  id: totrans-639
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-640
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**referencer** (*int*) the [`xref`](glossary.html#xref "xref") of the referencer.
    Zero if directly referenced by the page. Only present if *full=True*.'
  id: totrans-641
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**referencer**（*int*）引用者的[`xref`](glossary.html#xref "xref")。如果直接由页面引用，则为零。仅在*full=True*时存在。'
- en: Note
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: In general, this is not the list of images that are **actually displayed**.
    This method only parses several PDF objects to collect references to embedded
    images. It does not analyse the page’s [`contents`](glossary.html#contents "contents"),
    where all the actual image display commands are defined. To get this information,
    please use [`Page.get_image_info()`](page.html#Page.get_image_info "Page.get_image_info").
    Also have a look at the discussion in section [Structure of Dictionary Outputs](textpage.html#textpagedict).
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: 一般而言，这不是**实际显示的图像列表**。此方法仅解析几个PDF对象以收集对嵌入图像的引用。它不分析页面的[`contents`](glossary.html#contents
    "contents")，其中定义了所有实际图像显示命令。要获取此信息，请使用[`Page.get_image_info()`](page.html#Page.get_image_info
    "Page.get_image_info")。还请参阅[textpage.html#textpagedict](textpage.html#textpagedict)部分中的字典输出结构讨论。
- en: '[PRE52]'
  id: totrans-644
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'PDF only: Return a list of all fonts (directly or indirectly) referenced by
    the page.'
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：返回页面直接或间接引用的所有字体列表。
- en: 'Parameters:'
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – page number, 0-based, `-∞ < pno < page_count`.'
  id: totrans-647
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno**（*int*） - 页面编号，从0开始，`-∞ < pno < page_count`。'
- en: '**full** (*bool*) – whether to also include the referencer’s [`xref`](glossary.html#xref
    "xref"). If *True*, the returned items are one entry longer. Use this option if
    you need to know, whether the page directly references the font. In this case
    the last entry is 0\. If the font is referenced by an `/XObject` of the page,
    you will find its [`xref`](glossary.html#xref "xref") here.'
  id: totrans-648
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**full**（*bool*） - 是否还包括引用者的[`xref`](glossary.html#xref "xref")。如果*True*，返回的条目将再多一个条目。如果需要知道页面是否直接引用字体，请使用此选项。在这种情况下，最后一个条目为0。如果字体由页面的/XObject引用，则在这里找到其[`xref`](glossary.html#xref
    "xref")。'
- en: 'Return type:'
  id: totrans-649
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: list
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
  zh: 列表
- en: 'Returns:'
  id: totrans-651
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a list of fonts referenced by this page. Each entry looks like
  id: totrans-652
  prefs: []
  type: TYPE_NORMAL
  zh: 由此页面引用的字体列表。每个条目看起来像
- en: '**(xref, ext, type, basefont, name, encoding, referencer)**,'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: '**(xref, ext, type, basefont, name, encoding, referencer)**，'
- en: where
  id: totrans-654
  prefs: []
  type: TYPE_NORMAL
  zh: 在哪里
- en: '**xref** (*int*) is the font object number (may be zero if the PDF uses one
    of the builtin fonts directly)'
  id: totrans-655
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) 是字体对象号码（如果PDF直接使用内置字体，则可能为零）'
- en: ''
  id: totrans-656
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-657
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**ext** (*str*) font file extension (e.g. “ttf”, see [Font File Extensions](vars.html#fontextensions))'
  id: totrans-658
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ext** (*str*) 字体文件扩展名（例如“ttf”，参见[Font File Extensions](vars.html#fontextensions)）'
- en: ''
  id: totrans-659
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-660
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**type** (*str*) is the font type (like “Type1” or “TrueType” etc.)'
  id: totrans-661
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**type** (*str*) 是字体类型（如“Type1”或“TrueType”等）'
- en: ''
  id: totrans-662
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-663
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**basefont** (*str*) is the base font name,'
  id: totrans-664
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**basefont** (*str*) 是基础字体名称，'
- en: ''
  id: totrans-665
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-666
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**name** (*str*) is the symbolic name, by which the font is referenced'
  id: totrans-667
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name** (*str*) 是字体的符号名称，用于引用'
- en: ''
  id: totrans-668
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-669
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**encoding** (*str*) the font’s character encoding if different from its built-in
    encoding ([Adobe PDF References](app3.html#adobemanual), p. 254):'
  id: totrans-670
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**encoding** (*str*) - 如果与内置编码不同，字体的字符编码（[Adobe PDF References](app3.html#adobemanual)，第254页）：'
- en: ''
  id: totrans-671
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-672
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**referencer** (*int* optional) the [`xref`](glossary.html#xref "xref") of
    the referencer. Zero if directly referenced by the page, otherwise the xref of
    an XObject. Only present if *full=True*.'
  id: totrans-673
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**referencer** (*int* 可选) 引用者的 [`xref`](glossary.html#xref "xref")。如果页面直接引用，则为零；否则为XObject的xref。仅在*full=True*时出现。'
- en: 'Example:'
  id: totrans-674
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE53]'
  id: totrans-675
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Note
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'This list has no duplicate entries: the combination of [`xref`](glossary.html#xref
    "xref"), *name* and *referencer* is unique.'
  id: totrans-677
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此列表没有重复条目：[`xref`](glossary.html#xref "xref")、*name* 和 *referencer* 的组合是唯一的。
- en: In general, this is a superset of the fonts actually in use by this page. The
    PDF creator may e.g. have specified some global list, of which each page only
    makes partial use.
  id: totrans-678
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一般来说，这是实际页面使用的字体的超集。例如，PDF创建者可能已指定一些全局列表，每个页面只使用部分内容。
- en: '[PRE54]'
  id: totrans-679
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: Extracts the text of a page given its page number *pno* (zero-based). Invokes
    [`Page.get_text()`](page.html#Page.get_text "Page.get_text").
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: 提取给定页码（从零开始）*pno* 的页面文本。调用 [`Page.get_text()`](page.html#Page.get_text "Page.get_text")。
- en: 'Parameters:'
  id: totrans-681
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – page number, 0-based, any value `-∞ < pno < page_count`.'
  id: totrans-682
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 页面号码，从零开始，任何值 `-∞ < pno < page_count`。'
- en: For other parameter refer to the page method.
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: 对于其他参数，请参阅页面方法。
- en: 'Return type:'
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: str
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: str
- en: '[PRE55]'
  id: totrans-686
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Re-paginate (“reflow”) the document based on the given page dimension and fontsize.
    This only affects some document types like e-books and HTML. Ignored if not supported.
    Supported documents have *True* in property [`is_reflowable`](#Document.is_reflowable
    "Document.is_reflowable").
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: 根据给定的页面尺寸和字体大小重新分页（“重排”）文档。这仅影响某些文档类型，如电子书和HTML。如果不支持，则忽略。支持的文档在属性[`is_reflowable`](#Document.is_reflowable
    "Document.is_reflowable")中有*True*。
- en: 'Parameters:'
  id: totrans-688
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**rect** (*rect_like*) – desired page size. Must be finite, not empty and start
    at point (0, 0).'
  id: totrans-689
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**rect** (*rect_like*) – 所需的页面尺寸。必须是有限的，不为空，并从点 (0, 0) 开始。'
- en: '**width** (*float*) – use it together with *height* as alternative to *rect*.'
  id: totrans-690
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**width** (*float*) – 与 *height* 一起使用，作为 *rect* 的替代。'
- en: '**height** (*float*) – use it together with *width* as alternative to *rect*.'
  id: totrans-691
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**height** (*float*) – 与 *width* 一起使用，作为 *rect* 的替代。'
- en: '**fontsize** (*float*) – the desired default fontsize.'
  id: totrans-692
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**fontsize** (*float*) – 所需的默认字体大小。'
- en: '[PRE56]'
  id: totrans-693
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'PDF only: Keeps only those pages of the document whose numbers occur in the
    list. Empty sequences or elements outside `range(doc.page_count)` will cause a
    *ValueError*. For more details see remarks at the bottom or this chapter.'
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：保留文档中指定页码的页面。空序列或超出 `range(doc.page_count)` 范围的元素将引发 *ValueError*。更多详细信息请参见本章末尾或本章说明。
- en: 'Parameters:'
  id: totrans-695
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**s** (*sequence*) – The sequence (see [Using Python Sequences as Arguments
    in PyMuPDF](app3.html#sequencetypes)) of page numbers (zero-based) to be included.
    Pages not in the sequence will be deleted (from memory) and become unavailable
    until the document is reopened. **Page numbers can occur multiple times and in
    any order:** the resulting document will reflect the sequence exactly as specified.'
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: '**s** (*sequence*) – 页面号码序列（从零开始），要包含的页面。不在序列中的页面将被删除（从内存中），并在文档重新打开之前不可用。**页面号码可以多次出现且顺序任意：**生成的文档将完全按指定的序列排列。'
- en: Note
  id: totrans-697
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Page numbers in the sequence need not be unique nor be in any particular order.
    This makes the method a versatile utility to e.g. select only the even or the
    odd pages or meeting some other criteria and so forth.
  id: totrans-698
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 序列中的页面号码不需要唯一，也不需要特定顺序。这使得该方法成为一个多功能实用工具，例如仅选择偶数页或奇数页，或满足其他某些条件等。
- en: On a technical level, the method will always create a new [`pagetree`](glossary.html#pagetree
    "pagetree").
  id: totrans-699
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在技术层面上，该方法始终会创建一个新的 [`pagetree`](glossary.html#pagetree "pagetree")。
- en: When dealing with only a few pages, methods [`copy_page()`](#Document.copy_page
    "Document.copy_page"), [`move_page()`](#Document.move_page "Document.move_page"),
    [`delete_page()`](#Document.delete_page "Document.delete_page") are easier to
    use. In fact, they are also **much faster** – by at least one order of magnitude
    when the document has many pages.
  id: totrans-700
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当处理少量页面时，方法 [`copy_page()`](#Document.copy_page "Document.copy_page")、[`move_page()`](#Document.move_page
    "Document.move_page")、[`delete_page()`](#Document.delete_page "Document.delete_page")
    更易于使用。事实上，它们也**快得多**-当文档有许多页面时，至少快一个数量级。
- en: '[PRE57]'
  id: totrans-701
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'PDF only: Sets or updates the metadata of the document as specified in *m*,
    a Python dictionary.'
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：根据 *m* 中指定的内容设置或更新文档的元数据，一个 Python 字典。
- en: 'Parameters:'
  id: totrans-703
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**m** (*dict*) – A dictionary with the same keys as *metadata* (see below).
    All keys are optional. A PDF’s format and encryption method cannot be set or changed
    and will be ignored. If any value should not contain data, do not specify its
    key or set the value to `None`. If you use *{}* all metadata information will
    be cleared to the string *“none”*. If you want to selectively change only some
    values, modify a copy of *doc.metadata* and use it as the argument. Arbitrary
    unicode values are possible if specified as UTF-8-encoded.'
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: '**m** (*dict*) – 与 *metadata*（见下文）具有相同键的字典。所有键都是可选的。PDF 的格式和加密方法无法设置或更改，将被忽略。如果任何值不应包含数据，请不要指定其键或将值设置为
    `None`。如果您使用 *{}*，所有元数据信息将被清除为字符串 *“none”*。如果您只想选择性地更改一些值，请修改 *doc.metadata* 的副本并将其用作参数。如果指定为
    UTF-8 编码，可能会出现任意的 Unicode 值。'
- en: '*(Changed in v1.18.4)* Empty values or “none” are no longer written, but completely
    omitted.'
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: '*(在 v1.18.4 中更改)* 空值或“none”不再被写入，而是完全被省略。'
- en: '[PRE58]'
  id: totrans-706
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'PDF only: Get the document XML metadata.'
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：获取文档的 XML 元数据。
- en: 'Return type:'
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: str
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: str
- en: 'Returns:'
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: XML metadata of the document. Empty string if not present or not a PDF.
  id: totrans-711
  prefs: []
  type: TYPE_NORMAL
  zh: 文档的 XML 元数据。如果不存在或不是 PDF，则为空字符串。
- en: '[PRE59]'
  id: totrans-712
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'PDF only: Sets or updates XML metadata of the document.'
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：设置或更新文档的 XML 元数据。
- en: 'Parameters:'
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xml** (*str*) – the new XML metadata. Should be XML syntax, however no checking
    is done by this method and any string is accepted.'
  id: totrans-715
  prefs: []
  type: TYPE_NORMAL
  zh: '**xml** (*str*) – 新的 XML 元数据。应该是 XML 语法，但此方法不进行任何检查，接受任何字符串。'
- en: '[PRE60]'
  id: totrans-716
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: New in v1.22.2
  id: totrans-717
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.2 中的新功能
- en: 'PDF only: Set the `/PageLayout`.'
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：设置 `/PageLayout`。
- en: 'Parameters:'
  id: totrans-719
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**value** (*str*) – one of the strings “SinglePage”, “OneColumn”, “TwoColumnLeft”,
    “TwoColumnRight”, “TwoPageLeft”, “TwoPageRight”. Lower case is supported.'
  id: totrans-720
  prefs: []
  type: TYPE_NORMAL
  zh: '**value** (*str*) – 字符串之一“SinglePage”，“OneColumn”，“TwoColumnLeft”，“TwoColumnRight”，“TwoPageLeft”，“TwoPageRight”。支持小写。'
- en: '[PRE61]'
  id: totrans-721
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: New in v1.22.2
  id: totrans-722
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.2 中的新功能
- en: 'PDF only: Set the `/PageMode`.'
  id: totrans-723
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：设置 `/PageMode`。
- en: 'Parameters:'
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**value** (*str*) – one of the strings “UseNone”, “UseOutlines”, “UseThumbs”,
    “FullScreen”, “UseOC”, “UseAttachments”. Lower case is supported.'
  id: totrans-725
  prefs: []
  type: TYPE_NORMAL
  zh: '**value** (*str*) – 字符串之一“UseNone”，“UseOutlines”，“UseThumbs”，“FullScreen”，“UseOC”，“UseAttachments”。支持小写。'
- en: '[PRE62]'
  id: totrans-726
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: New in v1.22.2
  id: totrans-727
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.2 中的新功能
- en: 'PDF only: Set the `/MarkInfo` values.'
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：设置 `/MarkInfo` 值。
- en: 'Parameters:'
  id: totrans-729
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**value** (*dict*) – a dictionary like this one: `{"Marked": False, "UserProperties":
    False, "Suspects": False}`. This dictionary contains information about the usage
    of Tagged PDF conventions. For details please see the [PDF specifications](https://opensource.adobe.com/dc-acrobat-sdk-docs/standards/pdfstandards/pdf/PDF32000_2008.pdf).'
  id: totrans-730
  prefs: []
  type: TYPE_NORMAL
  zh: '**value** (*dict*) – 一个像这样的字典：`{"Marked": False, "UserProperties": False, "Suspects":
    False}`。该字典包含有关标记 PDF 约定使用情况的信息。详情请参阅 [PDF 规范](https://opensource.adobe.com/dc-acrobat-sdk-docs/standards/pdfstandards/pdf/PDF32000_2008.pdf)。'
- en: '[PRE63]'
  id: totrans-731
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'PDF only: Replaces the **complete current outline** tree (table of contents)
    with the one provided as the argument. After successful execution, the new outline
    tree can be accessed as usual via [`Document.get_toc()`](#Document.get_toc "Document.get_toc")
    or via [`Document.outline`](#Document.outline "Document.outline"). Like with other
    output-oriented methods, changes become permanent only via [`save()`](#Document.save
    "Document.save") (incremental save supported). Internally, this method consists
    of the following two steps. For a demonstration see example below.'
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：用提供的参数替换**完整的当前大纲**树（目录）。执行成功后，可以像往常一样通过 [`Document.get_toc()`](#Document.get_toc
    "Document.get_toc") 或通过 [`Document.outline`](#Document.outline "Document.outline")
    访问新的大纲树。与其他面向输出的方法一样，只有通过 [`save()`](#Document.save "Document.save")（支持增量保存）更改才会变得永久。在内部，该方法由以下两个步骤组成。有关演示，请参见下面的示例。
- en: Step 1 deletes all existing bookmarks.
  id: totrans-733
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一步删除所有现有的书签。
- en: Step 2 creates a new TOC from the entries contained in *toc*.
  id: totrans-734
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二步从 *toc* 中包含的条目创建新的目录。
- en: 'Parameters:'
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**toc** (*sequence*) –'
  id: totrans-736
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**toc** (*sequence*) –'
- en: A list / tuple with **all bookmark entries** that should form the new table
    of contents. Output variants of [`get_toc()`](#Document.get_toc "Document.get_toc")
    are acceptable. To completely remove the table of contents specify an empty sequence
    or None. Each item must be a list with the following format.
  id: totrans-737
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 包含**所有书签条目**的列表/元组，这些条目应形成新的目录。[`get_toc()`](#Document.get_toc "Document.get_toc")的输出变体是可接受的。要完全删除目录，请指定一个空序列或None。每个项目必须是具有以下格式的列表。
- en: '[lvl, title, page [, dest]] where'
  id: totrans-738
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[lvl, title, page [, dest]]，其中'
- en: '**lvl** is the hierarchy level (int > 0) of the item, which **must be 1** for
    the first item and at most 1 larger than the previous one.'
  id: totrans-739
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**lvl**是项目的层次级别（int > 0），第一个项目必须为1，且最多比前一个项目大1。'
- en: '**title** (str) is the title to be displayed. It is assumed to be UTF-8-encoded
    (relevant for multibyte code points only).'
  id: totrans-740
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**title**（str）是要显示的标题。假定其为UTF-8编码（仅适用于多字节代码点）。'
- en: '**page** (int) is the target page number **(attention: 1-based)**. Must be
    in valid range if positive. Set it to -1 if there is no target, or the target
    is external.'
  id: totrans-741
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**page**（int）是目标页码 **（注意：基于1）**。如果为正数，必须在有效范围内。如果没有目标或目标是外部的，请将其设置为-1。'
- en: '**dest** (optional) is a dictionary or a number. If a number, it will be interpreted
    as the desired height (in points) this entry should point to on the page. Use
    a dictionary (like the one given as output by `get_toc(False)`) for a detailed
    control of the bookmark’s properties, see [`Document.get_toc()`](#Document.get_toc
    "Document.get_toc") for a description.'
  id: totrans-742
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**dest**（可选）是一个字典或一个数字。如果是数字，它将被解释为页面上此条目应指向的期望高度（以点为单位）。使用字典（例如由`get_toc(False)`输出的字典）可以详细控制书签的属性，请参阅[`Document.get_toc()`](#Document.get_toc
    "Document.get_toc")进行描述。'
- en: '**collapse** (*int*) – *(new in v1.16.9)* controls the hierarchy level beyond
    which outline entries should initially show up collapsed. The default 1 will hence
    only display level 1, higher levels must be unfolded using the PDF viewer. To
    unfold everything, specify either a large integer, 0 or None.'
  id: totrans-743
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**collapse**（*int*） - （新于v1.16.9）控制超出哪个层次级别的大纲条目应最初显示折叠。默认为1，因此仅显示级别1，必须使用PDF查看器展开更高级别。要展开所有内容，请指定较大的整数，0或None。'
- en: 'Return type:'
  id: totrans-744
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-745
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-746
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the number of inserted, resp. deleted items.
  id: totrans-747
  prefs: []
  type: TYPE_NORMAL
  zh: 插入或删除的项目数。
- en: 'Changed in v1.23.8: Destination ‘to’ coordinates should now be in the same
    coordinate system as those returned by [`get_toc()`](#Document.get_toc "Document.get_toc")
    (internally they are now transformed with `page.cropbox` and `page.rotation_matrix`).
    So for example `set_toc(get_toc())` now gives unchanged destination ‘to’ coordinates.'
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: 从v1.23.8开始更改：目标“to”坐标现在应与[`get_toc()`](#Document.get_toc "Document.get_toc")返回的坐标系相同（内部它们现在使用`page.cropbox`和`page.rotation_matrix`进行转换）。例如，`set_toc(get_toc())`现在给出未更改的目标“to”坐标。
- en: '[PRE64]'
  id: totrans-749
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: New in v1.17.7
  id: totrans-750
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从v1.17.7开始新增
- en: 'PDF only: Return the [`xref`](glossary.html#xref "xref") of the outline item.
    This is mainly used for internal purposes.'
  id: totrans-751
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：返回大纲项的[`xref`](glossary.html#xref "xref")。这主要用于内部目的。
- en: 'arg int idx: index of the item in list [`Document.get_toc()`](#Document.get_toc
    "Document.get_toc").'
  id: totrans-752
  prefs: []
  type: TYPE_NORMAL
  zh: 参数int idx：列表[`Document.get_toc()`](#Document.get_toc "Document.get_toc")中项目的索引。
- en: 'Returns:'
  id: totrans-753
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '[`xref`](glossary.html#xref "xref").'
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: '[`xref`](glossary.html#xref "xref")。'
- en: '[PRE65]'
  id: totrans-755
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: New in v1.17.7
  id: totrans-756
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从v1.17.7开始新增
- en: 'Changed in v1.18.14: no longer remove the item’s text, but show it grayed-out.'
  id: totrans-757
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从v1.18.14开始更改：不再删除项目的文本，而是显示为灰色。
- en: 'PDF only: Remove this TOC item. This is a high-speed method, which **disables**
    the respective item, but leaves the overall TOC structure intact. Physically,
    the item still exists in the TOC tree, but is shown grayed-out and will no longer
    point to any destination.'
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：删除此TOC项。这是一种高速方法，**禁用**了相应的项目，但保留了整体的TOC结构。在物理上，项目仍然存在于TOC树中，但以灰色显示，并且不再指向任何目标。
- en: This also implies that you can reassign the item to a new destination using
    [`Document.set_toc_item()`](#Document.set_toc_item "Document.set_toc_item"), when
    required.
  id: totrans-759
  prefs: []
  type: TYPE_NORMAL
  zh: 这也意味着，当需要时，您可以使用[`Document.set_toc_item()`](#Document.set_toc_item "Document.set_toc_item")重新分配项目到新的目标。
- en: 'Parameters:'
  id: totrans-760
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**idx** (*int*) – the index of the item in list [`Document.get_toc()`](#Document.get_toc
    "Document.get_toc").'
  id: totrans-761
  prefs: []
  type: TYPE_NORMAL
  zh: '**idx**（*int*） - 列表[`Document.get_toc()`](#Document.get_toc "Document.get_toc")中项目的索引。'
- en: '[PRE66]'
  id: totrans-762
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: New in v1.17.7
  id: totrans-763
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从v1.17.7开始新增
- en: Changed in v1.18.6
  id: totrans-764
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从v1.18.6开始更改
- en: 'PDF only: Changes the TOC item identified by its index. Change the item **title**,
    **destination**, **appearance** (color, bold, italic) or collapsing sub-items
    – or to remove the item altogether.'
  id: totrans-765
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：更改由其索引标识的TOC条目。更改条目的**标题**、**目标**、**外观**（颜色、粗体、斜体）或折叠子项，或者完全删除该项。
- en: Use this method if you need specific changes for selected entries only and want
    to avoid replacing the complete TOC. This is beneficial especially when dealing
    with large table of contents.
  id: totrans-766
  prefs: []
  type: TYPE_NORMAL
  zh: 如果仅需要对选定条目进行特定更改并且想避免替换完整的TOC，则使用此方法。在处理大型目录时尤其有益。
- en: 'Parameters:'
  id: totrans-767
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**idx** (*int*) – the index of the entry in the list created by [`Document.get_toc()`](#Document.get_toc
    "Document.get_toc").'
  id: totrans-768
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**idx** (*int*) – 由[`Document.get_toc()`](#Document.get_toc "Document.get_toc")创建的列表中条目的索引。'
- en: '**dest_dict** (*dict*) – the new destination. A dictionary like the last entry
    of an item in `doc.get_toc(False)`. Using this as a template is recommended. When
    given, **all other parameters are ignored** – except title.'
  id: totrans-769
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**dest_dict** (*dict*) – 新的目标。类似于`doc.get_toc(False)`中条目的最后一个条目的字典。建议使用此作为模板。如果给出，则**忽略所有其他参数**
    – 除了标题。'
- en: '**kind** (*int*) – the link kind, see [Link Destination Kinds](vars.html#linkdest-kinds).
    If [`LINK_NONE`](vars.html#LINK_NONE "LINK_NONE"), then all remaining parameter
    will be ignored, and the TOC item will be removed – same as [`Document.del_toc_item()`](#Document.del_toc_item
    "Document.del_toc_item"). If None, then only the title is modified and the remaining
    parameters are ignored. All other values will lead to making a new destination
    dictionary using the subsequent arguments.'
  id: totrans-770
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**kind** (*int*) – 链接种类，参见[链接目的地种类](vars.html#linkdest-kinds)。如果是[`LINK_NONE`](vars.html#LINK_NONE
    "LINK_NONE")，则所有剩余参数将被忽略，TOC条目将被删除，与[`Document.del_toc_item()`](#Document.del_toc_item
    "Document.del_toc_item")相同。如果为None，则仅修改标题，忽略其余参数。其他所有值都将使用后续参数创建新的目的地字典。'
- en: '**pno** (*int*) – the 1-based page number, i.e. a value 1 <= pno <= doc.page_count.
    Required for LINK_GOTO.'
  id: totrans-771
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 基于1的页码，即 1 <= pno <= doc.page_count。LINK_GOTO操作必需的参数。'
- en: '**uri** (*str*) – the URL text. Required for LINK_URI.'
  id: totrans-772
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**uri** (*str*) – URL文本。LINK_URI操作必需的参数。'
- en: '**title** (*str*) – the desired new title. None if no change.'
  id: totrans-773
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**title** (*str*) – 所需的新标题。如果不更改，则为None。'
- en: '**to** (*point_like*) – (optional) points to a coordinate on the target page.
    Relevant for LINK_GOTO. If omitted, a point near the page’s top is chosen.'
  id: totrans-774
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**to** (*point_like*) – （可选）指向目标页面上的坐标。对LINK_GOTO操作相关。如果省略，则选择靠近页面顶部的点。'
- en: '**filename** (*str*) – required for LINK_GOTOR and LINK_LAUNCH.'
  id: totrans-775
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filename** (*str*) – LINK_GOTOR和LINK_LAUNCH操作所需的文件名。'
- en: '**zoom** (*float*) – use this zoom factor when showing the target page.'
  id: totrans-776
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**zoom** (*float*) – 在显示目标页面时使用的缩放因子。'
- en: '**Example use:** Change the TOC of the SWIG manual to achieve this:'
  id: totrans-777
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例用法：** 更改SWIG手册的TOC以实现以下效果：'
- en: 'Collapse everything below top level and show the chapter on Python support
    in red, bold and italic:'
  id: totrans-778
  prefs: []
  type: TYPE_NORMAL
  zh: 折叠所有低于顶级的内容，并以红色、粗体和斜体显示Python支持章节：
- en: '[PRE67]'
  id: totrans-779
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: In the previous example, we have changed only 42 of the 1240 TOC items of the
    file.
  id: totrans-780
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的例子中，我们仅更改了文件中1240个TOC条目中的42个。
- en: '[PRE68]'
  id: totrans-781
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'PDF only: Convert annotations and / or widgets to become permanent parts of
    the pages. The PDF **will be changed** by this method. If [`widgets`](page.html#Page.widgets
    "Page.widgets") is `True`, the document will also no longer be a “Form PDF”.'
  id: totrans-782
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：将注释和/或小部件转换为页面的永久部分。通过这种方法，PDF将被**更改**。如果[`widgets`](page.html#Page.widgets
    "Page.widgets")为`True`，文档也将不再是“表单PDF”。
- en: All pages will look the same, but will no longer have annotations, respectively
    fields. The visible parts will be converted to standard text, vector graphics
    or images as required.
  id: totrans-783
  prefs: []
  type: TYPE_NORMAL
  zh: 所有页面看起来都一样，但将不再有注释或字段。可见部分将根据需要转换为标准文本、矢量图形或图像。
- en: The method may thus be a viable **alternative for PDF-to-PDF conversions** using
    [`Document.convert_to_pdf()`](#Document.convert_to_pdf "Document.convert_to_pdf").
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，通过使用[`Document.convert_to_pdf()`](#Document.convert_to_pdf "Document.convert_to_pdf")，这种方法可能是PDF到PDF转换的一个可行**替代方法**。
- en: Please consider that annotations are complex objects and may consist of more
    data “underneath” their visual appearance. Examples are “Text” and “FileAttachment”
    annotations. When “baking in” annotations / widgets with this method, all this
    underlying information (attached files, comments, associated PopUp annotations,
    etc.) will be lost and be removed on next garbage collection.
  id: totrans-785
  prefs: []
  type: TYPE_NORMAL
  zh: 请考虑注释是复杂对象，可能由更多“底层”数据组成。例如，“Text”和“FileAttachment”注释。使用此方法“烘烤”注释/小部件时，所有这些底层信息（附加文件、评论、相关弹出式注释等）将在下次垃圾收集时丢失并被删除。
- en: Use this feature for instance for methods [`Document.insert_pdf()`](#Document.insert_pdf
    "Document.insert_pdf") (which supports no copying of widgets) or [`Page.show_pdf_page()`](page.html#Page.show_pdf_page
    "Page.show_pdf_page") (which supports neither annotations nor widgets) when the
    source pages should look exactly the same in the target.
  id: totrans-786
  prefs: []
  type: TYPE_NORMAL
  zh: 比如，用于 [`Document.insert_pdf()`](#Document.insert_pdf "Document.insert_pdf")
    方法（不支持复制小部件）或 [`Page.show_pdf_page()`](page.html#Page.show_pdf_page "Page.show_pdf_page")
    方法（不支持注释和小部件），源页面在目标页面中应该完全一样时使用此功能。
- en: 'Parameters:'
  id: totrans-787
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**annots** (*bool*) – convert annotations.'
  id: totrans-788
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**annots** (*bool*) – 转换注释。'
- en: '**widgets** (*bool*) – convert fields / widgets. After execution, the document
    will no longer be a “Form PDF”.'
  id: totrans-789
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**widgets** (*bool*) – 转换字段 / 小部件。执行后，文档将不再是“表单 PDF”。'
- en: '[PRE69]'
  id: totrans-790
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: New in v1.16.0
  id: totrans-791
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.16.0 新增
- en: Check whether the document can be saved incrementally. Use it to choose the
    right option without encountering exceptions.
  id: totrans-792
  prefs: []
  type: TYPE_NORMAL
  zh: 检查文档是否可以增量保存。在选择正确选项时使用，避免遇到异常。
- en: '[PRE70]'
  id: totrans-793
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: New in v1.16.14
  id: totrans-794
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.16.14 新增
- en: 'PDF only: Remove potentially sensitive data from the PDF. This function is
    inspired by the similar “Sanitize” function in Adobe Acrobat products. The process
    is configurable by a number of options.'
  id: totrans-795
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于 PDF：从 PDF 中删除潜在敏感数据。此功能受 Adobe Acrobat 产品中类似“Sanitize”功能的启发。该过程可通过多个选项进行配置。
- en: 'Parameters:'
  id: totrans-796
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**attached_files** (*bool*) – Search for ‘FileAttachment’ annotations and remove
    the file content.'
  id: totrans-797
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**attached_files** (*bool*) – 查找“FileAttachment”注释并删除文件内容。'
- en: '**clean_pages** (*bool*) – Remove any comments from page painting sources.
    If this option is set to *False*, then this is also done for *hidden_text* and
    *redactions*.'
  id: totrans-798
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**clean_pages** (*bool*) – 从页面绘画源中删除任何注释。如果此选项设置为 *False*，那么对于 *hidden_text*
    和 *redactions* 也会执行相同操作。'
- en: '**embedded_files** (*bool*) – Remove embedded files.'
  id: totrans-799
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**embedded_files** (*bool*) – 删除嵌入文件。'
- en: '**hidden_text** (*bool*) – Remove OCRed text and invisible text [[7]](#f7).'
  id: totrans-800
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**hidden_text** (*bool*) – 删除 OCR 文本和不可见文本[[7]](#f7)。'
- en: '**javascript** (*bool*) – Remove JavaScript sources.'
  id: totrans-801
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**javascript** (*bool*) – 删除 JavaScript 源代码。'
- en: '**metadata** (*bool*) – Remove PDF standard metadata.'
  id: totrans-802
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**metadata** (*bool*) – 删除 PDF 标准元数据。'
- en: '**redactions** (*bool*) – Apply redaction annotations.'
  id: totrans-803
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**redactions** (*bool*) – 应用删除注释。'
- en: '**redact_images** (*int*) – how to handle images if applying redactions. One
    of 0 (ignore), 1 (blank out overlaps) or 2 (remove).'
  id: totrans-804
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**redact_images** (*int*) – 如果应用删除操作，处理图像的方法。可选值为 0（忽略）、1（覆盖重叠区域）或 2（删除）。'
- en: '**remove_links** (*bool*) – Remove all links.'
  id: totrans-805
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**remove_links** (*bool*) – 删除所有链接。'
- en: '**reset_fields** (*bool*) – Reset all form fields to their defaults.'
  id: totrans-806
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**reset_fields** (*bool*) – 将所有表单字段重置为默认值。'
- en: '**reset_responses** (*bool*) – Remove all responses from all annotations.'
  id: totrans-807
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**reset_responses** (*bool*) – 从所有注释中删除所有响应。'
- en: '**thumbnails** (*bool*) – Remove thumbnail images from pages.'
  id: totrans-808
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**thumbnails** (*bool*) – 从页面中删除缩略图图像。'
- en: '**xml_metadata** (*bool*) – Remove XML metadata.'
  id: totrans-809
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xml_metadata** (*bool*) – 删除 XML 元数据。'
- en: '[PRE71]'
  id: totrans-810
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: Changed in v1.18.7
  id: totrans-811
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.18.7 更改
- en: Changed in v1.19.0
  id: totrans-812
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.19.0 起更改
- en: Changed in v1.24.1
  id: totrans-813
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.24.1 更改
- en: 'PDF only: Saves the document in its **current state**.'
  id: totrans-814
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于 PDF：以当前状态保存文档。
- en: 'Parameters:'
  id: totrans-815
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**outfile** (*str**,**Path**,**fp*) – The file path, `pathlib.Path` or file
    object to save to. A file object must have been created before via `open(...)`
    or `io.BytesIO()`. Choosing `io.BytesIO()` is similar to [`Document.tobytes()`](#Document.tobytes
    "Document.tobytes") below, which equals the `getvalue()` output of an internally
    created `io.BytesIO()`.'
  id: totrans-816
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**outfile** (*str**,**Path**,**fp*) – 要保存到的文件路径、`pathlib.Path` 或文件对象。文件对象必须在之前通过
    `open(...)` 或 `io.BytesIO()` 创建。选择 `io.BytesIO()` 相当于 [`Document.tobytes()`](#Document.tobytes
    "Document.tobytes") 下的 `getvalue()` 输出，这相当于内部创建的 `io.BytesIO()` 的 `getvalue()`。'
- en: '**garbage** (*int*) –'
  id: totrans-817
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**garbage** (*int*) –'
- en: Do garbage collection. Positive values exclude “incremental”.
  id: totrans-818
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 进行垃圾回收。正值排除“增量”。
- en: 0 = none
  id: totrans-819
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 0 = 无
- en: 1 = remove unused (unreferenced) objects.
  id: totrans-820
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1 = 删除未使用（未引用）的对象。
- en: 2 = in addition to 1, compact the [`xref`](glossary.html#xref "xref") table.
  id: totrans-821
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2 = 除了1之外，压缩 [`xref`](glossary.html#xref "xref") 表。
- en: 3 = in addition to 2, merge duplicate objects.
  id: totrans-822
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3 = 除了2之外，合并重复的对象。
- en: 4 = in addition to 3, check [`stream`](glossary.html#stream "stream") objects
    for duplication. This may be slow because such data are typically large.
  id: totrans-823
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 4 = 除了3之外，检查 [`stream`](glossary.html#stream "stream") 对象是否重复。这可能很慢，因为这类数据通常很大。
- en: '**clean** (*bool*) – Clean and sanitize content streams [[1]](#f1). Corresponds
    to “mutool clean -sc”.'
  id: totrans-824
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**clean** (*bool*) – 清理和消毒内容流[[1]](#f1)。对应于“mutool clean -sc”。'
- en: '**deflate** (*bool*) – Deflate (compress) uncompressed streams.'
  id: totrans-825
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**deflate** (*bool*) – 压缩未压缩的流。'
- en: '**deflate_images** (*bool*) – *(new in v1.18.3)* Deflate (compress) uncompressed
    image streams [[4]](#f4).'
  id: totrans-826
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**deflate_images** (*bool*) – *(自 v1.18.3 新增)* 压缩未压缩的图像流。'
- en: '**deflate_fonts** (*bool*) – *(new in v1.18.3)* Deflate (compress) uncompressed
    fontfile streams [[4]](#f4).'
  id: totrans-827
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**deflate_fonts** (*bool*) – *(自 v1.18.3 新增)* 压缩未压缩的字体文件流。'
- en: '**incremental** (*bool*) – Only save changes to the PDF. Excludes “garbage”
    and “linear”. Can only be used if *outfile* is a string or a `pathlib.Path` and
    equal to [`Document.name`](#Document.name "Document.name"). Cannot be used for
    files that are decrypted or repaired and also in some other cases. To be sure,
    check [`Document.can_save_incrementally()`](#Document.can_save_incrementally "Document.can_save_incrementally").
    If this is false, saving to a new file is required.'
  id: totrans-828
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**incremental** (*bool*) – 仅保存PDF的更改。排除“垃圾”和“线性”。只能在*outfile*是字符串或`pathlib.Path`且等于[`Document.name`](#Document.name
    "Document.name")时使用。不能用于已解密或修复的文件以及其他一些情况。请确认 [`Document.can_save_incrementally()`](#Document.can_save_incrementally
    "Document.can_save_incrementally") 如果为假，则需要保存到新文件。'
- en: '**ascii** (*bool*) – convert binary data to ASCII.'
  id: totrans-829
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ascii** (*bool*) – 将二进制数据转换为ASCII。'
- en: '**expand** (*int*) –'
  id: totrans-830
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**expand** (*int*) –'
- en: Decompress objects. Generates versions that can be better read by some other
    programs and will lead to larger files.
  id: totrans-831
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 解压对象。生成可以被其他程序更好读取的版本，从而导致更大的文件。
- en: 0 = none
  id: totrans-832
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 0 = 无
- en: 1 = images
  id: totrans-833
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1 = 图像
- en: 2 = fonts
  id: totrans-834
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2 = 字体
- en: 255 = all
  id: totrans-835
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 255 = 全部
- en: '**linear** (*bool*) – Save a linearised version of the document. This option
    creates a file format for improved performance for Internet access. Excludes “incremental”.'
  id: totrans-836
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**linear** (*bool*) – 保存文档的线性化版本。此选项创建了一个针对Internet访问性能改进的文件格式。排除“增量”选项。'
- en: '**pretty** (*bool*) – Prettify the document source for better readability.
    PDF objects will be reformatted to look like the default output of [`Document.xref_object()`](#Document.xref_object
    "Document.xref_object").'
  id: totrans-837
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pretty** (*bool*) – 美化文档源以提高可读性。PDF对象将重新格式化，看起来像[`Document.xref_object()`](#Document.xref_object
    "Document.xref_object")的默认输出。'
- en: '**no_new_id** (*bool*) – Suppress the update of the file’s `/ID` field. If
    the file happens to have no such field at all, also suppress creation of a new
    one. Default is `False`, so every save will lead to an updated file identification.'
  id: totrans-838
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**no_new_id** (*bool*) – 抑制文件的`/ID`字段更新。如果文件根本没有此类字段，则还抑制创建新的字段。默认为`False`，因此每次保存都会导致文件标识的更新。'
- en: '**permissions** (*int*) – *(new in v1.16.0)* Set the desired permission levels.
    See [Document Permissions](vars.html#permissioncodes) for possible values. Default
    is granting all.'
  id: totrans-839
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**permissions** (*int*) – *(自 v1.16.0 新增)* 设置所需的权限级别。参见 [文档权限](vars.html#permissioncodes)
    获取可能的值。默认为授予全部权限。'
- en: '**encryption** (*int*) – *(new in v1.16.0)* set the desired encryption method.
    See [PDF encryption method codes](vars.html#encryptionmethods) for possible values.'
  id: totrans-840
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**encryption** (*int*) – *(自 v1.16.0 新增)* 设置所需的加密方法。参见 [PDF加密方法代码](vars.html#encryptionmethods)
    获取可能的值。'
- en: '**owner_pw** (*str*) – *(new in v1.16.0)* set the document’s owner password.
    *(Changed in v1.18.3)* If not provided, the user password is taken if provided.
    The string length must not exceed 40 characters.'
  id: totrans-841
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**owner_pw** (*str*) – *(自 v1.16.0 新增)* 设置文档的所有者密码。*(自 v1.18.3 更改)* 如果未提供，则使用用户密码（如果提供）。字符串长度不能超过40个字符。'
- en: '**user_pw** (*str*) – *(new in v1.16.0)* set the document’s user password.
    The string length must not exceed 40 characters.'
  id: totrans-842
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**user_pw** (*str*) – *(自 v1.16.0 新增)* 设置文档的用户密码。字符串长度不能超过40个字符。'
- en: '**use_objstms** (*int*) – *(new in v1.24.0)* compression option that converts
    eligible PDF object definitions to information that is stored in some other object’s
    [`stream`](glossary.html#stream "stream") data. Depending on the `deflate` parameter
    value, the converted object definitions will be compressed – which can lead to
    very significant file size reductions.'
  id: totrans-843
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**use_objstms** (*int*) – *(自 v1.24.0 新增)* 压缩选项，将符合条件的PDF对象定义转换为存储在其他对象的[`stream`](glossary.html#stream
    "stream")数据中的信息。根据`deflate`参数值，转换后的对象定义将被压缩，这可能导致文件大小显著减小。'
- en: Warning
  id: totrans-844
  prefs: []
  type: TYPE_NORMAL
  zh: 警告
- en: The method does not check, whether a file of that name already exists, will
    hence not ask for confirmation, and overwrite the file. It is your responsibility
    as a programmer to handle this.
  id: totrans-845
  prefs: []
  type: TYPE_NORMAL
  zh: 该方法不检查是否已存在同名文件，因此不会请求确认并覆盖文件。这是程序员处理的责任。
- en: Note
  id: totrans-846
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: '**File size reduction**'
  id: totrans-847
  prefs: []
  type: TYPE_NORMAL
  zh: '**文件大小减小**'
- en: 1\. Use the save options like `garbage=3|4, deflate=True, use_objstms=True|1`.
    Do not touch the default values `expand=False|0, clean=False|0, incremental=False|0`.
    This is a “lossless” file size reduction. There is a convenience version of this
    method with these values set by default, [`Document.ez_save()`](#Document.ez_save
    "Document.ez_save") – please see below.
  id: totrans-848
  prefs: []
  type: TYPE_NORMAL
  zh: 1\. 使用保存选项，如 `garbage=3|4, deflate=True, use_objstms=True|1`。不要触碰默认值 `expand=False|0,
    clean=False|0, incremental=False|0`。这是一种“无损”文件大小减小方法。有一个方便的版本，这些值默认设置为[`Document.ez_save()`](#Document.ez_save
    "Document.ez_save")，请参见下文。
- en: “Lossy” file size reduction in essence must give up something with respect to
    images, like (a) remove all images (b) replace images by their grayscale versions
    (c) reduce image resolutions. Find examples in the [PyMuPDF Utilities “replace-image”
    folder](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image).
  id: totrans-849
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实质上的“有损”文件大小减小必须放弃某些与图像相关的东西，比如（a）删除所有图像（b）将图像替换为其灰度版本（c）减少图像分辨率。在[PyMuPDF Utilities
    “replace-image”文件夹](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image)中找到示例。
- en: '[PRE72]'
  id: totrans-850
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: New in v1.18.11
  id: totrans-851
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.18.11 中新增
- en: 'PDF only: The same as [`Document.save()`](#Document.save "Document.save") but
    with changed defaults `deflate=True, garbage=3, use_objstms=1`.'
  id: totrans-852
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：与[`Document.save()`](#Document.save "Document.save")相同，但默认值已更改为 `deflate=True,
    garbage=3, use_objstms=1`。
- en: '[PRE73]'
  id: totrans-853
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'PDF only: saves the document incrementally. This is a convenience abbreviation
    for *doc.save(doc.name, incremental=True, encryption=PDF_ENCRYPT_KEEP)*.'
  id: totrans-854
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：增量保存文档。这是一个方便的缩写，等同于 *doc.save(doc.name, incremental=True, encryption=PDF_ENCRYPT_KEEP)*。
- en: Note
  id: totrans-855
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Saving incrementally may be required if the document contains verified signatures
    which would be invalidated by saving to a new file.
  id: totrans-856
  prefs: []
  type: TYPE_NORMAL
  zh: 如果文档包含经过验证的签名，保存到新文件可能会使签名失效，则可能需要进行增量保存。
- en: '[PRE74]'
  id: totrans-857
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Changed in v1.18.7
  id: totrans-858
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.18.7 中更改
- en: Changed in v1.19.0
  id: totrans-859
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.19.0 中更改
- en: Changed in v1.24.1
  id: totrans-860
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.24.1 中更改
- en: 'PDF only: Writes the **current content of the document** to a bytes object
    instead of to a file. Obviously, you should be wary about memory requirements.
    The meanings of the parameters exactly equal those in [`save()`](#Document.save
    "Document.save"). Chapter [FAQ](faq.html#faq) contains an example for using this
    method as a pre-processor to [pdfrw](https://pypi.python.org/pypi/pdfrw/0.3).'
  id: totrans-861
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：将**当前文档的内容**写入字节对象，而不是写入文件。显然，您应该对内存需求保持警惕。参数的含义与[`save()`](#Document.save
    "Document.save")中的参数完全相同。章节[FAQ](faq.html#faq)中包含了一个使用此方法作为[pdfrw](https://pypi.python.org/pypi/pdfrw/0.3)的预处理器的示例。
- en: '*(Changed in v1.16.0)* for extended encryption support.'
  id: totrans-862
  prefs: []
  type: TYPE_NORMAL
  zh: '*(在 v1.16.0 中更改)* 以支持扩展的加密支持。'
- en: 'Return type:'
  id: totrans-863
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: bytes
  id: totrans-864
  prefs: []
  type: TYPE_NORMAL
  zh: 字节
- en: 'Returns:'
  id: totrans-865
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a bytes object containing the complete document.
  id: totrans-866
  prefs: []
  type: TYPE_NORMAL
  zh: 一个包含完整文档的字节对象。
- en: '[PRE75]'
  id: totrans-867
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: Search for “text” on page number “pno”. Works exactly like the corresponding
    [`Page.search_for()`](page.html#Page.search_for "Page.search_for"). Any integer
    `-∞ < pno < page_count` is acceptable.
  id: totrans-868
  prefs: []
  type: TYPE_NORMAL
  zh: 在“pno”页上搜索“text”。与相应的[`Page.search_for()`](page.html#Page.search_for "Page.search_for")完全相同。任何整数
    `-∞ < pno < page_count` 都可以接受。
- en: '[PRE76]'
  id: totrans-869
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: Changed in v1.19.3 - as a fix to issue [#537](https://github.com/pymupdf/PyMuPDF/issues/537),
    form fields are always excluded.
  id: totrans-870
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.19.3 中更改 - 作为对问题[#537](https://github.com/pymupdf/PyMuPDF/issues/537)的修复，表单字段始终被排除。
- en: 'PDF only: Copy the page range **[from_page, to_page]** (including both) of
    PDF document *docsrc* into the current one. Inserts will start with page number
    *start_at*. Value -1 indicates default values. All pages thus copied will be rotated
    as specified. Links and annotations can be excluded in the target, see below.
    All page numbers are 0-based.'
  id: totrans-871
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：将PDF文档*docsrc*中的页面范围 **[from_page, to_page]**（两者都包括）复制到当前文档中。插入将从页码 *start_at*
    开始。值 -1 表示默认值。因此复制的所有页面都将按指定的方式旋转。链接和注释可以在目标中排除，详见下文。所有页码都是基于0的。
- en: 'Parameters:'
  id: totrans-872
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**docsrc** (*Document*) – An opened PDF *Document* which must not be the current
    document. However, it may refer to the same underlying file.'
  id: totrans-873
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**docsrc** (*Document*) – 一个已打开的PDF *Document*，不能是当前文档。但是，它可以引用相同的底层文件。'
- en: '**from_page** (*int*) – First page number in *docsrc*. Default is zero.'
  id: totrans-874
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**from_page** (*int*) – *docsrc* 中的第一页页码。默认为零。'
- en: '**to_page** (*int*) – Last page number in *docsrc* to copy. Defaults to last
    page.'
  id: totrans-875
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**to_page** (*int*) – 复制的*docsrc*中的最后一页页码。默认为最后一页。'
- en: '**start_at** (*int*) – First copied page, will become page number *start_at*
    in the target. Default -1 appends the page range to the end. If zero, the page
    range will be inserted before current first page.'
  id: totrans-876
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**start_at** (*int*) – 复制的第一页，将成为目标中的页码 *start_at*。默认值 -1 将页面范围追加到末尾。如果为零，则页面范围将插入到当前第一页之前。'
- en: '**rotate** (*int*) – All copied pages will be rotated by the provided value
    (degrees, integer multiple of 90).'
  id: totrans-877
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**rotate** (*int*) – 所有复制的页面将以提供的值旋转（度，90的整数倍）。'
- en: '**links** (*bool*) – Choose whether (internal and external) links should be
    included in the copy. Default is `True`. *Named* links ([`LINK_NAMED`](vars.html#LINK_NAMED
    "LINK_NAMED")) and internal links to outside the copied page range are **always
    excluded**.'
  id: totrans-878
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**links** (*bool*) – 选择是否包括链接（内部和外部）在复制中。默认为`True`。*命名*链接([`LINK_NAMED`](vars.html#LINK_NAMED
    "LINK_NAMED"))和指向超出复制页面范围的内部链接**总是被排除在外**。'
- en: '**annots** (*bool*) – *(new in v1.16.1)* choose whether annotations should
    be included in the copy. Form **fields can never be copied** – see below.'
  id: totrans-879
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**annots** (*bool*) – *(v1.16.1新增)* 选择是否在复制中包括注释。表单**字段永远不会被复制** – 请参见下文。'
- en: '**show_progress** (*int*) – *(new in v1.17.7)* specify an interval size greater
    zero to see progress messages on `sys.stdout`. After each interval, a message
    like `Inserted 30 of 47 pages.` will be printed.'
  id: totrans-880
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**show_progress** (*int*) – *(v1.17.7新增)* 指定大于零的间隔大小以在`sys.stdout`上看到进度消息。在每个间隔之后，将打印类似`Inserted
    30 of 47 pages.`的消息。'
- en: '**final** (*int*) – *(new in v1.18.0)* controls whether the list of already
    copied objects should be **dropped** after this method, default *True*. Set it
    to 0 except for the last one of multiple insertions from the same source PDF.
    This saves target file size and speeds up execution considerably.'
  id: totrans-881
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**final** (*int*) – *(v1.18.0新增)* 控制此方法后是否应删除已复制对象的列表，默认*True*。对于从同一源PDF中进行的多次插入中的最后一次，将其设置为0。这可以节省目标文件大小，并显著加快执行速度。'
- en: Note
  id: totrans-882
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: This is a page-based method. Document-level information of source documents
    is therefore ignored. Examples include Optional Content, Embedded Files, `StructureElem`,
    `AcroForm`, table of contents, page labels, metadata, named destinations (and
    other named entries) and some more. As a consequence, specifically, **Form Fields
    (widgets) can never be copied** – although they seem to appear on pages only.
    Look at [`Document.bake()`](#Document.bake "Document.bake") for converting a source
    document if you need to retain at least widget **appearances.**
  id: totrans-883
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这是一种基于页面的方法。因此，源文档的文档级信息将被忽略。示例包括可选内容、嵌入文件、`StructureElem`、`AcroForm`、目录、页面标签、元数据、命名目标（和其他命名条目）等。因此，具体地说，**表单字段（小部件）永远不能被复制**
    – 尽管它们似乎只出现在页面上。查看[`Document.bake()`](#Document.bake "Document.bake")以转换源文档，如果您至少需要保留小部件**外观**。
- en: If `from_page > to_page`, pages will be **copied in reverse order**. If `0 <=
    from_page == to_page`, then one page will be copied.
  id: totrans-884
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果`from_page > to_page`，页面将以**相反的顺序**复制。如果`0 <= from_page == to_page`，那么将复制一页。
- en: '`docsrc` TOC entries **will not be copied**. It is easy however, to recover
    a table of contents for the resulting document. Look at the examples below and
    at program [join.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py)
    in the *examples* directory: it can join PDF documents and at the same time piece
    together respective parts of the tables of contents.'
  id: totrans-885
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`docsrc` TOC条目**不会被复制**。然而，很容易为生成的文档恢复目录。查看下面的示例以及*examples*目录中的程序[join.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py)：它可以连接PDF文档，并同时拼接目录的各个部分。'
- en: '[PRE77]'
  id: totrans-886
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: New in v1.22.0
  id: totrans-887
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.0新增
- en: 'PDF only: Add an arbitrary supported document to the current PDF. Opens “infile”
    as a document, converts it to a PDF and then invokes [`Document.insert_pdf()`](#Document.insert_pdf
    "Document.insert_pdf"). Parameters are the same as for that method. Among other
    things, this features an easy way to append images as full pages to an output
    PDF.'
  id: totrans-888
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：将任意支持的文档添加到当前PDF中。打开“infile”作为文档，将其转换为PDF，然后调用[`Document.insert_pdf()`](#Document.insert_pdf
    "Document.insert_pdf")。参数与该方法相同。除其他外，这还提供了一种将图像附加为输出PDF的完整页面的简单方法。
- en: 'Parameters:'
  id: totrans-889
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**infile** (*multiple*) – the input document to insert. May be a filename specification
    as is valid for creating a [Document](#document) or a [Pixmap](pixmap.html#pixmap).'
  id: totrans-890
  prefs: []
  type: TYPE_NORMAL
  zh: '**infile** (*multiple*) – 要插入的输入文档。可以是一个文件名规范，与创建[Document](#document)或[Pixmap](pixmap.html#pixmap)有效的相同。'
- en: '[PRE78]'
  id: totrans-891
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'PDF only: Insert an empty page.'
  id: totrans-892
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：插入空白页。
- en: 'Parameters:'
  id: totrans-893
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – page number in front of which the new page should be inserted.
    Must be in *1 < pno <= page_count*. Special values -1 and *doc.page_count* insert
    **after** the last page.'
  id: totrans-894
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno** (*int*) – 应在其前插入新页面的页码。必须在*1 < pno <= page_count*。特殊值-1和*doc.page_count*在最后一页之后插入**之后**。'
- en: '**width** (*float*) – page width.'
  id: totrans-895
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**width** (*float*) – 页面宽度。'
- en: '**height** (*float*) – page height.'
  id: totrans-896
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**height** (*float*) – 页面高度。'
- en: 'Return type:'
  id: totrans-897
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: '[Page](page.html#page)'
  id: totrans-898
  prefs: []
  type: TYPE_NORMAL
  zh: '[Page](page.html#page)'
- en: 'Returns:'
  id: totrans-899
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the created page object.
  id: totrans-900
  prefs: []
  type: TYPE_NORMAL
  zh: 创建的页面对象。
- en: '[PRE79]'
  id: totrans-901
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'PDF only: Insert a new page and insert some text. Convenience function which
    combines [`Document.new_page()`](#Document.new_page "Document.new_page") and (parts
    of) [`Page.insert_text()`](page.html#Page.insert_text "Page.insert_text").'
  id: totrans-902
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于 PDF：插入一个新页面并插入一些文本。这是一个方便函数，结合了 [`Document.new_page()`](#Document.new_page
    "Document.new_page") 和（部分）[`Page.insert_text()`](page.html#Page.insert_text "Page.insert_text")
    的功能。
- en: 'Parameters:'
  id: totrans-903
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) –'
  id: totrans-904
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno**（*int*）–'
- en: page number (0-based) **in front of which** to insert. Must be in `range(-1,
    doc.page_count + 1)`. Special values -1 and `doc.page_count` insert **after**
    the last page.
  id: totrans-905
  prefs: []
  type: TYPE_NORMAL
  zh: 页面号（基于 0）**之前**要插入的位置。必须在 `range(-1, doc.page_count + 1)` 内。特殊值 -1 和 `doc.page_count`
    在文档的最后一页之后插入。
- en: Changed in v1.14.12
  id: totrans-906
  prefs: []
  type: TYPE_NORMAL
  zh: 自 v1.14.12 版本更改
- en: This is now a positional parameter
  id: totrans-907
  prefs: []
  type: TYPE_NORMAL
  zh: 此参数现在是位置参数。
- en: For the other parameters, please consult the aforementioned methods.
  id: totrans-908
  prefs: []
  type: TYPE_NORMAL
  zh: 对于其他参数，请参阅上述方法。
- en: 'Return type:'
  id: totrans-909
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-910
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-911
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the result of [`Page.insert_text()`](page.html#Page.insert_text "Page.insert_text")
    (number of successfully inserted lines).
  id: totrans-912
  prefs: []
  type: TYPE_NORMAL
  zh: 返回 [`Page.insert_text()`](page.html#Page.insert_text "Page.insert_text") 的结果（成功插入行数）。
- en: '[PRE80]'
  id: totrans-913
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'PDF only: Delete a page given by its 0-based number in `-∞ < pno < page_count
    - 1`.'
  id: totrans-914
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于 PDF：按 0-based 页面号删除页面，范围为 `-∞ < pno < page_count - 1`。
- en: 'Changed in v1.18.14: support Python’s `del` statement.'
  id: totrans-915
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.18.14 版本更改：支持 Python 的 `del` 语句。
- en: 'Parameters:'
  id: totrans-916
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – the page to be deleted. Negative number count backwards from
    the end of the document (like with indices). Default is the last page.'
  id: totrans-917
  prefs: []
  type: TYPE_NORMAL
  zh: '**pno**（*int*）– 要删除的页面。负数从文档末尾开始计数（类似于索引）。默认为最后一页。'
- en: '[PRE81]'
  id: totrans-918
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'Changed in v1.18.13: more flexibility specifying pages to delete.'
  id: totrans-919
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.18.13 版本更改：删除页面时具有更大的灵活性。
- en: 'Changed in v1.18.14: support Python’s `del` statement.'
  id: totrans-920
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.18.14 版本更改：支持 Python 的 `del` 语句。
- en: 'PDF only: Delete multiple pages given as 0-based numbers.'
  id: totrans-921
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于 PDF：按 0-based 页面号删除多个页面。
- en: '**Format 1:** Use keywords. Represents the old format. A contiguous range of
    pages is removed.'
  id: totrans-922
  prefs: []
  type: TYPE_NORMAL
  zh: '**格式 1：** 使用关键字。表示旧格式。删除一段连续的页面。'
- en: '“from_page”: first page to delete. Zero if omitted.'
  id: totrans-923
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '“from_page”: 要删除的第一页。如果省略，为零。'
- en: '“to_page”: last page to delete. Last page in document if omitted. Must not
    be less then “from_page”.'
  id: totrans-924
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '“to_page”: 要删除的最后一页。如果省略，将删除文档中的最后一页。必须不小于 “from_page”。'
- en: '**Format 2:** Two page numbers as positional parameters. Handled like Format
    1.'
  id: totrans-925
  prefs: []
  type: TYPE_NORMAL
  zh: '**格式 2：** 作为位置参数的两个页面号。与格式 1 类似处理。'
- en: '**Format 3:** One positional integer parameter. Equivalent to `Page.delete_page()`.'
  id: totrans-926
  prefs: []
  type: TYPE_NORMAL
  zh: '**格式 3：** 一个位置整数参数。相当于 `Page.delete_page()`。'
- en: '**Format 4:** One positional parameter of type *list*, *tuple* or *range()*
    of page numbers. The items of this sequence may be in any order and may contain
    duplicates.'
  id: totrans-927
  prefs: []
  type: TYPE_NORMAL
  zh: '**格式 4：** 一种 *list*、*tuple* 或 *range()* 类型的位置参数，包含要删除的页面号。此序列的项目可以按任何顺序排列，并且可以包含重复项。'
- en: '**Format 5:** *(New in v1.18.14)* Using the Python `del` statement and index
    / slice notation is now possible.'
  id: totrans-928
  prefs: []
  type: TYPE_NORMAL
  zh: '**格式 5：**（*在 v1.18.14 中新增*）现在支持使用 Python 的 `del` 语句和索引/切片表示法。'
- en: Note
  id: totrans-929
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: '*(Changed in v1.14.17, optimized in v1.17.7)* In an effort to maintain a valid
    PDF structure, this method and [`delete_page()`](#Document.delete_page "Document.delete_page")
    will also deactivate items in the table of contents which point to deleted pages.
    “Deactivation” here means, that the bookmark will point to nowhere and the title
    will be shown grayed-out by supporting PDF viewers. The overall TOC structure
    is left intact.'
  id: totrans-930
  prefs: []
  type: TYPE_NORMAL
  zh: （*在 v1.14.17 中更改，v1.17.7 中优化*）为了维护有效的 PDF 结构，此方法和 [`delete_page()`](#Document.delete_page
    "Document.delete_page") 也会禁用指向已删除页面的目录项。在此处，“禁用”意味着书签将指向空白处，并且支持 PDF 查看器会将标题显示为灰色。总体的目录结构保持不变。
- en: It will also remove any **links on remaining pages** which point to a deleted
    one. This action may have an extended response time for documents with many pages.
  id: totrans-931
  prefs: []
  type: TYPE_NORMAL
  zh: 还将删除剩余页面上指向已删除页面的任何链接。对于包含许多页面的文档，此操作可能需要较长的响应时间。
- en: 'Following examples will all delete pages 500 through 519:'
  id: totrans-932
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例都将删除从页面 500 到 519 的页面：
- en: '`doc.delete_pages(500, 519)`'
  id: totrans-933
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`doc.delete_pages(500, 519)`'
- en: '`doc.delete_pages(from_page=500, to_page=519)`'
  id: totrans-934
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`doc.delete_pages(from_page=500, to_page=519)`'
- en: '`doc.delete_pages((500, 501, 502, ... , 519))`'
  id: totrans-935
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`doc.delete_pages((500, 501, 502, ... , 519))`'
- en: '`doc.delete_pages(range(500, 520))`'
  id: totrans-936
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`doc.delete_pages(range(500, 520))`'
- en: '`del doc[500:520]`'
  id: totrans-937
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`del doc[500:520]`'
- en: '`del doc[(500, 501, 502, ... , 519)]`'
  id: totrans-938
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`del doc[(500, 501, 502, ... , 519)]`'
- en: '`del doc[range(500, 520)]`'
  id: totrans-939
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`del doc[range(500, 520)]`'
- en: For the [Adobe PDF References](app3.html#adobemanual) the above takes about
    0.6 seconds, because the remaining 1290 pages must be cleaned from invalid links.
  id: totrans-940
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 [Adobe PDF 参考手册](app3.html#adobemanual)，上述操作大约需要 0.6 秒，因为必须清除其余 1290 页中的无效链接。
- en: 'In general, the performance of this method is dependent on the number of remaining
    pages – **not** on the number of deleted pages: in the above example, **deleting
    all pages except** those 20, will need much less time.'
  id: totrans-941
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，该方法的性能取决于剩余页面的数量，而**不是**删除页面的数量：在上述示例中，**删除除了**那20页之外的所有页面，需要的时间要少得多。
- en: '[PRE82]'
  id: totrans-942
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'PDF only: Copy a page reference within the document.'
  id: totrans-943
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：在文档内部复制页面引用。
- en: 'Parameters:'
  id: totrans-944
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – the page to be copied. Must be in range `0 <= pno < page_count`.'
  id: totrans-945
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno**（*int*）- 要复制的页面。必须在`0 <= pno < page_count`范围内。'
- en: '**to** (*int*) – the page number in front of which to copy. The default inserts
    **after** the last page.'
  id: totrans-946
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**to**（*int*）- 要复制的页面号。默认情况下插入**在**最后一页之后。'
- en: Note
  id: totrans-947
  prefs: []
  type: TYPE_NORMAL
  zh: 注释
- en: Only a new **reference** to the page object will be created – not a new page
    object, all copied pages will have identical attribute values, including the [`Page.xref`](page.html#Page.xref
    "Page.xref"). This implies that any changes to one of these copies will appear
    on all of them.
  id: totrans-948
  prefs: []
  type: TYPE_NORMAL
  zh: 只会创建对页面对象的新**引用**- 不是新的页面对象，所有复制的页面都将具有相同的属性值，包括[`Page.xref`](page.html#Page.xref
    "Page.xref")。这意味着对其中一个副本的更改将出现在所有副本上。
- en: '[PRE83]'
  id: totrans-949
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: New in v1.14.17
  id: totrans-950
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新版本v1.14.17中新增
- en: 'PDF only: Make a full copy (duplicate) of a page.'
  id: totrans-951
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：制作页面的完整副本（复制）。
- en: 'Parameters:'
  id: totrans-952
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – the page to be duplicated. Must be in range `0 <= pno < page_count`.'
  id: totrans-953
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno**（*int*）- 要复制的页面。必须在`0 <= pno < page_count`范围内。'
- en: '**to** (*int*) – the page number in front of which to copy. The default inserts
    **after** the last page.'
  id: totrans-954
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**to**（*int*）- 要复制的页面号。默认情况下插入**在**最后一页之后。'
- en: Note
  id: totrans-955
  prefs: []
  type: TYPE_NORMAL
  zh: 注释
- en: In contrast to [`copy_page()`](#Document.copy_page "Document.copy_page"), this
    method creates a new page object (with a new [`xref`](glossary.html#xref "xref")),
    which can be changed independently from the original.
  id: totrans-956
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与[`copy_page()`](#Document.copy_page "Document.copy_page")相比，此方法创建一个新的页面对象（带有新的[`xref`](glossary.html#xref
    "xref")），可以独立于原始页面进行更改。
- en: Any Popup and “IRT” (“in response to”) annotations are **not copied** to avoid
    potentially incorrect situations.
  id: totrans-957
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何弹出窗口和“IRT”（“响应于”）注释**不会被复制**，以避免潜在的不正确情况。
- en: '[PRE84]'
  id: totrans-958
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'PDF only: Move (copy and then delete original) a page within the document.'
  id: totrans-959
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：在文档内部移动（复制然后删除原始）页面。
- en: 'Parameters:'
  id: totrans-960
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**pno** (*int*) – the page to be moved. Must be in range `0 <= pno < page_count`.'
  id: totrans-961
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pno**（*int*）- 要移动的页面。必须在`0 <= pno < page_count`范围内。'
- en: '**to** (*int*) – the page number in front of which to insert the moved page.
    The default moves **after** the last page.'
  id: totrans-962
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**to**（*int*）- 要复制的页面前面的页码。默认情况下插入**在**最后一页之后。'
- en: '[PRE85]'
  id: totrans-963
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: New in v1.17.4
  id: totrans-964
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新版本v1.17.4中新增
- en: 'PDF only: Get or set the */NeedAppearances* property of Form PDFs. Quote: *“(Optional)
    A flag specifying whether to construct appearance streams and appearance dictionaries
    for all widget annotations in the document … Default value: false.”* This may
    help controlling the behavior of some readers / viewers.'
  id: totrans-965
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：获取或设置表单PDF的*/NeedAppearances*属性。引用：“（可选）指定是否为文档中的所有窗口注释构造外观流和外观字典...
    默认值：false。”这可能有助于控制某些阅读器/查看器的行为。
- en: 'Parameters:'
  id: totrans-966
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**value** (*bool*) – set the property to this value. If omitted or `None`,
    inquire the current value.'
  id: totrans-967
  prefs: []
  type: TYPE_NORMAL
  zh: '**value**（*bool*）- 将属性设置为此值。如果省略或为`None`，则查询当前值。'
- en: 'Return type:'
  id: totrans-968
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: bool
  id: totrans-969
  prefs: []
  type: TYPE_NORMAL
  zh: 布尔值
- en: 'Returns:'
  id: totrans-970
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'None: not a Form PDF, or property not defined.'
  id: totrans-971
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: None：不是表单PDF，或未定义属性。
- en: 'True / False: the value of the property (either just set or existing for inquiries).
    Has no effect if no Form PDF.'
  id: totrans-972
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: True / False：属性的值（已设置或现有以进行查询）。如果没有表单PDF，则没有影响。
- en: '[PRE86]'
  id: totrans-973
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'PDF only: Return whether the document contains signature fields. This is an
    optional PDF property: if not present (return value -1), no conclusions can be
    drawn – the PDF creator may just not have bothered using it.'
  id: totrans-974
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于PDF：返回文档是否包含签名字段。这是一个可选的PDF属性：如果不存在（返回值为-1），则无法得出结论- PDF创建者可能只是没有使用它。
- en: 'Return type:'
  id: totrans-975
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-976
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-977
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '-1: not a Form PDF / no signature fields recorded / no *SigFlags* found.'
  id: totrans-978
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -1：不是表单PDF/未记录签名字段/未找到*SigFlags*。
- en: '1: at least one signature field exists.'
  id: totrans-979
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1：至少存在一个签名字段。
- en: '3: contains signatures that may be invalidated if the file is saved (written)
    in a way that alters its previous contents, as opposed to an incremental update.'
  id: totrans-980
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3：包含可能在文件被保存（写入）时使其前一内容发生变化而无效的签名。
- en: '[PRE87]'
  id: totrans-981
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'Changed in v1.14.16: The sequence of positional parameters “name” and “buffer”
    has been changed to comply with the call pattern of other functions.'
  id: totrans-982
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从v1.14.16版本开始更改：位置参数“name”和“buffer”的顺序已更改，以符合其他函数的调用模式。
- en: 'PDF only: Embed a new file. All string parameters except the name may be unicode
    (in previous versions, only ASCII worked correctly). File contents will be compressed
    (where beneficial).'
  id: totrans-983
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：嵌入新文件。除了名称之外的所有字符串参数均可以是 Unicode（在之前的版本中，只有 ASCII 正常工作）。文件内容将被压缩（如果有利的话）。
- en: 'Parameters:'
  id: totrans-984
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**name** (*str*) – entry identifier, **must not already exist**.'
  id: totrans-985
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**name** (*str*) – 条目标识符，**不得已经存在**。'
- en: '**buffer** (*bytes**,**bytearray**,**BytesIO*) –'
  id: totrans-986
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**buffer** (*bytes**,**bytearray**,**BytesIO*) –'
- en: file contents.
  id: totrans-987
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 文件内容。
- en: '*(Changed in v1.14.13)* *io.BytesIO* is now also supported.'
  id: totrans-988
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*(在 v1.14.13 中更改)* 现在也支持 *io.BytesIO*。'
- en: '**filename** (*str*) – optional filename. Documentation only, will be set to
    *name* if `None`.'
  id: totrans-989
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filename** (*str*) – 可选的文件名。仅供文档使用，如果为 `None`，将设置为*name*。'
- en: '**ufilename** (*str*) – optional unicode filename. Documentation only, will
    be set to *filename* if `None`.'
  id: totrans-990
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ufilename** (*str*) – 可选的 Unicode 文件名。仅供文档使用，如果为 `None`，将设置为*filename*。'
- en: '**desc** (*str*) – optional description. Documentation only, will be set to
    *name* if `None`.'
  id: totrans-991
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**desc** (*str*) – 可选的描述。仅供文档使用，如果为 `None`，将设置为*name*。'
- en: 'Return type:'
  id: totrans-992
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-993
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-994
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: '*(Changed in v1.18.13)* The method now returns the [`xref`](glossary.html#xref
    "xref") of the inserted file. In addition, the file object now will be automatically
    given the PDF keys `/CreationDate` and `/ModDate` based on the current date-time.'
  id: totrans-995
  prefs: []
  type: TYPE_NORMAL
  zh: '*(在 v1.18.13 中更改)* 现在该方法返回插入文件的[`xref`](glossary.html#xref "xref")。此外，基于当前日期时间，文件对象现在将自动获得
    PDF 键 `/CreationDate` 和 `/ModDate`。'
- en: '[PRE88]'
  id: totrans-996
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: 'Changed in v1.14.16: This is now a method. In previous versions, this was a
    property.'
  id: totrans-997
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.14.16 中更改：现在这是一个方法。在以前的版本中，这是一个属性。
- en: 'PDF only: Return the number of embedded files.'
  id: totrans-998
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回嵌入式文件的数量。
- en: '[PRE89]'
  id: totrans-999
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'PDF only: Retrieve the content of embedded file by its entry number or name.
    If the document is not a PDF, or entry cannot be found, an exception is raised.'
  id: totrans-1000
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：通过其条目编号或名称检索嵌入文件的内容。如果文档不是 PDF，或者找不到条目，则会引发异常。
- en: 'Parameters:'
  id: totrans-1001
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**item** (*int**,**str*) – index or name of entry. An integer must be in `range(embfile_count())`.'
  id: totrans-1002
  prefs: []
  type: TYPE_NORMAL
  zh: '**item** (*int**,**str*) – 索引或条目的名称。整数必须在 `range(embfile_count())` 内。'
- en: 'Return type:'
  id: totrans-1003
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: bytes
  id: totrans-1004
  prefs: []
  type: TYPE_NORMAL
  zh: 字节
- en: '[PRE90]'
  id: totrans-1005
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'Changed in v1.14.16: Items can now be deleted by index, too.'
  id: totrans-1006
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.14.16 中更改：现在也可以通过索引删除项目。
- en: 'PDF only: Remove an entry from `/EmbeddedFiles`. As always, physical deletion
    of the embedded file content (and file space regain) will occur only when the
    document is saved to a new file with a suitable garbage option.'
  id: totrans-1007
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：从`/EmbeddedFiles`中删除条目。与往常一样，仅当将文档保存到具有适当的垃圾选项的新文件时，才会发生嵌入式文件内容的物理删除（以及文件空间的回收）。
- en: 'Parameters:'
  id: totrans-1008
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**item** (*int/str*) – index or name of entry.'
  id: totrans-1009
  prefs: []
  type: TYPE_NORMAL
  zh: '**item** (*int/str*) – 索引或条目的名称。'
- en: Warning
  id: totrans-1010
  prefs: []
  type: TYPE_NORMAL
  zh: 警告
- en: When specifying an entry name, this function will only **delete the first item**
    with that name. Be aware that PDFs not created with PyMuPDF may contain duplicate
    names. So you may want to take appropriate precautions.
  id: totrans-1011
  prefs: []
  type: TYPE_NORMAL
  zh: 当指定条目名称时，此函数将仅**删除具有该名称的第一项**。请注意，未使用 PyMuPDF 创建的 PDF 可能包含重复名称。因此，您可能希望采取适当的预防措施。
- en: '[PRE91]'
  id: totrans-1012
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: Changed in v1.18.13
  id: totrans-1013
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.18.13 中更改
- en: 'PDF only: Retrieve information of an embedded file given by its number or by
    its name.'
  id: totrans-1014
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：通过其编号或名称检索嵌入文件的信息。
- en: 'Parameters:'
  id: totrans-1015
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**item** (*int/str*) – index or name of entry. An integer must be in `range(embfile_count())`.'
  id: totrans-1016
  prefs: []
  type: TYPE_NORMAL
  zh: '**item** (*int/str*) – 索引或条目的名称。整数必须在 `range(embfile_count())` 内。'
- en: 'Return type:'
  id: totrans-1017
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: dict
  id: totrans-1018
  prefs: []
  type: TYPE_NORMAL
  zh: 字典
- en: 'Returns:'
  id: totrans-1019
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a dictionary with the following keys:'
  id: totrans-1020
  prefs: []
  type: TYPE_NORMAL
  zh: 具有以下键的字典：
- en: '*name* – (*str*) name under which this entry is stored'
  id: totrans-1021
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*name* – (*str*) 此条目存储的名称'
- en: '*filename* – (*str*) filename'
  id: totrans-1022
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*filename* – (*str*) 文件名'
- en: '*ufilename* – (*unicode*) filename'
  id: totrans-1023
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*ufilename* – (*unicode*) 文件名'
- en: '*desc* – (*str*) description'
  id: totrans-1024
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*desc* – (*str*) 描述'
- en: '*size* – (*int*) original file size'
  id: totrans-1025
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*size* – (*int*) 原始文件大小'
- en: '*length* – (*int*) compressed file length'
  id: totrans-1026
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*length* – (*int*) 压缩文件长度'
- en: '*creationDate* – *(New in v1.18.13)* (*str*) date-time of item creation in
    PDF format'
  id: totrans-1027
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*creationDate* – *(在 v1.18.13 中新增)* (*str*) 以 PDF 格式表示的项目创建日期时间'
- en: '*modDate* – *(New in v1.18.13)* (*str*) date-time of last change in PDF format'
  id: totrans-1028
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*modDate* – *(在 v1.18.13 中新增)* (*str*) 最后一次更改的日期时间，以 PDF 格式表示'
- en: '*collection* – *(New in v1.18.13)* (*int*) [`xref`](glossary.html#xref "xref")
    of the associated PDF portfolio item if any, else zero.'
  id: totrans-1029
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*collection* – *(在 v1.18.13 中新增)* (*int*) 如果有的话，与关联 PDF 组合项的[`xref`](glossary.html#xref
    "xref")，否则为零。'
- en: '*checksum* – *(New in v1.18.13)* (*str*) a hashcode of the stored file content
    as a hexadecimal string. Should be MD5 according to PDF specifications, but be
    prepared to see other hashing algorithms.'
  id: totrans-1030
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*checksum* – *(在 v1.18.13 中新增)* (*str*) 存储文件内容的哈希码，以十六进制字符串表示。根据 PDF 规范，应为
    MD5，但应准备好看到其他哈希算法。'
- en: '[PRE92]'
  id: totrans-1031
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: New in v1.14.16
  id: totrans-1032
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.14.16 中新增
- en: 'PDF only: Return a list of embedded file names. The sequence of the names equals
    the physical sequence in the document.'
  id: totrans-1033
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回嵌入文件名列表。名称的顺序与文档中的物理顺序相同。
- en: 'Return type:'
  id: totrans-1034
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: list
  id: totrans-1035
  prefs: []
  type: TYPE_NORMAL
  zh: 列表
- en: '[PRE93]'
  id: totrans-1036
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'PDF only: Change an embedded file given its entry number or name. All parameters
    are optional. Letting them default leads to a no-operation.'
  id: totrans-1037
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：根据其条目编号或名称更改嵌入文件。所有参数均为可选。让它们默认导致无操作。
- en: 'Parameters:'
  id: totrans-1038
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**item** (*int/str*) – index or name of entry. An integer must be in `range(embfile_count())`.'
  id: totrans-1039
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**item**（*int/str*）– 条目的索引或名称。整数必须在 `range(embfile_count())` 内。'
- en: '**buffer** (*bytes**,**bytearray**,**BytesIO*) –'
  id: totrans-1040
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**buffer**（*bytes**,**bytearray**,**BytesIO*）–'
- en: the new file content.
  id: totrans-1041
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 新文件内容。
- en: '*(Changed in v1.14.13)* *io.BytesIO* is now also supported.'
  id: totrans-1042
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: （在 v1.14.13 中更改）*io.BytesIO* 现在也受支持。
- en: '**filename** (*str*) – the new filename.'
  id: totrans-1043
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filename**（*str*）– 新的文件名。'
- en: '**ufilename** (*str*) – the new unicode filename.'
  id: totrans-1044
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ufilename**（*str*）– 新的 Unicode 文件名。'
- en: '**desc** (*str*) – the new description.'
  id: totrans-1045
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**desc**（*str*）– 新描述。'
- en: '*(Changed in v1.18.13)* The method now returns the [`xref`](glossary.html#xref
    "xref") of the file object.'
  id: totrans-1046
  prefs: []
  type: TYPE_NORMAL
  zh: '*（在 v1.18.13 中更改）* 该方法现在返回文件对象的 [`xref`](https://example.org/xref "xref")。'
- en: 'Return type:'
  id: totrans-1047
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-1048
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-1049
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: xref of the file object. Automatically, its `/ModDate` PDF key will be updated
    with the current date-time.
  id: totrans-1050
  prefs: []
  type: TYPE_NORMAL
  zh: 文件对象的 [`xref`](https://example.org/xref "xref")。其 `/ModDate` PDF 键将自动更新为当前日期时间。
- en: '[PRE94]'
  id: totrans-1051
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: Release objects and space allocations associated with the document. If created
    from a file, also closes *filename* (releasing control to the OS). Explicitly
    closing a document is equivalent to deleting it, `del doc`, or assigning it to
    something else like `doc = None`.
  id: totrans-1052
  prefs: []
  type: TYPE_NORMAL
  zh: 释放与文档相关的对象和空间分配。如果从文件创建，还会关闭 *filename*（将控制权释放给操作系统）。显式关闭文档等同于删除它，`del doc`
    或将其分配给其他类似 `doc = None`。
- en: '[PRE95]'
  id: totrans-1053
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: New in v1.16.8
  id: totrans-1054
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.16.8 中
- en: Changed in v1.18.10
  id: totrans-1055
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.18.10 中更改
- en: 'PDF only: Return the definition source of a PDF object.'
  id: totrans-1056
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回 PDF 对象的定义源。
- en: 'Parameters:'
  id: totrans-1057
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – the object’s [`xref`](glossary.html#xref "xref"). *Changed
    in v1.18.10:* A value of `-1` returns the PDF trailer source.'
  id: totrans-1058
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref**（*int*）– 对象的 [`xref`](https://example.org/xref "xref")。*在 v1.18.10
    中更改：* 值为 `-1` 返回 PDF 尾部源。'
- en: '**compressed** (*bool*) – whether to generate a compact output with no line
    breaks or spaces.'
  id: totrans-1059
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**compressed**（*bool*）– 是否生成没有换行或空格的紧凑输出。'
- en: '**ascii** (*bool*) – whether to ASCII-encode binary data.'
  id: totrans-1060
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ascii**（*bool*）– 是否对二进制数据进行 ASCII 编码。'
- en: 'Return type:'
  id: totrans-1061
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: str
  id: totrans-1062
  prefs: []
  type: TYPE_NORMAL
  zh: str
- en: 'Returns:'
  id: totrans-1063
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: The object definition source.
  id: totrans-1064
  prefs: []
  type: TYPE_NORMAL
  zh: 对象定义源。
- en: '[PRE96]'
  id: totrans-1065
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: New in v1.16.8
  id: totrans-1066
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.16.8 中
- en: 'PDF only: Return the [`xref`](glossary.html#xref "xref") number of the PDF
    catalog (or root) object. Use that number with [`Document.xref_object()`](#Document.xref_object
    "Document.xref_object") to see its source.'
  id: totrans-1067
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回 PDF 目录（或根）对象的 [`xref`](https://example.org/xref "xref") 编号。使用该编号与
    [`Document.xref_object()`](https://example.org/Document.xref_object "Document.xref_object")
    一起查看其源。
- en: '[PRE97]'
  id: totrans-1068
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: New in v1.16.8
  id: totrans-1069
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.16.8 中
- en: 'PDF only: Return the trailer source of the PDF, which is usually located at
    the PDF file’s end. This is [`Document.xref_object()`](#Document.xref_object "Document.xref_object")
    with an *xref* argument of -1.'
  id: totrans-1070
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回 PDF 的尾部源，通常位于 PDF 文件的末尾。这是 [`Document.xref_object()`](https://example.org/Document.xref_object
    "Document.xref_object") 的 *xref* 参数为 -1 的结果。
- en: '[PRE98]'
  id: totrans-1071
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: New in v1.16.8
  id: totrans-1072
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.16.8 中
- en: 'PDF only: Return the **decompressed** contents of the [`xref`](glossary.html#xref
    "xref") stream object.'
  id: totrans-1073
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回 [`xref`](https://example.org/xref "xref") 流对象的 **解压缩** 内容。
- en: 'Parameters:'
  id: totrans-1074
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – [`xref`](glossary.html#xref "xref") number.'
  id: totrans-1075
  prefs: []
  type: TYPE_NORMAL
  zh: '**xref**（*int*）– [`xref`](https://example.org/xref "xref") 编号。'
- en: 'Return type:'
  id: totrans-1076
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: bytes
  id: totrans-1077
  prefs: []
  type: TYPE_NORMAL
  zh: 字节
- en: 'Returns:'
  id: totrans-1078
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the (decompressed) stream of the object.
  id: totrans-1079
  prefs: []
  type: TYPE_NORMAL
  zh: （解压后的）对象流。
- en: '[PRE99]'
  id: totrans-1080
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: New in v1.16.8
  id: totrans-1081
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.16.8 中
- en: 'PDF only: Return the **unmodified** (esp. **not decompressed**) contents of
    the [`xref`](glossary.html#xref "xref") stream object. Otherwise equal to [`Document.xref_stream()`](#Document.xref_stream
    "Document.xref_stream").'
  id: totrans-1082
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：返回 **未修改**（尤其是 **未解压缩**）的 [`xref`](https://example.org/xref "xref") 流对象的内容。否则等同于
    [`Document.xref_stream()`](https://example.org/Document.xref_stream "Document.xref_stream")。
- en: 'Return type:'
  id: totrans-1083
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: bytes
  id: totrans-1084
  prefs: []
  type: TYPE_NORMAL
  zh: 字节
- en: 'Returns:'
  id: totrans-1085
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: the (original, unmodified) stream of the object.
  id: totrans-1086
  prefs: []
  type: TYPE_NORMAL
  zh: （原始的，未修改的）对象流。
- en: '[PRE100]'
  id: totrans-1087
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: New in v1.16.8
  id: totrans-1088
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.16.8 中
- en: 'PDF only: Replace object definition of [`xref`](glossary.html#xref "xref")
    with the provided string. The xref may also be new, in which case this instruction
    completes the object definition. If a page object is also given, its links and
    annotations will be reloaded afterwards.'
  id: totrans-1089
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：用提供的字符串替换 [`xref`](https://example.org/xref "xref") 的对象定义。如果 xref 也是新的，则此指令完成对象定义。如果还提供了页面对象，则其链接和注释将在此之后重新加载。
- en: 'Parameters:'
  id: totrans-1090
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – [`xref`](glossary.html#xref "xref") number.'
  id: totrans-1091
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref**（*int*） – [`xref`](glossary.html#xref "xref") 编号。'
- en: '**obj_str** (*str*) – a string containing a valid PDF object definition.'
  id: totrans-1092
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**obj_str**（*str*） – 包含有效的 PDF 对象定义的字符串。'
- en: '**page** ([Page](page.html#page)) – a page object. If provided, indicates,
    that annotations of this page should be refreshed (reloaded) to reflect changes
    incurred with links and / or annotations.'
  id: totrans-1093
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**page**（[Page](page.html#page)） – 页面对象。如果提供，则表示该页面的注释应刷新（重新加载），以反映链接和/或注释所引起的更改。'
- en: 'Return type:'
  id: totrans-1094
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: int
  id: totrans-1095
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: 'Returns:'
  id: totrans-1096
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: zero if successful, otherwise an exception will be raised.
  id: totrans-1097
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功则返回零，否则将引发异常。
- en: '[PRE101]'
  id: totrans-1098
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: New in v.1.16.8
  id: totrans-1099
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v.1.16.8
- en: 'Changed in v1.19.2: added parameter “compress”'
  id: totrans-1100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.19.2 中更改：添加参数 “compress”
- en: 'Changed in v1.19.6: deprecated parameter “new”. Now confirms that the object
    is a PDF dictionary object.'
  id: totrans-1101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.19.6 中更改：不推荐参数 “new”。现在确认对象是 PDF 字典对象。
- en: Replace the stream of an object identified by *xref*, which must be a PDF dictionary.
    If the object is no [`stream`](glossary.html#stream "stream"), it will be turned
    into one. The function automatically performs a compress operation (“deflate”)
    where beneficial.
  id: totrans-1102
  prefs: []
  type: TYPE_NORMAL
  zh: 替换由 *xref* 标识的对象的流，该对象必须是 PDF 字典。如果对象不是 [`stream`](glossary.html#stream "stream")，它将被转换为流。该函数会在有利时自动执行压缩操作（“deflate”）。
- en: 'Parameters:'
  id: totrans-1103
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – [`xref`](glossary.html#xref "xref") number.'
  id: totrans-1104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref**（*int*） – [`xref`](glossary.html#xref "xref") 编号。'
- en: '**stream** (*bytes**|**bytearray**|**BytesIO*) –'
  id: totrans-1105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**stream**（*bytes*|*bytearray*|*BytesIO*） –'
- en: the new content of the stream.
  id: totrans-1106
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 流的新内容。
- en: '*(Changed in v1.14.13:)* *io.BytesIO* objects are now also supported.'
  id: totrans-1107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: （v1.14.13 中更改：）*io.BytesIO* 对象现在也得到支持。
- en: '**new** (*bool*) – *deprecated* and ignored. Will be removed some time after
    v1.20.0.'
  id: totrans-1108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**new**（*bool*） – *不推荐* 和被忽略。将在 v1.20.0 之后删除。'
- en: '**compress** (*bool*) – whether to compress the inserted stream. If `True`
    (default), the stream will be inserted using `/FlateDecode` compression (if beneficial),
    otherwise the stream will inserted as is.'
  id: totrans-1109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**compress**（*bool*） – 是否压缩插入的流。如果为 `True`（默认），则使用 `/FlateDecode` 压缩插入流（如果有利），否则按原样插入流。'
- en: 'Raises:'
  id: totrans-1110
  prefs: []
  type: TYPE_NORMAL
  zh: 抛出：
- en: '**ValueError** – if *xref* does not represent a PDF `dict`. An empty dictionary
    `<<>>` is accepted. So if you just created the xref and want to give it a stream,
    first execute `doc.update_object(xref, "<<>>")`, and then insert the stream data
    with this method.'
  id: totrans-1111
  prefs: []
  type: TYPE_NORMAL
  zh: '**ValueError** – 如果 *xref* 不表示 PDF `dict`。空字典 `<<>>` 是被接受的。因此，如果刚刚创建了 xref
    并希望给它一个流，首先执行 `doc.update_object(xref, "<<>>")`，然后用此方法插入流数据。'
- en: The method is primarily (but not exclusively) intended to manipulate streams
    containing PDF operator syntax (see pp. 643 of the [Adobe PDF References](app3.html#adobemanual))
    as it is the case for e.g. page content streams.
  id: totrans-1112
  prefs: []
  type: TYPE_NORMAL
  zh: 该方法主要（但不仅限于）用于操作包含 PDF 操作符语法的流（参见 [Adobe PDF References](app3.html#adobemanual)
    的第 643 页），例如页面内容流。
- en: If you update a contents stream, consider using save parameter *clean=True*
    to ensure consistency between PDF operator source and the object structure.
  id: totrans-1113
  prefs: []
  type: TYPE_NORMAL
  zh: 如果更新内容流，请考虑使用保存参数 *clean=True* 来确保 PDF 操作符源和对象结构之间的一致性。
- en: 'Example: Let us assume that you no longer want a certain image appear on a
    page. This can be achieved by deleting the respective reference in its contents
    source(s) – and indeed: the image will be gone after reloading the page. But the
    page’s [`resources`](glossary.html#resources "resources") object would still show
    the image as being referenced by the page. This save option will clean up any
    such mismatches.'
  id: totrans-1114
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：假设您不再希望某个图片出现在页面上。可以通过删除其内容源的相应引用来实现此目的 - 确实如此：重新加载页面后，该图片将消失。但页面的 [`resources`](glossary.html#resources
    "resources") 对象仍将显示页面引用该图片。此保存选项将清理任何此类不匹配。
- en: '[PRE102]'
  id: totrans-1115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: New in v1.19.5
  id: totrans-1116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能 v1.19.5
- en: 'PDF Only: Make *target* xref an exact copy of *source*. If *source* is a [`stream`](glossary.html#stream
    "stream"), then these data are also copied.'
  id: totrans-1117
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限 PDF：使 *target* xref 成为 *source* 的精确副本。如果 *source* 是 [`stream`](glossary.html#stream
    "stream")，那么这些数据也会被复制。
- en: 'Parameters:'
  id: totrans-1118
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**source** (*int*) – the source [`xref`](glossary.html#xref "xref"). It must
    be an existing **dictionary** object.'
  id: totrans-1119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**source**（*int*） – 源 [`xref`](glossary.html#xref "xref")。必须是现有的 **dictionary**
    对象。'
- en: '**target** (*int*) – the target xref. Must be an existing **dictionary** object.
    If the xref has just been created, make sure to initialize it as a PDF dictionary
    with the minimum specification `<<>>`.'
  id: totrans-1120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**target**（*int*） – 目标 xref。必须是现有的 **dictionary** 对象。如果刚刚创建了 xref，请确保使用最小规格
    `<<>>` 初始化为 PDF 字典。'
- en: '**keep** (*list*) – an optional list of top-level keys in *target*, that should
    not be removed in preparation of the copy process.'
  id: totrans-1121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**keep** (*list*) - *target* 中的顶级键的可选列表，应在复制过程的准备中保留。'
- en: Note
  id: totrans-1122
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: This method has much in common with Python’s *dict* method [`copy()`](pixmap.html#Pixmap.copy
    "Pixmap.copy").
  id: totrans-1123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该方法与 Python 的 *dict* 方法 [`copy()`](pixmap.html#Pixmap.copy "Pixmap.copy") 有很多相似之处。
- en: Both xref numbers must represent existing dictionaries.
  id: totrans-1124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两个 xref 数字必须代表现有字典。
- en: Before data is copied from *source*, all *target* dictionary keys are deleted.
    You can specify exceptions from this in the *keep* list. If *source* however has
    a same-named key, its value will still replace the target.
  id: totrans-1125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在从 *source* 复制数据之前，所有 *target* 字典键都将被删除。您可以在 *keep* 列表中指定对此的例外情况。但是，如果 *source*
    有一个同名键，则其值仍将替换目标。
- en: If *source* is a [`stream`](glossary.html#stream "stream") object, then these
    data will also be copied over, and *target* will be converted to a stream object.
  id: totrans-1126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果 *source* 是一个 [`stream`](glossary.html#stream "stream") 对象，则这些数据也将被复制，并且 *target*
    将被转换为流对象。
- en: A typical use case is to replace or remove an existing image without using redaction
    annotations. Example scripts can be seen [here](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image).
  id: totrans-1127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 典型用例是替换或删除不使用删除注释的现有图像。示例脚本可以在[这里](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image)看到。
- en: '[PRE103]'
  id: totrans-1128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: 'PDF Only: Extract data and meta information of an image stored in the document.
    The output can directly be used to be stored as an image file, as input for PIL,
    [Pixmap](pixmap.html#pixmap) creation, etc. This method avoids using pixmaps wherever
    possible to present the image in its original format (e.g. as JPEG).'
  id: totrans-1129
  prefs: []
  type: TYPE_NORMAL
  zh: 仅适用于 PDF：提取存储在文档中的图像的数据和元信息。输出可以直接用作图像文件存储，作为 PIL 的输入，[Pixmap](pixmap.html#pixmap)
    创建等。该方法尽可能避免使用像素图，以便以其原始格式（例如作为 JPEG）呈现图像。
- en: 'Parameters:'
  id: totrans-1130
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – [`xref`](glossary.html#xref "xref") of an image object.
    If this is not in `range(1, doc.xref_length())`, or the object is no image or
    other errors occur, `None` is returned and no exception is raised.'
  id: totrans-1131
  prefs: []
  type: TYPE_NORMAL
  zh: '**xref** (*int*) - [`xref`](glossary.html#xref "xref") 图像对象的参考。如果不在 `range(1,
    doc.xref_length())` 内，或者对象不是图像或其他错误发生，则返回`None`，不会引发异常。'
- en: 'Return type:'
  id: totrans-1132
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: dict
  id: totrans-1133
  prefs: []
  type: TYPE_NORMAL
  zh: dict
- en: 'Returns:'
  id: totrans-1134
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a dictionary with the following keys
  id: totrans-1135
  prefs: []
  type: TYPE_NORMAL
  zh: 具有以下键的字典
- en: '*ext* (*str*) image type (e.g. *‘jpeg’*), usable as image file extension'
  id: totrans-1136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*ext* (*str*) 图像类型（例如 *‘jpeg’*），可用作图像文件扩展名'
- en: '*smask* (*int*) [`xref`](glossary.html#xref "xref") number of a stencil (/SMask)
    image or zero'
  id: totrans-1137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*smask* (*int*) [`xref`](glossary.html#xref "xref") 图像的一个蒙版(/SMask)图像或零'
- en: '*width* (*int*) image width'
  id: totrans-1138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*width* (*int*) 图像宽度'
- en: '*height* (*int*) image height'
  id: totrans-1139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*height* (*int*) 图像高度'
- en: '*colorspace* (*int*) the image’s *colorspace.n* number.'
  id: totrans-1140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*colorspace* (*int*) 图像的*colorspace.n* 数字。'
- en: '*cs-name* (*str*) the image’s *colorspace.name*.'
  id: totrans-1141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*cs-name* (*str*) 图像的*colorspace.name*。'
- en: '*xres* (*int*) resolution in x direction. Please also see [`resolution`](glossary.html#resolution
    "resolution").'
  id: totrans-1142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*xres* (*int*) x 方向的分辨率。请参阅[`resolution`](glossary.html#resolution "resolution")。'
- en: '*yres* (*int*) resolution in y direction. Please also see [`resolution`](glossary.html#resolution
    "resolution").'
  id: totrans-1143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*yres* (*int*) y 方向的分辨率。请参阅[`resolution`](glossary.html#resolution "resolution")。'
- en: '*image* (*bytes*) image data, usable as image file content'
  id: totrans-1144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*image* (*bytes*) 图像数据，可用作图像文件内容'
- en: '[PRE104]'
  id: totrans-1145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: Note
  id: totrans-1146
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: There is a functional overlap with *pix = pymupdf.Pixmap(doc, xref)*, followed
    by a *pix.tobytes()*. Main differences are that extract_image, **(1)** does not
    always deliver PNG image formats, **(2)** is **very** much faster with non-PNG
    images, **(3)** usually results in much less disk storage for extracted images,
    **(4)** returns `None` in error cases (generates no exception). Look at the following
    example images within the same PDF.
  id: totrans-1147
  prefs: []
  type: TYPE_NORMAL
  zh: 与 *pix = pymupdf.Pixmap(doc, xref)*，然后是 *pix.tobytes()* 有功能重叠。主要区别在于 extract_image，**(1)**
    不总是提供 PNG 图像格式，**(2)** 对于非 PNG 图像速度 **非常** 快，**(3)** 通常导致提取图像的磁盘存储要少得多，**(4)**
    在错误情况下返回 `None`（不生成异常）。看看相同 PDF 中的以下示例图像。
- en: 'xref 1268 is a PNG – Comparable execution time and identical output:'
  id: totrans-1148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: xref 1268 是 PNG - 执行时间可比较，输出相同：
- en: '[PRE105]'
  id: totrans-1149
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE105]'
- en: 'xref 1186 is a JPEG – [`Document.extract_image()`](#Document.extract_image
    "Document.extract_image") is **many times faster** and produces a **much smaller**
    output (2.48 MB vs. 0.35 MB):'
  id: totrans-1150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: xref 1186 是 JPEG - [`Document.extract_image()`](#Document.extract_image "Document.extract_image")
    比 **快得多**，且产生的输出 **要小得多**（2.48 MB vs. 0.35 MB）：
- en: '[PRE106]'
  id: totrans-1151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE106]'
- en: '[PRE107]'
  id: totrans-1152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE107]'
- en: 'Changed in v1.19.4: return a dictionary if `named == True`.'
  id: totrans-1153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 v1.19.4 中更改：如果`named == True`，则返回一个字典。
- en: 'PDF Only: Return an embedded font file’s data and appropriate file extension.
    This can be used to store the font as an external file. The method does not throw
    exceptions (other than via checking for PDF and valid [`xref`](glossary.html#xref
    "xref")).'
  id: totrans-1154
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：返回嵌入字体文件的数据和适当的文件扩展名。这可用于将字体存储为外部文件。该方法不会抛出异常（除非通过检查PDF和有效的[`xref`](glossary.html#xref
    "xref")）。
- en: 'Parameters:'
  id: totrans-1155
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**xref** (*int*) – PDF object number of the font to extract.'
  id: totrans-1156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**xref** (*int*) – 要提取的字体的PDF对象号。'
- en: '**info_only** (*bool*) – only return font information, not the buffer. To be
    used for information-only purposes, avoids allocation of large buffer areas.'
  id: totrans-1157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**info_only** (*bool*) – 仅返回字体信息，而不返回缓冲区。仅用于信息目的，避免分配大缓冲区。'
- en: '**named** (*bool*) – If true, a dictionary with the following keys is returned:
    ‘name’ (font base name), ‘ext’ (font file extension), ‘type’ (font type), ‘content’
    (font file content).'
  id: totrans-1158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**named** (*bool*) – 如果为真，则返回具有以下键的字典：''name''（字体基本名称），''ext''（字体文件扩展名），''type''（字体类型），''content''（字体文件内容）。'
- en: 'Return type:'
  id: totrans-1159
  prefs: []
  type: TYPE_NORMAL
  zh: 返回类型：
- en: tuple,dict
  id: totrans-1160
  prefs: []
  type: TYPE_NORMAL
  zh: tuple,dict
- en: 'Returns:'
  id: totrans-1161
  prefs: []
  type: TYPE_NORMAL
  zh: 返回值：
- en: 'a tuple `(basename, ext, type, content)`, where *ext* is a 3-byte suggested
    file extension (*str*), *basename* is the font’s name (*str*), *type* is the font’s
    type (e.g. “Type1”) and *content* is a bytes object containing the font file’s
    content (or *b””*). For possible extension values and their meaning see [Font
    File Extensions](vars.html#fontextensions). Return details on error:'
  id: totrans-1162
  prefs: []
  type: TYPE_NORMAL
  zh: 一个元组`（basename，ext，type，content）`，其中*ext*是3字节的建议文件扩展名(*str*)，*basename*是字体的名称(*str*)，*type*是字体的类型（例如，“Type1”），而*content*是包含字体文件内容的字节对象（或*b””*）。有关可能的扩展值及其含义，请参阅[字体文件扩展名](vars.html#fontextensions)。返回错误的详细信息：
- en: '`("", "", "", b"")` – invalid xref or xref is not a (valid) font object.'
  id: totrans-1163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`("", "", "", b"")` – 无效的xref或xref不是（有效的）字体对象。'
- en: '`(basename, "n/a", "Type1", b"")` – *basename* is not embedded and thus cannot
    be extracted. This is the case for e.g. the [PDF Base 14 Fonts](app3.html#base-14-fonts)
    and Type 3 fonts.'
  id: totrans-1164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`（basename，“n/a”，“Type1”，b“”）` – *basename*未嵌入，因此无法提取。例如，这适用于[PDF Base 14字体](app3.html#base-14-fonts)和Type
    3字体。'
- en: 'Example:'
  id: totrans-1165
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE108]'
  id: totrans-1166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE108]'
- en: Warning
  id: totrans-1167
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：
- en: The basename is returned unchanged from the PDF. So it may contain characters
    (such as blanks) which may disqualify it as a filename for your operating system.
    Take appropriate action.
  id: totrans-1168
  prefs: []
  type: TYPE_NORMAL
  zh: 从PDF中返回的基本名称不变。因此，它可能包含（例如空格）可能使其不适合作为操作系统文件名的字符。请采取适当措施。
- en: Note
  id: totrans-1169
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：
- en: The returned *basename* in general is **not** the original file name, but it
    probably has some similarity.
  id: totrans-1170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一般返回的*basename* **不是**原始文件名，但可能具有某些相似性。
- en: 'If parameter `named == True`, a dictionary with the following keys is returned:
    `{''name'': ''T1'', ''ext'': ''n/a'', ''type'': ''Type3'', ''content'': b''''}`.'
  id: totrans-1171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '如果参数`named == True`，则返回具有以下键的字典：`{''name'': ''T1'', ''ext'': ''n/a'', ''type'':
    ''Type3'', ''content'': b''''}`。'
- en: '[PRE109]'
  id: totrans-1172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE109]'
- en: New in v1.16.8
  id: totrans-1173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能，版本为v1.16.8
- en: 'PDF only: Return the [`xref`](glossary.html#xref "xref") of the document’s
    XML metadata.'
  id: totrans-1174
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：返回文档的XML元数据的[`xref`](glossary.html#xref "xref")。
- en: '[PRE110]'
  id: totrans-1175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE110]'
- en: '[PRE111]'
  id: totrans-1176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE111]'
- en: New in v1.18.7
  id: totrans-1177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能，版本为v1.18.7
- en: 'PDF only: Check whether there are links, resp. annotations anywhere in the
    document.'
  id: totrans-1178
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：检查文档中是否有链接或批注。
- en: 'Returns:'
  id: totrans-1179
  prefs: []
  type: TYPE_NORMAL
  zh: 返回值：
- en: '*True* / *False*. As opposed to fields, which are also stored in a central
    place of a PDF document, the existence of links / annotations can only be detected
    by parsing each page. These methods are tuned to do this efficiently and will
    immediately return, if the answer is *True* for a page. For PDFs with many thousand
    pages however, an answer may take some time [[6]](#f6) if no link, resp. no annotation
    is found.'
  id: totrans-1180
  prefs: []
  type: TYPE_NORMAL
  zh: '*True* / *False*。与字段相反，字段也存储在PDF文档的中心位置，链接/批注的存在只能通过解析每个页面来检测到。这些方法被调整为高效地执行此操作，并在对于页面答案为*True*时立即返回。但是，对于有数千页的PDF，如果未找到链接/批注，则答案可能需要一些时间[[6]](#f6)。'
- en: '[PRE112]'
  id: totrans-1181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE112]'
- en: 'PDF only: Investigate eligible fonts for their use by text in the document.
    If a font is supported and a size reduction is possible, that font is replaced
    by a version with a subset of its characters.'
  id: totrans-1182
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：研究文档中的文本可用字体。如果支持某个字体并且可以减小大小，则将该字体替换为其字符子集版本。
- en: Use this method immediately before saving the document.
  id: totrans-1183
  prefs: []
  type: TYPE_NORMAL
  zh: 在保存文档之前立即使用此方法。
- en: 'Parameters:'
  id: totrans-1184
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**verbose** (*bool*) – write various progress information to sysout. This currently
    only has an effect if `fallback` is `True`.'
  id: totrans-1185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**verbose** (*bool*) – 将各种进度信息写入sysout。这目前仅在`fallback`为`True`时才会生效。'
- en: '**fallback** (*bool*) – if `True` use the deprecated algorithm that makes use
    of package [fontTools](https://pypi.org/project/fonttools/) (which hence must
    be installed). If using the recommended value `False` (default), MuPDF’s native
    function is used – which is **very much faster** and can subset a broader range
    of font types. Package fontTools is not required then.'
  id: totrans-1186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**fallback**（*bool*）– 如果为`True`，则使用使用包[fontTools](https://pypi.org/project/fonttools/)的废弃算法（因此必须安装）。如果使用建议的值`False`（默认），则使用MuPDF的本机功能
    – 这非常快速，并且可以对更广泛的字体类型进行子集化。然后不需要安装包fontTools。'
- en: The greatest benefit can be achieved when creating new PDFs using large fonts
    like is typical for Asian scripts. When using the [Story](story-class.html#story)
    class or method [`Page.insert_htmlbox()`](page.html#Page.insert_htmlbox "Page.insert_htmlbox"),
    multiple fonts may automatically be included – without the programmer becoming
    aware of it.
  id: totrans-1187
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建使用大型字体（通常用于亚洲文字的字体）的新PDF时，可以获得最大的好处。当使用[Story](story-class.html#story)类或方法[`Page.insert_htmlbox()`](page.html#Page.insert_htmlbox
    "Page.insert_htmlbox")时，可能会自动包含多个字体，而程序员可能并不知晓。
- en: In all these cases, the set of actually used unicodes mostly is very small compared
    to the number of glyphs available in the used fonts. Using this method can easily
    reduce the embedded font binaries by two orders of magnitude – from several megabytes
    down to a low two-digit kilobyte amount.
  id: totrans-1188
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有这些情况下，实际使用的Unicode集合大多数情况下与使用的字体中可用的字形数量相比非常小。使用这种方法可以轻松将嵌入的字体二进制文件减少两个数量级，从几兆字节减少到几十千字节。
- en: Creating font subsets leaves behind a large number of large, now unused PDF
    objects (“ghosts”). Therefore, make sure to compress and garbage-collect when
    saving the file. We recommend to use [`Document.ez_save()`](#Document.ez_save
    "Document.ez_save").
  id: totrans-1189
  prefs: []
  type: TYPE_NORMAL
  zh: 创建字体子集会留下大量未使用的PDF对象（“幽灵”）。因此，在保存文件时，请务必进行压缩和垃圾回收。我们建议使用[`Document.ez_save()`](#Document.ez_save
    "Document.ez_save")。
- en: <details><summary>Show/hide history</summary></details> *   New in v1.18.7
  id: totrans-1190
  prefs: []
  type: TYPE_NORMAL
  zh: <details><summary>显示/隐藏历史记录</summary></details> *   新功能在v1.18.7版本中引入。
- en: Changed in v1.18.9
  id: totrans-1191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.9版本中更改。
- en: Changed in v1.24.2 use native function of MuPDF.
  id: totrans-1192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.24.2版本中更改为使用MuPDF的本机功能。
- en: '[PRE113]'
  id: totrans-1193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE113]'
- en: New in v1.19.0
  id: totrans-1194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Enable journalling. Use this before you start logging operations.'
  id: totrans-1195
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：启用日志记录。在开始记录操作之前使用此功能。
- en: '[PRE114]'
  id: totrans-1196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE114]'
- en: New in v1.19.0
  id: totrans-1197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Start journalling an *“operation”* identified by a string “name”.
    Updates will fail for a journal-enabled PDF, if no operation has been started.'
  id: totrans-1198
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：开始记录由字符串“name”标识的*“操作”*。如果PDF启用了日志记录，但尚未开始操作，则更新将失败。
- en: '[PRE115]'
  id: totrans-1199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE115]'
- en: New in v1.19.0
  id: totrans-1200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Stop the current operation. The updates between start and stop of
    an operation belong to the same unit of work and will be undone / redone together.'
  id: totrans-1201
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：停止当前操作。在操作的开始和结束之间进行的更新属于同一工作单元，并将一起撤销/重做。
- en: '[PRE116]'
  id: totrans-1202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE116]'
- en: New in v1.19.0
  id: totrans-1203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Return the numbers of the current operation and the total operation
    count.'
  id: totrans-1204
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：返回当前操作编号和总操作计数。
- en: 'Returns:'
  id: totrans-1205
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: a tuple `(step, steps)` containing the current operation number and the total
    number of operations in the journal. If **step** is 0, we are at the top of the
    journal. If **step** equals **steps**, we are at the bottom. Updating the PDF
    with anything other than undo or redo will automatically remove all journal entries
    after the current one and the new update will become the new last entry in the
    journal. The updates corresponding to the removed journal entries will be permanently
    lost.
  id: totrans-1206
  prefs: []
  type: TYPE_NORMAL
  zh: 一个元组`(step, steps)`包含当前操作编号和日志中操作总数。如果**step**为0，则表示位于日志顶部。如果**step**等于**steps**，则表示位于底部。更新PDF时，除了撤销或重做外，还将自动删除当前条目之后的所有日志条目，并且新更新将成为日志中的最后一个条目。被删除日志条目对应的更新将永久丢失。
- en: '[PRE117]'
  id: totrans-1207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE117]'
- en: New in v1.19.0
  id: totrans-1208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Return the name of operation number *step.*'
  id: totrans-1209
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：返回操作编号为*step*的名称。
- en: '[PRE118]'
  id: totrans-1210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE118]'
- en: New in v1.19.0
  id: totrans-1211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Show whether forward (“redo”) and / or backward (“undo”) executions
    are possible from the current journal position.'
  id: totrans-1212
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：显示当前日志位置是否可以向前（“重做”）和/或向后（“撤销”）执行。
- en: 'Returns:'
  id: totrans-1213
  prefs: []
  type: TYPE_NORMAL
  zh: 返回：
- en: 'a dictionary `{"undo": bool, "redo": bool}`. The respective method is available
    if its value is `True`.'
  id: totrans-1214
  prefs: []
  type: TYPE_NORMAL
  zh: '一个字典`{"undo": bool, "redo": bool}`。如果值为`True`，则相应的方法可用。'
- en: '[PRE119]'
  id: totrans-1215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE119]'
- en: New in v1.19.0
  id: totrans-1216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Revert (undo) the current step in the journal. This moves towards
    the journal’s top.'
  id: totrans-1217
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：撤销日志中的当前步骤。这将移动到日志的顶部。
- en: '[PRE120]'
  id: totrans-1218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE120]'
- en: New in v1.19.0
  id: totrans-1219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在v1.19.0版本中引入。
- en: 'PDF only: Re-apply (redo) the current step in the journal. This moves towards
    the journal’s bottom.'
  id: totrans-1220
  prefs: []
  type: TYPE_NORMAL
  zh: 仅PDF：重新应用（重做）日志中的当前步骤。这将移动到日志的底部。
- en: '[PRE121]'
  id: totrans-1221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE121]'
- en: New in v1.19.0
  id: totrans-1222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.19.0中新增
- en: 'PDF only: Save the journal to a file.'
  id: totrans-1223
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：将期刊保存到文件。
- en: 'Parameters:'
  id: totrans-1224
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**filename** (*str**,**fp*) – either a filename as string or a file object
    opened as “wb” (or an `io.BytesIO()` object).'
  id: totrans-1225
  prefs: []
  type: TYPE_NORMAL
  zh: '**filename**（*str**,**fp*） - 可以是字符串形式的文件名，也可以是以“wb”方式打开的文件对象（或者是`io.BytesIO()`对象）。'
- en: '[PRE122]'
  id: totrans-1226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE122]'
- en: New in v1.19.0
  id: totrans-1227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.19.0中新增
- en: 'PDF only: Load journal from a file. Enables journalling for the document. If
    journalling is already enabled, an exception is raised.'
  id: totrans-1228
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：从文件加载期刊。启用文档的期刊记录。如果已启用期刊记录，则会引发异常。
- en: 'Parameters:'
  id: totrans-1229
  prefs: []
  type: TYPE_NORMAL
  zh: 参数：
- en: '**filename** (*str**,**fp*) – the filename (str) of the journal or a file object
    opened as “rb” (or an `io.BytesIO()` object).'
  id: totrans-1230
  prefs: []
  type: TYPE_NORMAL
  zh: '**filename**（*str**,**fp*） - 期刊的文件名（字符串）或以“rb”方式打开的文件对象（或者是`io.BytesIO()`对象）。'
- en: '[PRE123]'
  id: totrans-1231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE123]'
- en: New in v1.19.0
  id: totrans-1232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.19.0中新增
- en: 'PDF only: Saves a “snapshot” of the document. This is a PDF document with a
    special, incremental-save format compatible with journalling – therefore no save
    options are available. Saving a snapshot is not possible for new documents.'
  id: totrans-1233
  prefs: []
  type: TYPE_NORMAL
  zh: 仅限PDF：保存文档的“快照”。这是一种具有特殊的增量保存格式的PDF文档，与期刊兼容 - 因此不提供保存选项。对于新文档，无法保存快照。
- en: This is a normal PDF document with no usage restrictions whatsoever. If it is
    not being changed in any way, it can be used together with its journal to undo
    / redo operations or continue updating.
  id: totrans-1234
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一份普通的PDF文档，没有任何使用限制。如果未作任何更改，则可与其期刊一起使用以执行撤销/重做操作或继续更新。
- en: '[PRE124]'
  id: totrans-1235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE124]'
- en: Contains the first [Outline](outline.html#outline) entry of the document (or
    `None`). Can be used as a starting point to walk through all outline items. Accessing
    this property for encrypted, not authenticated documents will raise an *AttributeError*.
  id: totrans-1236
  prefs: []
  type: TYPE_NORMAL
  zh: 包含文档的第一个[Outline](outline.html#outline)条目（或`None`）。可以作为遍历所有大纲项目的起点。对于加密但未经过身份验证的文档，访问此属性将引发*AttributeError*。
- en: 'Type:'
  id: totrans-1237
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: '[Outline](outline.html#outline)'
  id: totrans-1238
  prefs: []
  type: TYPE_NORMAL
  zh: '[Outline](outline.html#outline)'
- en: '[PRE125]'
  id: totrans-1239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE125]'
- en: '*False* if document is still open. If closed, most other attributes and methods
    will have been deleted / disabled. In addition, [Page](page.html#page) objects
    referring to this document (i.e. created with [`Document.load_page()`](#Document.load_page
    "Document.load_page")) and their dependent objects will no longer be usable. For
    reference purposes, [`Document.name`](#Document.name "Document.name") still exists
    and will contain the filename of the original document (if applicable).'
  id: totrans-1240
  prefs: []
  type: TYPE_NORMAL
  zh: '*False* 表示文档仍处于打开状态。如果已关闭，则大多数其他属性和方法将已删除/禁用。此外，对于引用此文档的[Page](page.html#page)对象（即使用[`Document.load_page()`](#Document.load_page
    "Document.load_page")创建的对象）及其依赖对象将不再可用。为了参考，[`Document.name`](#Document.name "Document.name")仍然存在，并将包含原始文档的文件名（如果适用）。'
- en: 'Type:'
  id: totrans-1241
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1242
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE126]'
  id: totrans-1243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE126]'
- en: '*True* if this is a PDF document and contains unsaved changes, else *False*.'
  id: totrans-1244
  prefs: []
  type: TYPE_NORMAL
  zh: '*True* 表示这是一个PDF文档且包含未保存的更改，否则为*False*。'
- en: 'Type:'
  id: totrans-1245
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1246
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE127]'
  id: totrans-1247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE127]'
- en: '*True* if this is a PDF document, else *False*.'
  id: totrans-1248
  prefs: []
  type: TYPE_NORMAL
  zh: '*True* 表示这是一个PDF文档，否则为*False*。'
- en: 'Type:'
  id: totrans-1249
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1250
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE128]'
  id: totrans-1251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE128]'
- en: '*False* if this is not a PDF or has no form fields, otherwise the number of
    root form fields (fields with no ancestors).'
  id: totrans-1252
  prefs: []
  type: TYPE_NORMAL
  zh: '*False* 表示这不是PDF文档或没有表单字段，否则为根表单字段的数量（没有祖先的字段）。'
- en: '*(Changed in v1.16.4)* Returns the total number of (root) form fields.'
  id: totrans-1253
  prefs: []
  type: TYPE_NORMAL
  zh: '*(v1.16.4中更改)* 返回（根）表单字段的总数。'
- en: 'Type:'
  id: totrans-1254
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool,int
  id: totrans-1255
  prefs: []
  type: TYPE_NORMAL
  zh: bool,int
- en: '[PRE129]'
  id: totrans-1256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE129]'
- en: '*True* if document has a variable page layout (like e-books or HTML). In this
    case you can set the desired page dimensions during document creation (open) or
    via method [`layout()`](#Document.layout "Document.layout").'
  id: totrans-1257
  prefs: []
  type: TYPE_NORMAL
  zh: '*True* 表示文档具有可变的页面布局（如电子书或HTML）。在这种情况下，您可以在文档创建（打开）过程中或通过[`layout()`](#Document.layout
    "Document.layout")方法设置所需的页面尺寸。'
- en: 'Type:'
  id: totrans-1258
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1259
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE130]'
  id: totrans-1260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE130]'
- en: New in v1.18.2
  id: totrans-1261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.18.2中新增
- en: '*True* if PDF has been repaired during open (because of major structure issues).
    Always *False* for non-PDF documents. If true, more details have been stored in
    `TOOLS.mupdf_warnings()`, and [`Document.can_save_incrementally()`](#Document.can_save_incrementally
    "Document.can_save_incrementally") will return *False*.'
  id: totrans-1262
  prefs: []
  type: TYPE_NORMAL
  zh: '*True* 表示在打开过程中修复了PDF（因为存在重大结构问题）。对于非PDF文档始终为*False*。如果为真，则更多详细信息已存储在`TOOLS.mupdf_warnings()`中，并且[`Document.can_save_incrementally()`](#Document.can_save_incrementally
    "Document.can_save_incrementally")将返回*False*。'
- en: 'Type:'
  id: totrans-1263
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1264
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE131]'
  id: totrans-1265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: New in v1.22.2
  id: totrans-1266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.2中新增
- en: '*True* if PDF is in linearized format. *False* for non-PDF documents.'
  id: totrans-1267
  prefs: []
  type: TYPE_NORMAL
  zh: '*True* 表示PDF处于线性化格式。对于非PDF文档，则为*False*。'
- en: 'Type:'
  id: totrans-1268
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1269
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE132]'
  id: totrans-1270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: New in v1.22.2
  id: totrans-1271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.2中新增
- en: A dictionary indicating the `/MarkInfo` value. If not specified, the empty dictionary
    is returned. If not a PDF, `None` is returned.
  id: totrans-1272
  prefs: []
  type: TYPE_NORMAL
  zh: 指示`/MarkInfo`值的字典。如果未指定，则返回空字典。如果不是PDF，则返回`None`。
- en: 'Type:'
  id: totrans-1273
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: dict
  id: totrans-1274
  prefs: []
  type: TYPE_NORMAL
  zh: dict
- en: '[PRE133]'
  id: totrans-1275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE133]'
- en: New in v1.22.2
  id: totrans-1276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: v1.22.2中新增
- en: A string containing the `/PageMode` value. If not specified, the default “UseNone”
    is returned. If not a PDF, `None` is returned.
  id: totrans-1277
  prefs: []
  type: TYPE_NORMAL
  zh: 包含 `/PageMode` 值的字符串。如果未指定，默认返回“UseNone”。如果不是 PDF，则返回 `None`。
- en: 'Type:'
  id: totrans-1278
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: str
  id: totrans-1279
  prefs: []
  type: TYPE_NORMAL
  zh: str
- en: '[PRE134]'
  id: totrans-1280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE134]'
- en: New in v1.22.2
  id: totrans-1281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.22.2 版本中引入
- en: A string containing the `/PageLayout` value. If not specified, the default “SinglePage”
    is returned. If not a PDF, `None` is returned.
  id: totrans-1282
  prefs: []
  type: TYPE_NORMAL
  zh: 包含 `/PageLayout` 值的字符串。如果未指定，默认返回“SinglePage”。如果不是 PDF，则返回 `None`。
- en: 'Type:'
  id: totrans-1283
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: str
  id: totrans-1284
  prefs: []
  type: TYPE_NORMAL
  zh: str
- en: '[PRE135]'
  id: totrans-1285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE135]'
- en: New in v1.22.2
  id: totrans-1286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新功能在 v1.22.2 版本中引入
- en: An integer counting the number of versions present in the document. Zero if
    not a PDF, otherwise the number of incremental saves plus one.
  id: totrans-1287
  prefs: []
  type: TYPE_NORMAL
  zh: 计算文档中存在版本的整数。如果不是 PDF，则为零；否则为增量保存数加一。
- en: 'Type:'
  id: totrans-1288
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: int
  id: totrans-1289
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: '[PRE136]'
  id: totrans-1290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE136]'
- en: Indicates whether the document is password-protected against access. This indicator
    remains unchanged – **even after the document has been authenticated**. Precludes
    incremental saves if true.
  id: totrans-1291
  prefs: []
  type: TYPE_NORMAL
  zh: 指示文档是否受密码保护以防止访问。即使在文档已验证之后，**此指示器仍然保持不变**。如果为真，则禁止增量保存。
- en: 'Type:'
  id: totrans-1292
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1293
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE137]'
  id: totrans-1294
  prefs: []
  type: TYPE_PRE
  zh: '[PRE137]'
- en: This indicator initially equals [`Document.needs_pass`](#Document.needs_pass
    "Document.needs_pass"). After successful authentication, it is set to *False*
    to reflect the situation.
  id: totrans-1295
  prefs: []
  type: TYPE_NORMAL
  zh: 此指示器最初等于[`Document.needs_pass`](#Document.needs_pass "Document.needs_pass")。验证成功后，它设置为
    *False* 反映当前情况。
- en: 'Type:'
  id: totrans-1296
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: bool
  id: totrans-1297
  prefs: []
  type: TYPE_NORMAL
  zh: bool
- en: '[PRE138]'
  id: totrans-1298
  prefs: []
  type: TYPE_PRE
  zh: '[PRE138]'
- en: 'Changed in v1.16.0: This is now an integer comprised of bit indicators. Was
    a dictionary previously.'
  id: totrans-1299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自 v1.16.0 版更改：现在是一个由位指示器组成的整数。先前是一个字典。
- en: Contains the permissions to access the document. This is an integer containing
    bool values in respective bit positions. For example, if *doc.permissions & pymupdf.PDF_PERM_MODIFY
    > 0*, you may change the document. See [Document Permissions](vars.html#permissioncodes)
    for details.
  id: totrans-1300
  prefs: []
  type: TYPE_NORMAL
  zh: 包含访问文档的权限。这是一个整数，包含各自位位置上的 bool 值。例如，如果 *doc.permissions & pymupdf.PDF_PERM_MODIFY
    > 0*，则可以更改文档。有关详细信息，请参阅 [文档权限](vars.html#permissioncodes)。
- en: 'Type:'
  id: totrans-1301
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: int
  id: totrans-1302
  prefs: []
  type: TYPE_NORMAL
  zh: int
- en: '[PRE139]'
  id: totrans-1303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE139]'
- en: Contains the document’s meta data as a Python dictionary or `None` (if *is_encrypted=True*
    and *needPass=True*). Keys are *format*, *encryption*, *title*, *author*, *subject*,
    *keywords*, *creator*, *producer*, *creationDate*, *modDate*, *trapped*. All item
    values are strings or `None`.
  id: totrans-1304
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 Python 字典或 `None`（如果 *is_encrypted=True* 和 *needPass=True*）。键为 *format*、*encryption*、*title*、*author*、*subject*、*keywords*、*creator*、*producer*、*creationDate*、*modDate*、*trapped*。所有项的值都是字符串或
    `None`。
- en: Except *format* and *encryption*, for PDF documents, the key names correspond
    in an obvious way to the PDF keys */Creator*, */Producer*, */CreationDate*, */ModDate*,
    */Title*, */Author*, */Subject*, */Trapped* and */Keywords* respectively.
  id: totrans-1305
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 *format* 和 *encryption*，对于 PDF 文档，关键名称与 PDF 关键字 */Creator*、*/Producer*、*/CreationDate*、*/ModDate*、*/Title*、*/Author*、*/Subject*、*/Trapped*
    和 */Keywords* 显而易见地对应。
- en: '*format* contains the document format (e.g. ‘PDF-1.6’, ‘XPS’, ‘EPUB’).'
  id: totrans-1306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*format* 包含文档格式（例如 ‘PDF-1.6’，‘XPS’，‘EPUB’）。'
- en: '*encryption* either contains `None` (no encryption), or a string naming an
    encryption method (e.g. *‘Standard V4 R4 128-bit RC4’*). Note that an encryption
    method may be specified **even if** *needs_pass=False*. In such cases not all
    permissions will probably have been granted. Check [`Document.permissions`](#Document.permissions
    "Document.permissions") for details.'
  id: totrans-1307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*encryption* 可以是 `None`（无加密），或者命名加密方法的字符串（例如 *‘标准 V4 R4 128 位 RC4’*）。请注意，即使
    *needs_pass=False*，也可能指定加密方法 **甚至**。在这种情况下，可能未授予所有权限。查看有关详细信息的[`Document.permissions`](#Document.permissions
    "Document.permissions")。'
- en: If the date fields contain valid data (which need not be the case at all!),
    they are strings in the PDF-specific timestamp format “D:<TS><TZ>”, where
  id: totrans-1308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果日期字段包含有效数据（这并不一定是情况！），它们是以 PDF 特定时间戳格式 “D:<TS><TZ>” 的字符串，其中
- en: <TS> is the 12 character ISO timestamp *YYYYMMDDhhmmss* (*YYYY* - year, *MM*
    - month, *DD* - day, *hh* - hour, *mm* - minute, *ss* - second), and
  id: totrans-1309
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: <TS> 是 12 位 ISO 时间戳 *YYYYMMDDhhmmss*（*YYYY* - 年，*MM* - 月，*DD* - 日，*hh* - 时，*mm*
    - 分，*ss* - 秒），以及
- en: ''
  id: totrans-1310
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-1311
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: <TZ> is a time zone value (time interval relative to GMT) containing a sign
    (‘+’ or ‘-‘), the hour (*hh*), and the minute (*‘mm’*, note the apostrophes!).
  id: totrans-1312
  prefs:
  - PREF_IND
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: <TZ> 是一个时区值（相对于 GMT 的时间间隔），包含一个符号（‘+’ 或 ‘-’），小时 (*hh*) 和分钟 (*‘mm’*，请注意引号！)。
- en: A Paraguayan value might hence look like *D:20150415131602-04’00’*, which corresponds
    to the timestamp April 15, 2015, at 1:16:02 pm local time Asuncion.
  id: totrans-1313
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 例如，巴拉圭的值可能看起来像 *D:20150415131602-04’00’*，对应于 2015 年 4 月 15 日下午 1 点 16 分 02 秒阿松森当地时间的时间戳。
- en: 'Type:'
  id: totrans-1314
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: dict
  id: totrans-1315
  prefs: []
  type: TYPE_NORMAL
  zh: 字典
- en: '[PRE140]'
  id: totrans-1316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE140]'
- en: Contains the *filename* or *filetype* value with which *Document* was created.
  id: totrans-1317
  prefs: []
  type: TYPE_NORMAL
  zh: 包含创建 *Document* 的 *filename* 或 *filetype* 值。
- en: 'Type:'
  id: totrans-1318
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: str
  id: totrans-1319
  prefs: []
  type: TYPE_NORMAL
  zh: str
- en: '[PRE141]'
  id: totrans-1320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE141]'
- en: Contains the number of pages of the document. May return 0 for documents with
    no pages. Function `len(doc)` will also deliver this result.
  id: totrans-1321
  prefs: []
  type: TYPE_NORMAL
  zh: 包含文档的页数。对于没有页面的文档，可能返回 0。函数 `len(doc)` 也会返回这个结果。
- en: 'Type:'
  id: totrans-1322
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: int
  id: totrans-1323
  prefs: []
  type: TYPE_NORMAL
  zh: 整数
- en: '[PRE142]'
  id: totrans-1324
  prefs: []
  type: TYPE_PRE
  zh: '[PRE142]'
- en: New in v1.17.0
  id: totrans-1325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新版本 v1.17.0
- en: Contains the number of chapters in the document. Always at least 1\. Relevant
    only for document types with chapter support (EPUB currently). Other documents
    will return 1.
  id: totrans-1326
  prefs: []
  type: TYPE_NORMAL
  zh: 包含文档中章节的数量。仅适用于支持章节的文档类型（当前为 EPUB）。其他文档将返回 1。
- en: 'Type:'
  id: totrans-1327
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: int
  id: totrans-1328
  prefs: []
  type: TYPE_NORMAL
  zh: 整数
- en: '[PRE143]'
  id: totrans-1329
  prefs: []
  type: TYPE_PRE
  zh: '[PRE143]'
- en: New in v1.17.0
  id: totrans-1330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新版本 v1.17.0
- en: Contains (chapter, pno) of the document’s last page. Relevant only for document
    types with chapter support (EPUB currently). Other documents will return `(0,
    page_count - 1)` and `(0, -1)` if it has no pages.
  id: totrans-1331
  prefs: []
  type: TYPE_NORMAL
  zh: 包含文档最后一页的（章节，页号）。仅适用于支持章节的文档类型（当前为 EPUB）。对于其他文档，如果没有页面，将返回 `(0, page_count -
    1)` 和 `(0, -1)`。
- en: 'Type:'
  id: totrans-1332
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: int
  id: totrans-1333
  prefs: []
  type: TYPE_NORMAL
  zh: 整数
- en: '[PRE144]'
  id: totrans-1334
  prefs: []
  type: TYPE_PRE
  zh: '[PRE144]'
- en: A list of form field font names defined in the */AcroForm* object. `None` if
    not a PDF.
  id: totrans-1335
  prefs: []
  type: TYPE_NORMAL
  zh: 在 */AcroForm* 对象中定义的表单字段字体名称列表。如果不是 PDF，则为 `None`。
- en: 'Type:'
  id: totrans-1336
  prefs: []
  type: TYPE_NORMAL
  zh: 类型：
- en: list
  id: totrans-1337
  prefs: []
  type: TYPE_NORMAL
  zh: 列表
- en: Note
  id: totrans-1338
  prefs: []
  type: TYPE_NORMAL
  zh: 注
- en: For methods that change the structure of a PDF (`insert_pdf()`, `select()`,
    `copy_page()`, `delete_page()` and others), be aware that objects or properties
    in your program may have been invalidated or orphaned. Examples are [Page](page.html#page)
    objects and their children (links, annotations, widgets), variables holding old
    page counts, tables of content and the like. Remember to keep such variables up
    to date or delete orphaned objects. Also refer to [Ensuring Consistency of Important
    Objects in PyMuPDF](app3.html#referenialintegrity).
  id: totrans-1339
  prefs: []
  type: TYPE_NORMAL
  zh: 对于改变 PDF 结构的方法（`insert_pdf()`、`select()`、`copy_page()`、`delete_page()` 等），请注意程序中的对象或属性可能已无效或变为孤立。例如
    [Page](page.html#page) 对象及其子对象（链接、注释、小部件）、保存旧页面计数的变量、目录等等。请记得保持这些变量的更新或删除孤立的对象。同时参考
    [确保 PyMuPDF 中重要对象的一致性](app3.html#referenialintegrity)。
- en: '`set_metadata()` Example'
  id: totrans-1340
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`set_metadata()` 示例'
- en: 'Clear metadata information. If you do this out of privacy / data protection
    concerns, make sure you save the document as a new file with *garbage > 0*. Only
    then the old */Info* object will also be physically removed from the file. In
    this case, you may also want to clear any XML metadata inserted by several PDF
    editors:'
  id: totrans-1341
  prefs: []
  type: TYPE_NORMAL
  zh: 清除元数据信息。如果您因隐私/数据保护问题而这样做，请确保将文档另存为新文件，并设置 *garbage > 0*。只有这样旧的 */Info* 对象才会被物理删除。在这种情况下，您可能还想清除由几个
    PDF 编辑器插入的任何 XML 元数据：
- en: '[PRE145]'
  id: totrans-1342
  prefs: []
  type: TYPE_PRE
  zh: '[PRE145]'
- en: '`set_toc()` Demonstration'
  id: totrans-1343
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`set_toc()` 演示'
- en: This shows how to modify or add a table of contents. Also have a look at [import.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py)
    and [export.py](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py)
    in the examples directory.
  id: totrans-1344
  prefs: []
  type: TYPE_NORMAL
  zh: 这展示了如何修改或添加目录。还可以查看示例目录中的 [import.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py)
    和 [export.py](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py)。
- en: '[PRE146]'
  id: totrans-1345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE146]'
- en: '`insert_pdf()` Examples'
  id: totrans-1346
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`insert_pdf()` 示例'
- en: '**(1) Concatenate two documents including their TOCs:**'
  id: totrans-1347
  prefs: []
  type: TYPE_NORMAL
  zh: '**(1) 连接两个文档并包括它们的目录：**'
- en: '[PRE147]'
  id: totrans-1348
  prefs: []
  type: TYPE_PRE
  zh: '[PRE147]'
- en: Obviously, similar ways can be found in more general situations. Just make sure
    that hierarchy levels in a row do not increase by more than one. Inserting dummy
    bookmarks before and after *toc2* segments would heal such cases. A ready-to-use
    GUI (wxPython) solution can be found in script [join.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py)
    of the examples directory.
  id: totrans-1349
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，在更普遍的情况下可以找到类似的方法。只需确保一行中的层次级别不会增加超过一层。在 *toc2* 段前后插入虚拟书签可以解决这些情况。在示例目录的脚本
    [join.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py)
    中可以找到一个现成的 GUI（wxPython）解决方案。
- en: '**(2) More examples:**'
  id: totrans-1350
  prefs: []
  type: TYPE_NORMAL
  zh: '**(2) 更多示例：**'
- en: '[PRE148]'
  id: totrans-1351
  prefs: []
  type: TYPE_PRE
  zh: '[PRE148]'
- en: '[PRE149]'
  id: totrans-1352
  prefs: []
  type: TYPE_PRE
  zh: '[PRE149]'
- en: '[PRE150]'
  id: totrans-1353
  prefs: []
  type: TYPE_PRE
  zh: '[PRE150]'
- en: Other Examples
  id: totrans-1354
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他示例
- en: '**Extract all page-referenced images of a PDF into separate PNG files**:'
  id: totrans-1355
  prefs: []
  type: TYPE_NORMAL
  zh: '**从 PDF 中提取所有引用页面的图像并保存为单独的 PNG 文件**：'
- en: '[PRE151]'
  id: totrans-1356
  prefs: []
  type: TYPE_PRE
  zh: '[PRE151]'
- en: '**Rotate all pages of a PDF:**'
  id: totrans-1357
  prefs: []
  type: TYPE_NORMAL
  zh: '**旋转 PDF 的所有页面：**'
- en: '[PRE152]'
  id: totrans-1358
  prefs: []
  type: TYPE_PRE
  zh: '[PRE152]'
- en: Footnotes
  id: totrans-1359
  prefs: []
  type: TYPE_NORMAL
  zh: 脚注
- en: Do you have any feedback on this page?
  id: totrans-1360
  prefs: []
  type: TYPE_NORMAL
  zh: 对本页面有任何反馈吗？
- en: '* * *'
  id: totrans-1361
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: This software is provided AS-IS with no warranty, either express or implied.
    This software is distributed under license and may not be copied, modified or
    distributed except as expressly authorized under the terms of that license. Refer
    to licensing information at [artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)
    or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA
    94129, United States for further information.
  id: totrans-1362
  prefs: []
  type: TYPE_NORMAL
  zh: 本软件按原样提供，没有任何明示或暗示的保证。此软件按许可证分发，未经授权不得复制、修改或分发。请参阅 [artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)
    的许可信息或联系美国旧金山 CA 94129 Mesa 街 108A 号的 Artifex Software Inc. 了解更多信息。
- en: This documentation covers all versions up to 1.24.4.
  id: totrans-1363
  prefs: []
  type: TYPE_NORMAL
  zh: 本文档涵盖所有版本直至 1.24.4。
- en: '[![Discord logo](../Images/66cbb5081103a580193aa66c87b90d9a.png)](https://discord.gg/TSpYGBW4eq)'
  id: totrans-1364
  prefs: []
  type: TYPE_NORMAL
  zh: '[![Discord logo](../Images/66cbb5081103a580193aa66c87b90d9a.png)](https://discord.gg/TSpYGBW4eq)'
- en: '`set_metadata()` Example'
  id: totrans-1365
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`set_metadata()` 示例'
- en: 'Clear metadata information. If you do this out of privacy / data protection
    concerns, make sure you save the document as a new file with *garbage > 0*. Only
    then the old */Info* object will also be physically removed from the file. In
    this case, you may also want to clear any XML metadata inserted by several PDF
    editors:'
  id: totrans-1366
  prefs: []
  type: TYPE_NORMAL
  zh: 清除元数据信息。如果您因隐私/数据保护问题而执行此操作，请确保将文档保存为一个新文件，并设置 *garbage > 0*。只有这样，旧的 */Info*
    对象才会从文件中物理移除。在这种情况下，您可能还想清除由多个 PDF 编辑器插入的任何 XML 元数据：
- en: '[PRE153]'
  id: totrans-1367
  prefs: []
  type: TYPE_PRE
  zh: '[PRE153]'
- en: '`set_toc()` Demonstration'
  id: totrans-1368
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`set_toc()` 演示'
- en: This shows how to modify or add a table of contents. Also have a look at [import.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py)
    and [export.py](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py)
    in the examples directory.
  id: totrans-1369
  prefs: []
  type: TYPE_NORMAL
  zh: 这展示了如何修改或添加目录。还可以查看示例目录中的 [import.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py)
    和 [export.py](https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py)。
- en: '[PRE154]'
  id: totrans-1370
  prefs: []
  type: TYPE_PRE
  zh: '[PRE154]'
- en: '`insert_pdf()` Examples'
  id: totrans-1371
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`insert_pdf()` 示例'
- en: '**(1) Concatenate two documents including their TOCs:**'
  id: totrans-1372
  prefs: []
  type: TYPE_NORMAL
  zh: '**(1) 合并包含其目录的两个文档：**'
- en: '[PRE155]'
  id: totrans-1373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE155]'
- en: Obviously, similar ways can be found in more general situations. Just make sure
    that hierarchy levels in a row do not increase by more than one. Inserting dummy
    bookmarks before and after *toc2* segments would heal such cases. A ready-to-use
    GUI (wxPython) solution can be found in script [join.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py)
    of the examples directory.
  id: totrans-1374
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，在更一般的情况下可以找到类似的方式。只需确保行内的层次级别不增加超过一级。在 *toc2* 段前后插入虚拟书签可以解决这类情况。在示例目录的 [join.py](https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py)
    中可以找到一个现成的 GUI（wxPython）解决方案。
- en: '**(2) More examples:**'
  id: totrans-1375
  prefs: []
  type: TYPE_NORMAL
  zh: '**(2) 更多示例：**'
- en: '[PRE156]'
  id: totrans-1376
  prefs: []
  type: TYPE_PRE
  zh: '[PRE156]'
- en: '[PRE157]'
  id: totrans-1377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE157]'
- en: '[PRE158]'
  id: totrans-1378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE158]'
- en: Other Examples
  id: totrans-1379
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他示例
- en: '**Extract all page-referenced images of a PDF into separate PNG files**:'
  id: totrans-1380
  prefs: []
  type: TYPE_NORMAL
  zh: '**提取 PDF 中所有页面引用的图像并保存为单独的 PNG 文件：**'
- en: '[PRE159]'
  id: totrans-1381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE159]'
- en: '**Rotate all pages of a PDF:**'
  id: totrans-1382
  prefs: []
  type: TYPE_NORMAL
  zh: '**旋转 PDF 的所有页面：**'
- en: '[PRE160]'
  id: totrans-1383
  prefs: []
  type: TYPE_PRE
  zh: '[PRE160]'
- en: Footnotes
  id: totrans-1384
  prefs: []
  type: TYPE_NORMAL
  zh: 脚注
- en: Do you have any feedback on this page?
  id: totrans-1385
  prefs: []
  type: TYPE_NORMAL
  zh: 对本页面有任何反馈吗？
- en: '* * *'
  id: totrans-1386
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: This software is provided AS-IS with no warranty, either express or implied.
    This software is distributed under license and may not be copied, modified or
    distributed except as expressly authorized under the terms of that license. Refer
    to licensing information at [artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)
    or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA
    94129, United States for further information.
  id: totrans-1387
  prefs: []
  type: TYPE_NORMAL
  zh: 本软件按原样提供，没有任何明示或暗示的保证。此软件按许可证分发，未经授权不得复制、修改或分发。请参阅 [artifex.com](https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link)
    的许可信息或联系美国旧金山 CA 94129 Mesa 街 108A 号的 Artifex Software Inc. 了解更多信息。
- en: This documentation covers all versions up to 1.24.4.
  id: totrans-1388
  prefs: []
  type: TYPE_NORMAL
  zh: 本文档涵盖所有版本直至 1.24.4。
- en: '[![Discord logo](../Images/66cbb5081103a580193aa66c87b90d9a.png)](https://discord.gg/TSpYGBW4eq)'
  id: totrans-1389
  prefs: []
  type: TYPE_NORMAL
  zh: '[![Discord logo](../Images/66cbb5081103a580193aa66c87b90d9a.png)](https://discord.gg/TSpYGBW4eq)'
